#from hf_cypher.cypherQuery import CypherQuery
from nose.tools import assert_equal, assert_true

from saddlebags.AlleleSubCommon import assignConfigurationValue, writeConfigurationFile, identifyGenomicFeatures, parseExons, fetchSequenceAlleleCallWithGFE, clearGlobalVariables, initializeGlobalVariables, getConfigurationValue, loadConfigurationFile, assignIfNotExists
from saddlebags.EmblSubGenerator import EmblSubGenerator
from saddlebags.ImgtSubGenerator import ImgtSubGenerator
from saddlebags.AlleleSubmission import SubmissionBatch, AlleleSubmission

from json import dumps


#json_file = os.path.join(os.path.dirname(__file__), '')
#file_data = open(json_file).read()
#expected = json.loads(file_data)

# To run this, activate the environment
# source /home/ben/minionvent/bin/activate
# Browse to the project folder and run nosetests.
# cd /home/ben/Github/saddlebags
# nosetests
# to see the console output (probably useful, nosetests hides all output.)
# nosetests --nocapture


def testWriteConfigFile():
    # This will generate a full configuration and write it to file.
    # It will overwrite your previous configuration, sorry.
    assignIfNotExists('test_submission', '1')
    assignIfNotExists('logging', '1')
    assignIfNotExists('embl_ftp_upload_site_test', 'webin.ebi.ac.uk')
    assignIfNotExists('embl_ftp_upload_site_prod', 'webin.ebi.ac.uk')
    assignIfNotExists('embl_rest_address_test', 'https://www-test.ebi.ac.uk/ena/submit/drop-box/submit/')
    assignIfNotExists('embl_rest_address_prod', 'https://www.ebi.ac.uk/ena/submit/drop-box/submit/')
    assignIfNotExists('nmdp_act_rest_address', 'http://act.b12x.org')

    submissionBatch = SubmissionBatch()

    # Assign some information about this batch of submissions.
    submissionBatch.imgtSubmitterId = 'IMGTHLA_Submitter_ID'
    submissionBatch.imgtSubmitterName = 'Ben Bioinformaticist'
    submissionBatch.imgtAltContact = 'IMGTHLA_Alt_Contact'
    submissionBatch.imgtSubmitterEmail = 'Ben@BioinformaticsResearch.com'
    submissionBatch.labOfOrigin = 'Maastricht University Medical Center'
    submissionBatch.labContact = 'Marspel JR Spilanus'

    # Add a few submissions to this batch.
    # Submission # 1
    submission1 = AlleleSubmission()
    submission1.submittedGene.fullSequence = 'GAAAGACCTGAAAGATCACGGTGCCTTCATTTCAACTGTGAGACATGATGTAATTTTCACAAATCTACAACAGTAAGATATAGTGCAACAGGACCAGATTAAGGTCTCCTGGTTTGCAACCATGTCCCCTCCATCTCCTTTACTCCTGAACACACTCACTCCTGCAAACAGTTCTCTTGTCAAGTGGGAAATGAATGCTCTTACAAGGCTCAAACTTGTGAACACATCACTGACCAGCACAGAGCTAAAATAATTGGGGCTAAAAATACCGCCCCAATTAAAGTGTTTTACATGCAACTGGTTCAAACCTTTCAAGTACTAAAAACAATCCTGTAAAGAAGGAAATTCTGTTTCAGAAGAGGACCTTCATACAGCATCTCTGACCAGCAACTGATGATGCTATTGAACTCAGATGCTGATTCGTTCTCCAACACTAGATTACCCAATCCAGGAGCAAGGAAATCAGTAACTTACTCCCTATAACTTGGAATGTGGGTGGAGGGGTTCATAGTTCTCCCTGAGTGAGACTTGCCTGCTGCTCTGGCCCCTGGTCCTGTCCTGTTCTCCAGCATGGTGTGTCTGAGGCTCCCTGGAGGCTCCTGCATGGCAGTTCTGACAGTGACACTGATGGTGCTGAGCTCCCCACTGGCTTTGGCTGGGGACACCAGACGTAAGTGCACATTGTGGGTGCTGAGCTACTATGGGGTGGGGAAAATAGGGAGTTTTGTTAACATTGTGCCCAGGCCATGTACCTTAAGAAATTGTGACGTATTTTTCAGAGATTGCCCATCTTTATCATATGGATCCCAAATAATTTCCCCACCACAAAAGGAGCTTGGCTACTTGCCCACTCCATGAGACTTGTGTAAGGGGCCTCCATACAGGTCATTTCTACTCAAATCTCCACCAATAAAACCTTTGCATCACATGTCCTCAGGGTCTTTAGAGGATTTAGAAATAAGGATGCTAAAATAAATTCCCCATACAGCACTTGCCTTTATTATGTTGACTTATGTCAGACAAAGGAGGTTTTTTCTGAAAATTTTGTGGAAGTCAAGGGAATTTAAAGGGTCTCTCCTAAACGATCCTGGGTTATGTCACCCACAGGACCTTTGGTGTTGGCCCCTCTTCCTCATATGTGAGGATGGACCCAGTGGCCTCCCCATTATCTACTTTCTTTTCTTTCTGAACTCCAATGTTTATAAAGCCTGTACCCCTGTAGTGTATGTAGGTTGTCTGACAGAAGTTATACTTAGTGCTCTTTCTTTCTTGTGGGGAAAAATCCCTGGAACTGAAGCTGAGATCTTTAGTACTTGGAGTCACCTTACAGATACAGAGCATTTATGAGGTATTCTTTGGTGCCTAAAGAACTTAAGGCATCCTCTGAAAACCTGGCCCAGGTTAGTGTTTATTATGAATCTCTTTTAACCTTTCTATACTTGTTTCTCCTACATCTCCTAAGTGCTCCAACTAGACATGACAGAAGAGATTTAACTAACGTAGTATGAGTTATATAAAATTCTATTTTTGTAAGTCAAAAATAATCAAATATCAAAAATTTAATAATGTTCAAACTATATACTCTGTGTGGGGTTACCGAGACAATGTGGACATTGTTCACATCTCATAGGGCTGAAAGTCAATGGGCAAGTCCTGGGAACTCATTGTCTTACTGGGGTCTTGTCCTAAATTTCATAGGTTCACCCATCATGCCCTCAACTTTCCTTAATTAGCCATGTCTGCTTACCTCTTCCTCCAGTTTCCCTCTTATTTTTCCCCAGCTATGTTGTTATCATTTCCAGAAATCTCTAAAGCTTGCACAGATCCTTAGCACTATGAGATCCATTGAAAGAGATAGTTTTTTTCTTTTTGAGATAGGGCCTGGCTCTGTCACCCAGGCTGTAGCTCAGTGGTGCGATCGAGGCTCACTGCAACCTCTGCCTCCCACGCTCAAGTGATCCTCCCTCCTCAGGCTCCAGAGTAGCTGGGAATACAGGCAGGCAACCACGCCCAGCTAATTTTTGTAATTTTGGTAGAAATGAGATTTTGCCATGTTGCCCAGGCTGGTCTTAAACTGCTGGACTCAAGCAATCCTCCTGCCTTGGCCTCCCAACATGCTAGGATTATAGATGTGAGCCACTGTGCCCAGGCAAAAAGAGATGACTCTCAATAAAAAAAAGTCCTTTTTCTTAAATCACTGTTTCTTTATCTGTGAATTCTTCTTCCAACTAGAAGGAGGAGAAAGAAGTTTGCCTGTATTTCTCACCAGGAGGAGAAGGGGTCTAGTGTGACATCAGAATGAAAGAGTGCTGGAGTTTGAGCCCCTTCTTGCTTTCCAAGATCCCCACAGTTATCACTTCCCATACCCTGGTTTATTCATGTAAACCACACTTATTTTTCTTAGCAGCTACTGTGTACTCGGCTCCATTCTAGGTTCAGATCATTCTATTTGATTAAGACAGAGAGGGTCCCGACTCTCATGGAAGTTACACAACAATAGAGGAGACAGACACTAACCCAATAAGCATTTAACAAAGAATAAAATATTAGAGAGTCATAGTGCACTGAAGAAAAGACATCAGGTTTGTGAAGAAGAGAGACATGGATTCACCTACTTTAGTTCATATGTTTAGGGAGCTCTACCTGAGAAAGTGACATTCAGCTGAGACAACAAAATAAGTAGACAGTCATGAAGATCTAATGGACGAAAGCTCCAGAGAGACCAAATGGGGGGAAAGCCCTGGTGTGGGAAATTATGTGGAGAGAGAGAAAGACGGCTAGAGGGGCTGATGTATAGAAAGTAAGGAAATGGAGAGGCAGAAGATGAGGTAGGACACAGAGAGAAAGTCAGGAGCCTCATCATTATAGGCTCTGATGTCCACGGTAAAAAATTTGAATTTTATTTTATTTATTTATTTATTTATTTATTTATTTATTTTATTTATTTATTTATTTTTTTAAGATGGAGTCTCGCTTTGTTGCCCAGGCTGGAGTGCAGTGGCGTGATCTCAGCTCACTGCAAGCTCCACCTCCTGGGTTCATGCCATTCTCCTGCCTCAGCCTCCCTAGTAGCTGGGACTACAGGCACCTGCCACCACGCCTGGCTAATTTTTAGTATTTTTAGTAGTGAGGGCATTTTGTCATGTTAACCAGGGTGGTCTCCATCTCCTGACCTCGTGATCCACCTGCCTCAGCCTCCCAAAGTGCTGAGACTACAGGTGTGAGCCACCACGCCTGGCCTATTTTTTTTTTTTTGAGACGGAGTTTCGTTCTTGTTGCCCAGGCTGGAGTGCAATGGTGCAATCTCGGCTCACTGCAACCTTCGCCTCCCTGGTTCAAGTGATTCTCCTGCCTCAGCTTCCCAAGTATCTGAGATTACAGGCACCCACCACCATACCTGGCTAATTTTTATTTTTTTGTATTTTTAGTAGACATGGGGTATCACCATGTTGACCATGCTGGTCTCGAACTCCTGACCTCAGATAATCTGTCTGCCTTGGCCTCCCAAAGTGCTGGGATTACAGGCATGAGCCACCGCGGCCGGACTGAATTTTATTTAAATAGATACGAGAAGCTACTGTATGGTTACAAGGAGAGTCAATTTATATTCAATTTATTTTTATTTTATTTTATTTTTTTGGTGATGGGGTCTTGCTCTGTTGCCCAGGCTAGATTGTAGTGGCACAATCTCGGCTCACTGCAACCTCTGCCTTCTGGGTTCAGGCGATTCTCCTGACTCAGCCTCCAGAGTAGCTGGGACCACAGGTACATGCCACCACACCTGGCTAAGTTTTTGTATTTTTTAGTAGAGACAGGATTTCACCATGTTAGCCAGGATGGTCTCGATCTCCTGATCTCGTGATCCACCCACCTTGGCCTCCCAAAGTGCAGGGATTACAGGCCTGAGCCACTGCGCCCGGCCTATATTCAATTTTTAAAACTAATTCTAGCTACTCTGTGGGGATTGGAATGTTGGGGTTCACAAGTGGTCAGGAAGACTATTTAGGAGCACAGCAGGGAATTCTCCAGCGAAAACAGGCTTGTGGCTTCATGGAGTGCATTAGTGATAAAGACGGTGAAAAAGATAAAGTGGACAGACTTGGCATGTATTTTTCCTTAGCTTGTTAATGAATTACTGTAAAGGGGGTAGAACAATCAAGCTTATTCCTAAGGATTTTGTTTTGACAAATAAGTGGGTGGTAGTGTTGTTTATTGAGATAGGAAAAACTATGGGAGGAAATTATTTGAAGTGGGTGGTTGGAAATAAAAGTTTTGTTTAAATTTGAGATGATTTATTGACATTTATGTGGAGCAATCAGAAGGTCAATGGCATTTAAGAGACTCATGGTGAGGCTAGGGCTTCAAGTATTTATGTTGGCGGCATCAATACGTGTAGTGTGTTAAATTCCAGGGAGTGGAAGAGGATACATAGGGAGATGGATTGTGTGGAGAAAAAAGAACAGGGCACAGGCCAGCAAAGGGGGCTGAGAAAGAGCCCAGGGATGTTGGAGAAAAATCAAGAGAACATGATGCATGTAAGTCAAGGAAAATAGATTTTTTTCAAGGAGAAGGGAGAGGCCAATTGTGGTGAGTACCACTAAGCGGAGGGGGAAGTGAGAACGTGACAGAGAAGCAAGTGCTGGGTTTGGTGGAGTTGATATTTGCAGTCAGTGGAGTATCCAGGGAGGAAACTGGATTGGACAATTTGAAGAGCGAGTAGAAGTGAGGATGAGGTTAAGGTTGACTGTTTTGAGTAGAGAGGTTCAGGGAAGGACTGCACTCTGGGTTCAGGGAGCCAGCTGGATCAAAAGGAAAAGGCTAAAGAGGCTGAAGAGAAGCAGGAGGACCTGTGAACCAGAGATGCTCAGTCATTATTAGCGAGGAAATACTAGAAAGCCCCTGTGTGCAGTGATGACTACTCATGCAGAAGGTCACACAGCCAATATTTAACACAGCCAGTATTTCACACAGCTAATATTTATTAGTGACATAGAATATACCAGTTATTACTCTAGGTCATGAGAATGGAGTGATAAATAAAATGAATCCGGTCGCCATCAGTATATGCCATGTAACATTTTGCAGTGACTGTGTACCAGGCCTGTGAATTTCAGTATGCAATTTCAATAATGATCCTGCTGTATCTGTGGTGTTTAAAAACATATACATCTCTGGAATCTAAAATTGAGAGGTTATAAGTAAAACCCAGTATTACAAATTGAGTGCTGGAAATCAGATTGCAGTTTAAATCTGAGCATATAGAAAGTCCCTTTCTTCTATGTCAGCAGATGCCTTTTGTGTGAGGTTTAGCTGGACTGCATTATTAGACATAAACCAGTGTTTCTGCCCTATGTTTTCAGAATGACAATTCTTTATGAAACTCATAGAAGAACAGAAGACAACTGCAAAATCATGATGAAGATAGTAATTGCTTTAGAATTAAGGAATACAAAAAATAATGTGAGCTGTAGTTATAGGGATCATAAAAGTTTAAATGGGAATGTATTTGAGTATGTGATCAGTGCTAAGAAGAGTCATCATTTAATTTTACACTTAACAGTAATCTCGTGAGGATTACGCTATTATTAAATGCATTTGATAGATTACAAAAAGGCTTATGGTTGGTAAAAATTGACCCAAGTAGAAGAGATCATGTTTTTATTCAGGTTTTCTGATTCTAGAGTTTGAGAGTTTGTCCATCATTAGTGAGTAGTGACTATATTGTGTCTGAATTATTGACAGAATTTCTGATATTCATATGTACCAGGTTGTTTCTTAGAGTGGGGATAGAGATGCAAGGGCTGCTAGTTCCGATGTATTGGGGAAACTTTCATTCATTTTGCATTTATCATTTTAAAGTTCTGTATGTCTATAATGGTCATGTGTTGAAGAACACAAGGAAGTATTAAATCACTCCTTCTTCTAAGGTTTGACTAGCAAGTTGGGCTAGAGTTACCAAATAAAATACATGTTCCTAGTGAAATCTGAATTTCAGATACAAAACCATAATTTATTGAAAATCCAAATTTAACTGGGCATCCTCTGGTTTTATTTGCCACATCTGTCAACCCTAAGTGCGACACATGGACATGGATTACAGTGCTAACCATGCAAGCCACGGTGACAGCAACTTCACACATGTTTATTTTTAACTTTCTCTGTAAGAAAGTGCTTAGATAATTTAGGGATAAAAAGATAGACATTGCTTGATCCAGGGTGCACACCTCTCTGCCACCATTTCTAAAGGCAAAGGGAGATTTCTGCAGGTCTTGCTCACAGTCTGGGGAGCTGCTCATTTTTGTAAAGTGTCTGTATGAGAATGTCATTTTCTTGGTTTCCTCCTTTCCGAGGGGACTTGACTACAAAACCAAGAGTTCTGCCTCTGGCCAAGGCTGGTAATTTGATGCCTGCTAGTATTGTTGGGAGTGGGAGACTGAAAGAAATGAGTTAGTTGGGGCATTTAACGGGAATAAAATAGCTGTGGTTGTGACTCATTACTACAGATAATTAGTGGACCAGTGGCAGAGAAATTAAGAAAAAAGATGATGTGAATGATAAATGATATGATTAGTGACTGCTTGGTAAGGCAAGGAAATCATTAAATCTTGGTTCTCATCAAGTTCATTTTCTGGAAAGATAGCACTGTATTGGGAGCAGAATTCTACAAAACCTTCTTTTTACATAGGACCAAGATTTTCAACAAATATTTTTCAATGCAATTCTCAGCTGCTCCATAACTAATAGTAGCTTGTTCAACACAGATTTTTTCAGATGATTCACACCTGTGGTACTTACCCAGGGATGGTTCACCACCCCTCCCTTCCCTCTCATCATCGTTGGGGAACGGTGACAATGTTTGGAACAATTTTTGGTTGTCACAAACAGGGGTTTCTTCTGATATTCAATGAGTAGAAGCCAGGGACACTGCTAGAGAACCCACAATGTTCAGAACAGCCTCTGCCATCAACAAGGAATTATCTGGTCCAAAATGTCAATAGTGCTGAGGCTAAGAGCACTGGTTCACACTGTGCTCTTTCTGAAAATTCTAGACTCACATCTGTTATACACTCACCACACAGTTTAGTCTTTTATTTTTGCTTGTTTCATTATAAACAATTAGACAGTTGTATAAATTCAACCACTTTCTTGTTGAATCCATTTAGTCAATGCAAGCTCAATATTTTCATATTTATTTTTTGCCTTATGCAATATTTTTCAACATTTTCATGAGTTGTCGGTCATCACTATCTCTATTAACTTTCAACAACTTGCCCTTGTAAGTCACAAATAGTGCTGCTGCTGAAATTATTTCTCACTAACATGCCTCAGATTTCTGTAGTGATTCTACATTTGATATTATTCACAATGTAAAATGCTTCTATTTATTCATTTCGCTTTTACCCAAGGATTATTTTTAAGTTATTTTTGTCATTTTCACACTTCAAACATAAAGACAAAAACATCAAAAATATAGTGTTTTACATATGTGCATATTTTCACACATATATGTATGTATATTTATATGTATTGAAACTACAGAAGCACATGTCACCAATAAGAGCTCTGAGACACCTTCGACCACTTACCCTTATCAGATGAGTTGTGGAAACAAGTTTTTTTTAACTGAATTTCTGAGCTTTGTGGATTTAGAAATGCAAAGGAAGGTTTGTGGACATTCACAGGGATCATGATTTTATTCTCCTTAAAACTCTTCTGTACTTTCCAATTGTCCTTAGTATAAATCCAAAATCCTAACACCACCCAAGAGGCTTTTCAATACCTGGCTCCTGTGATTTCTCCTGTCTAATCTTTTACCCTCCTTCCCCTCAGCCTCTCTGCTTTAGTGAACTTTCTCCTAGTTTTTTGAAGAAGTTCATCAATTCAAGCTTTTGTACATGGGATTTCCTAAACCTGAAATGTGCCTCCCGTTTTGTCCAAACAGACACGGGCTCCACTCTGCCCCCTGGCTCACACCTGCTTAACCTGTCAAGTCACATCTGAACCGTCACTATTAAGAGGGTCCTTCTCTGGCACCCTAATGTAATTGAGATCATCCTATTATTCTCTGTTCTAGAACTCCACACTTCCGACATTTCTCATTCCTGTCTAAGCTCTTGTGTGTTTGGTGTTGGGCCATCACTTTCACTGCTCTTTAAGCTCCCCCAGCGGAGTGGAGAGGTCTGTTTTCCCTCGTTTGGATTCCTAGAGGCAGCGCAGACCAGGCACAAGGTCAGCACTAAGGAAGGGTTCACAGGATGAACGCGGTGGGTGCTGTTTAAGGAACCGGTAAACGTGTGGGATGAGAGAAGGAGCAGAGTGTCTTTGGGGTGGAGGCTCCCAGGAGGAGGCGGCGCGGGCTGCGGTGCGGGGCGGATCCTCCTCCAGCTCCTGCTTGGAGGTCTCCAGAACAGGCTGGAGGTAGGGAGGGGGGTCCCAAAAGCCTGGGGATCAGACGTGGTTTTCCCGCCTGGTCCCCCAGGCCCCCTTTCGCCTCAGGAAGACAGAGGAGGAGCCCCTGGGCTGCAGGTGGTGGGCGTTGCGGCGGGGGCCGGTTAAGGTTCCCAGTGCCCGCACCCGGCCCAGGGAGCCCCGGATGGCGGCGTCACTGTCAGTGTCTTCTCAGGAGGCCGCCTGTGTGACTGGATCGTTCGTGTCCCCACAGCACGTTTCTTGGAGTACTCTACGTCTGAGTGTCATTTCTTCAATGGGACGGAGCGGGTGCGGTTCCTGGACAGATACTTCTATAACCAAGAGGAGTACGTGCGCTTCGACAGCGACGTGGGGGAGTTCCGGGCGGTGACGGAGCTGGGGCGGCCTGATGAGGAGTACTGGAACAGCCAGAAGGACATCCTGGAAGACGAGCGGGCCGCGGTGGACACCTACTGCAGACACAACTACGGGGTTGTGGAGAGCTTCACAGTGCAGCGGCGAGGTGAGCGCGGCGCGGGGCGGGGCCTGAGTCCCTGTGAGCTGGGAATCTGAGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGAGAGAGAGACAGAGAGACAGAGAGAGAGAGAGCGCCATCTGTGAGCATTTAGAATCCTCTCTATCCTGAGCAAGGAGTTCTGAGGGCACAGGTGTGTGTGTAGAGTGTGGATTTGTCTGTGTCTGTGAGGCTGTTGTGGGAGGGGAGGCAGGAGGGGGCTGCTTCTTATTCTTGGAGGACTCTGTGGGGAGGTGACAAGGGAGGTGGGTGCGGGCGGCTGGAGAGAGAGGTGACCTTGATTGTCTCGGGTCCTTAGAGATGCAGGGAAGGGAAATGTAAGGGGTGTGTGGTTGGGGTGAAGGTTTAGGGGAGGAGAGCTGAGGGGTAAGGAAGGTTTGGGATAATGTGAGGAGGCCAGTTCCAGACTGTCCCTGGCACACACCCTTCATGTAATCTCTGAAATAAAAGTGTGTGCTGTTTGTTTGTAAAAGCATTAGATTAATTTCTAGGGGAATTGAGGAGACCTCTGAGGCATCTCTGAAGCTTCTTTAGGTCTAAATTTCTTGCTAGTTTTTTGTTTTTTATTGTGTATATTTTTACATAGTAGAAATGACTGTGAAACTAACTTTTTGAATTAAAGTTTTAACACAGTTACTATTTTATTATAATGCTAATAGTTTTCTAGTAGTTACATATTATTCTTTTATATATAATAGTTGTGACACAACTTACCTCACTTTCCCCTTTGTTGACCTTTATTATGACATTCACCAAAATTTGAAAATGTATGTTTCTGGTTAATTTTTAATTTATATTTTTTTCATTTATAATTCTTTTGAATTATTTTGACCTATTTATTGGCCAGTTTTAATAACTGCTGTAAGAATTCCCTATTGTATTTGGTAGGGAATGGACAATGATCTACTGCCTAATATCTCGAGGGCTTAGTATTTTTCTCAGTGACTTTGTGGGTTCTTTGTACTGTGAGATTATTAACACTTTATTGATATTTGATTCAGCATTTGCTCCAGTTTGTGGTTTGTATGTTGATTTTGAAAATTCTTTTCCATGTTAAGAATTTGAACATTTTTATATAATAAAATATGTTGCAAAATTTTTATTAATGATTTACAATCCATCTTAAATCTGCCATTTTGTGGTATTGTTGTCTCCAGGTTTCTCCTTACTTCTAAAAAAAATTGCATTTATTGAGAGTCTGCTAGTGTTAGGGATTTTCCTGGGCATAAGCACCCCAAGTGACGAGTCCCAGACACTGCCTTAATCCAAATGTGATTCTGGAAAGAAAAATCATTTTACAATGATAGGCCTAATAATAATTAAGCTTGTGTTGCATGGGAGATGCATTGATCAGCTAAATGTAAATATAAGAACTTTCAAAACTAAAATGACGTTCCTTAATCCTTCTCTCTGCTTTATGACTCATGCTTTTCTGGGAAAGTAAAAATTTGGAGAATCATTTCTGTCTGTCCCACCTTCCCAGGGGCAGAACCATTTCTGTGGTGTTCTAAGGTGTGAGTGCATGGCGGTAGTATTCCTAAAAATTCATATTCGGTTTCGTCATGTACCCAACTCTGTCCCGTTATCTATCAACATTGTTTTAAATCATATATTTCTGTCAAGGTGTACAAGGATGATAAATAGGTGCCAAGTGGAGCACCCAAGTGTGATGAGCCCCCTCACAGTGGAATGGAGTGTGAAGCTTTATGACCTCATAAATTGAAGGTTATCTTCAGTCATTGTTTTATATATTTTACATGCATTAATCCTCATATAATCCCAAGAGGTAAATTAGTATAATTATCCTTCATTATAGGTGACAAAGTTGAGACACAGAAGAATCGAACTCTTAAGGCAGACCTTGGATTTGAACCAGGCAACCTGGCTCAGATATCAGTTTTAATTACTACACTCTGTACTTTCAAAGATTTGTAAACACTTTGACAATGCATGACAATTTCAAGCTATGAAGAAACAAACACAATTTTTCACAATATCTCTCAAATCTAATAGGTCCTCACTATCAAGATTAAGTTCCAGGCTGATGACACTGTAAGGCCACATGGCCAGCTGTGCTGGAGGCCTGGTCAAGGTCAGAGCCTGGGTTTGCAGAGAAGCAGACAAACAGCCAAACAAGGAGACTTACTCTGTCTTCATGACTCATTCCCTCTACCTTTTTTCTCCTAGTCCATCCTAAGGTGACTGTGTATCCTTCAAAGACCCAGCCCCTGCAGCACCACAACCTCCTGGTCTGTTCTGTGAGTGGTTTCTATCCAGGCAGCATTGAAGTCAGGTGGTTCCGGAATGGCCAGGAAGAGAAGACTGGGGTGGTGTCCACAGGCCTGATCCACAATGGAGACTGGACCTTCCAGACCCTGGTGATGCTGGAAACAGTTCCTCGGAGTGGAGAGGTTTACACCTGCCAAGTGGAGCACCCAAGCGTGACAAGCCCTCTCACAGTGGAATGGAGTGAGCAGCTTTCTGACTTCATAAATTTCTCACCCACCAAGAAGGGGACTGTGCTCATCCCTGAGTGTCAGGTTTCTCCTCTCCGACATCCTATTTTCATTTGCTCCATGTTCTCATCTCCATCAGCACAGGTCACTGGGGGTAGCCCTGTAGGTGTTTCTAGAAACACCTGTACCTCCTGGAGAAGCAGTCTCGCCTGCCAGGCAGGAGAGGCTGTCCCTCTTTTGAACCTCCCCATGATGTCACAGGTCAGGGTCACCCACCCTCCCCGGGCTCCAGGCACTGCCTCTGGGTCTGAGACTGAGTTTCTGGTGCTGTTGATCTGAGTTATTTGTTGTGATCTGGGAAGAGGAGAAGTGTAGGGGCCTTCCTGACATGAGGGGAGTCCAATCTCAGCTCTGCCTTTTATTAGCTCTGTCACTCTAGACAAACTACTTAGCCTCATTGAGTCTCAGGCTTTCTGTGGATCAGATGTTGAACTCTTGCCTTACATCAAGGCTGTAATATTTGAATGAGTTTGATGTCTGAACCTTGTAACTGTTCAGTGTGATTTGAAATCCTTTTTTTCTCCAGAAATGGCTAGTTATTTTAGTTCTTGTGGGGCAGACTTCTTCCCCATTTTCAAAGCTCTGAATCTTAGAGTCTCAATTAAAGAGGTTCAATTTGGAATAAACACTAAACCTGGCTTCCTCTCTCAGGAGCACGGTCTGAATCTGCACAGAGCAAGATGCTGAGTGGAGTCGGGGGCTTTGTGCTGGGCCTGCTCTTCCTTGGGGCCGGGCTGTTCATCTACTTCAGGAATCAGAAAGGTGAGGAGCCTTTGGTAGCTGGCTCTCTCCATAGGCTTTTCTGGAGGAGGAACTATGGCTTTGCTGAGGTTAGTTCTCAGTATATGAGTGGCCCTGAATAAAGCCTTTCTTTCCCCAAACGGCTCTAATGTCCTGCTAATCCAGAAATCATCAGTGCATGGTTACTATGTGAAAGCATAATAGCTTGTGGCCTGCAGAGACAAGAGGAAGGTTAACAAGTAGGGGTCCTTTGGTTTGAGATCTTGGAGCAGATTAAGGAAGAGCCACTAAGACTAATGGAATTACACTGGATCCTGTGACAGACACTTCACCCTTCATGGGTCACATGGTCTGTTTCTGCTCCTCTCTGCCCTGGCTGGTGTGGGTTGTAGTGACAGAGAACTCTCCGGTGGGAGATCTGGGGCTGGGACATTGTGTTGGAAGACAGATTTGCTTCCATAAATTTTAAGTGTATATATTTTCCTCTTTTTCCCAGGACACTCTGGACTTCAGCCAAGAGGTAATACCTTTTAATCCTCTTTTAGAAACAGATACGGTTTCCCTAGTGAGAGGTGAAGCCAGCTGGACTTCTGGGTCGGGTAGGGACTTGCAGAACTTTCCTGTCTTAGGAGAGGTTTCTAAATGCACCAATCAGTGCTCTGTAAAAACACACCAATTGGCACTCTGTGGCTAGATAGATGTTTGTAAAATGGACTAATCAGCACTCTGTAAAATGGAGCAATCCACACTCTGTAAAATGGACCAATCAATGCTCTTTAAAATGGACCAATCAGCAGGACATGGGCGGGGACAAATAAGGGAATACAAGCTGGCCACCCCAGCCAGCAGCAGCAACCCGCTCAGGTCGCCTTCCATGCTGTGGAAGCTTTGTTCTTTTGCTCTTCACAATAAATCTTGCTGTTGCTCACTCTTCGGGTCTGTGCCACCTTTAAGAGCTGTAACACTCACTGTGAAGATTCGCGGCTTCATTCTTGAAGTCAGCGAAACCACGAACCCACCGGAAGGAACAAACTCTGGACACACTAGAATTGATGGTAGAGGTGATAAGGCATGAGACAGAAATAATAGGAAAGACTTTGGATCCAAATTTCTGATCAGGCAATTTACACCAAAACTCCTCCTCTCCACTTAGAAAAGGCCTGTGCTCTGTGGGACTATTGGCTCTGGGAGACTCAGGAACTTGTTTTTCTTCTTCCTGCAGTGCTCTCATCTGAGTCCCTGAAAGAGAGGAAAAGAAACTGTTAGTAGAGTCAGGTTGAAAACAACACTCTCCTCTGTCTTTTGCAGGATTCCTGAGCTGAAGTGCAGATGACACATTCAAAGAAGAACTTTCTGCCCCAGCTTTGCAGGATGAAAAGCTTTCCCTCCTGGCTGT'
    submission1.submittedGene.geneLocus = 'HLA-DRB1'
    submission1.localAlleleName = 'DRB1_11_new'
    submission1.closestAlleleWrittenDescription = 'DRB1:11 with a SNP in exon 2'
    submission1.imgtSubmissionIdentifier = 'HWS100234567'
    submission1.imgtSubmissionVersion = '1'
    submission1.cellId = 'Cosang_Cell_Line_1'
    submission1.ethnicOrigin = 'Caucasoid - Dutch/Irish/English, Europe'
    submission1.sex = 'M'
    submission1.consanguineous = 'Unknown'
    submission1.homozygous = 'Unknown'
    submission1.typedAlleles = 'HLA-A*01:01:01:01;HLA-B*40:72:01;HLA-DRB1*07:75;HLA-A*03:73;HLA-B*44:87;HLA-DRB1*14:90'
    submission1.materialAvailability = 'No Material Available'
    submission1.cellBank = 'Not Available'
    submission1.primarySequencingMethodology = 'Direct sequencing of PCR product from DNA (SBT)'
    submission1.secondarySequencingMethodology = 'MinION 2D Amplicon Sequencing'
    submission1.primerType = 'Both allele and locus specific'
    submission1.primers = '03PID03     CCCAAAGGGTTTCCCGGGAAATTT 3UT 3015-3042;04PID04     AAAGGGTTTCCCGGGAAATTTCCC 5UT 4015-4042'
    submission1.sequencedInIsolation = 'Yes'
    submission1.numOfReactions = '3'
    submission1.methodComments = 'Sanger SBT with confirmatory MinION Long Range sequencing.'
    submission1.citations = '1-3503;PUBMED; 9349617.;Laforet M, Froelich N, Parissiadis A, Pfeiffer B, Schell A, Faller B, Woehl-Jaegle ML, Cazenave JP, Tongio MM;A nucleotide insertion in exon 4 is responsible for the absence of expression of an HLA-A*01 allele;Tissue Antigens 50:347 - 50(1997).;1-3503;PUBMED; 9349617.;Laforet M, Froelich N, Parissiadis A, Pfeiffer B, Schell A, Faller B, Woehl-Jaegle ML, Cazenave JP, Tongio MM;A nucleotide insertion in exon 4 is responsible for the absence of expression of an HLA-A*01 allele;Tissue Antigens 50:347 - 50(1997).'
    submissionBatch.submissionBatch.append(submission1)

    # Submission # 2
    submission2 = AlleleSubmission()
    submission2.submittedGene.fullSequence = 'CAGAAGCAGAGGGGTCAGGGCGAAGTCCCAGGGCCCCAGGCGTGGCTCTCAGGGTCTCAGGCCCCGAAGGCGGTGTATGGATTGGGGAGTCCCAGCCTTGGGGATTCCCCAACTCCGCAGTTTCTTTTCTCCCTCTCCCAACCTATGTAGGGTCCTTCTTCCTGGATACTCACGACGCGGACCCAGTTCTCACTCCCATTGGGTGTCGGGTTTCCAGAGAAGCCAATCAGTGTCGTCGCGGTCGCGGTTCTAAAGTCCGCACGCACCCACCGGGACTCAGATTCTCCCCAGACGCCGAGGATGGCCGTCATGGCGCCCCGAACCCTCGTCCTGCTACTCTCGGGGGCTCTGGCCCTGACCCAGACCTGGGCGGGTGAGTGCGGGGTCGGGAGGGAAACGGCCTCTGTGGGGAGAAGCAACGGGCCCGCCTGGCGGGGGCGCAGGACCCGGGAAGCCGCGCCGGGAGGAGGGTCGGGCGGGTCTCAGCCACTCCTCGTCCCCAGGCTCTCACTCCATGAGGTATTTCTTCACATCCGTGTCCCGGCCCGGCCGCGGGGAGCCCCGCTTCATCGCAGTGGGCTACGTGGACGACACGCAGTTCGTGCGGTTCGACAGCGACGCCGCGAGCCAGAGGATGGAGCCGCGGGCGCCGTGGATAGAGCAGGAGGGTCCGGAGTATTGGGACGGGGAGACACGGAAAGTGAAGGCCCACTCACAGACTCACCGAGTGGACCTGGGGACCCTGCGCGGCTACTACAACCAGAGCGAGGCCGGTGAGTGACCCCGGCCCGGGGCGCAGGTCACGACCTCTCATCCCCCACGGACGGGCCAGGTCGCCCACAGTCTCCGGGTCCGAGATCCGCCCCGAAGCCGCGGGACCCCGAGACCCTTGCCCCGGGAGAGGCCCAGGCGCCTTTACCCGGTTTCATTTTCAGTTTAGGCCAAAAATCCCCCCAGGTTGGTCGGGGCGGGGCGGGGCTCGGGGGACCGGGCTGACCGCGGGGTCCGGGCCAGGTTCTCACACCGTCCAGAGGATGTATGGCTGCGACGTGGGGTCGGACTGGCGCTTCCTCCGCGGGTACCACCAGTACGCCTACGACGGCAAGGATTACATCGCCCTGAAAGAGGACCTGCGCTCTTGGACCGCGGCGGACATGGCAGCTCAGACCACCAAGCACAAGTGGGAGGCGGCCCATGTGGCGGAGCAGTTGAGAGCCTACCTGGAGGGCACGTGCGTGGAGTGGCTCCGCAGATACCTGGAGAACGGGAAGGAGACGCTGCAGCGCACGGGTACCAGGGGCCACGGGGCGCCTCCCTGATCGCCTGTAGATCTCCCGGGCTGGCCTCCCACAAGGAGGGGAGACAATTGGGACCAACACTAGAATATCGCCCTCCCTCTGGTCCTGAGGGAGAGGAATCCTCCTGGGTTTCCAGATCCTGTACCAGAGAGTGACTCTGAGGTTCCGCCCTGCTCTCTGACACAATTAAGGGATAAAATCTCTGAAGGAATGACGGGAAGACGATCCCTCGAATACTGATGAGTGGTTCCCTTTGACACACACAGGCAGCAGCCTTGGGCCCGTGACTTTTCCTCTCAGGCCTTGTTCTCTGCTTCACACTCAATGTGTGTGGGGGTCTGAGTCCAGCACTTCTGAGTCCTTCAGCCTCCACTCAGGTCAGGACCAGAAGTCGCTGTTCCCTCTTCAGGGACTAGAATTTTCCACGGAATAGGAGATTATCCCAGGTGCCTGTGTCCAGGCTGGTGTCTGGGTTCTGTGCTCCCTTCCCCATCCCAGGTGTCCTGTCCATTCTCAAGATAGCCACATGTGTGCTGGAGGAGTGTCCCATGACAGATGCAAAATGCCTGAATGATCTGACTCTTCCTGACAGACGCCCCCAAAACGCATATGACTCACCACGCTGTCTCTGACCATGAAGCCACCCTGAGGTGCTGGGCCCTGAGCTTCTACCCTGCGGAGATCACACTGACCTGGCAGCGGGATGGGGAGGACCAGACCCAGGACACGGAGCTCGTGGAGACCAGGCCTGCAGGGGATGGAACCTTCCAGAAGTGGGCGGCTGTGGTGGTGCCTTCTGGACAGGAGCAGAGATACACCTGCCATGTGCAGCATGAGGGTTTGCCCAAGCCCCTCACCCTGAGATGGGGTAAGGAGGGAGACGGGGGTGTCATGTCTTTTAGGGAAAGCAGGAGCCTCTCTGACCTTTAGCAGGGTCAGGGCCCCTCACCTTCCCCTCTTTTCCCAGAGCCGTCTTCCCAGCCCACCATCCCCATCGTGGGCATCATTGCTGGCCTGGTTCTCTTTGGAGCTGTGATCACTGGAGCTGTGGTCGCTGCTGTGATGTGGAGGAGGAAGAGCTCAGGTGGGGAAGGGGTGAAGGGTGGGTCTGAGATTTCTTGTCTCACTGAGGGTTCCAAGACCCAGGTAGAAGTGTGCCCTGCCTCGTTACTGGGAAGCACCACCCACAATTATGGGCCTACCCAGCCTGGGCCCTGTGTGCCAGCACTTACTCTTTTGTAAAGCACCTGTTAAAATGAAGGACAGATTTATCACCTTGATTACAGCGGTGATGGGACCTGATCCCAGCAGTCACAAGTCACAGGGGAAGGTCCCTGAGGACCTTCAGGAGGGCGGTTGGTCCAGGACCCACACCTGCTTTCTTCATGTTTCCTGATCCCGCCCTGGGTCTGCAGTCACACATTTCTGGAAACTTCTCTGAGGTCCAAGACTTGGAGGTTCCTCTAGGACCTTAAGGCCCTGACTCCTTTCTGGTATCTCACAGGACATTTTCTTCCCACAGATAGAAAAGGAGGGAGCTACTCTCAGGCTGCAAGTAAGTATGAAGGAGGCTGATGCCTGAGGTCCTTGGGATATTGTGTTTGGGAGCCCATGGGGGAGCTCACCCACCCCACAATTCCTCCTCTAGCCACATCTTCTGTGGGATCTGACCAGGTTCTGTTTTTGTTCTACCCCAGGCAGTGACAGTGCCCAGGGCTCTGATGTGTCTCTCACAGCTTGTAAAGGTGAGAGCCTGGAGGGCCTGATGTGTGTTGGGTGTTGGGCGGAACAGTGGACACAGCTGTGCTATGGGGTTTCTTTCCATTGGATGTATTGAGCATGCGATGGGCTGTTTAAAGTGTGACCCCTCACTGTGACAGATACGAATTTGTTCATGAATATTTTTTTCTATAGTGTGAGACAGCTGCCTTGTGTGGGACTGAGAGGCAAGAGTTGTTCCTGCCCTTCCCTTTGTGACTTGAAGAACCCTGACTTTGTTTCTGCAAAGGCACCTGCATGTGTCTGTGTTCGTGTAGGCATAATGTGAGGAGGTGGGGAGACCACCCCACCCCCATGTCCACCATGACCCTCTTCCCACGCTGACCTGTGCTCCCTCCCCAATCATCTTTCCTGTTCCAGAGAGGTGGGGCTGAGGTGTCTCCATCTCTGTCTCAACTTCATGGTGCACTGAGCTGTAACTTCTTCCTTCCCTATTAAAA'
    submission2.submittedGene.geneLocus = 'HLA-A'
    submission2.localAlleleName = 'A_02'
    submission2.closestAlleleWrittenDescription = 'A02_known_allele'
    submission2.imgtSubmissionIdentifier = 'HWS104234667'
    submission2.imgtSubmissionVersion = '1'
    submission2.cellId = 'Cosang_Cell_Line_1'
    submission2.ethnicOrigin = 'Caucasoid - Dutch/Irish/English, Europe'
    submission2.sex = 'M'
    submission2.consanguineous = 'Unknown'
    submission2.homozygous = 'Unknown'
    # Necessary = A,B, DRB1. The rest are extra, and they help James trust the submitted sequence.
    submission2.typedAlleles = 'HLA-A*01:01:01:01;HLA-B*40:72:01;HLA-DRB1*07:75;HLA-A*03:73;HLA-B*44:87;HLA-DRB1*14:90'
    submission2.materialAvailability = 'No Material Available'
    submission2.cellBank = 'Not Available'
    submission2.primarySequencingMethodology = 'Direct sequencing of PCR product from DNA (SBT)'
    submission2.secondarySequencingMethodology = 'MinION 1D2 Amplicon Sequencing'
    submission2.primerType = 'Both allele and locus specific'
    submission2.primers = '03PID03     CCCAAAGGGTTTCCCGGGAAATTT 3UT 3015-3042;04PID04     AAAGGGTTTCCCGGGAAATTTCCC 5UT 4015-4042'
    submission2.sequencedInIsolation = 'Yes'
    submission2.numOfReactions = '3'
    submission2.methodComments = 'Sanger SBT with confirmatory MinION Long Range sequencing.'
    submission2.citations = '1-3503;PUBMED; 9349617.;Laforet M, Froelich N, Parissiadis A, Pfeiffer B, Schell A, Faller B, Woehl-Jaegle ML, Cazenave JP, Tongio MM;A nucleotide insertion in exon 4 is responsible for the absence of expression of an HLA-A*01 allele;Tissue Antigens 50:347 - 50(1997).;1-3503;PUBMED; 9349617.;Laforet M, Froelich N, Parissiadis A, Pfeiffer B, Schell A, Faller B, Woehl-Jaegle ML, Cazenave JP, Tongio MM;A nucleotide insertion in exon 4 is responsible for the absence of expression of an HLA-A*01 allele;Tissue Antigens 50:347 - 50(1997).'
    submissionBatch.submissionBatch.append(submission2)

    # Store my submission batch in the global variables.
    assignConfigurationValue('submission_batch', submissionBatch)

    writeConfigurationFile()


def testReadConfigFile():
    # Read config file and validate that all values we expect are here.

    # Clear previous configuration, just to be sure.
    # This assertion depends on the previous test. I wrote a bunch of configuration values and
    # then stored them, there should be something in submission_batch right now.
    assert(getConfigurationValue('submission_batch') is not None)
    clearGlobalVariables()
    assert (getConfigurationValue('submission_batch') is None)

    # Read configuration file
    loadConfigurationFile()
    assert (getConfigurationValue('submission_batch') is not None)

    # Assert that the values exist and are what we expect.
    assert (len(getConfigurationValue('submission_batch').submissionBatch) == 2)


def testCreateIMGTSubmissionFlatfileA():
    print ('Test: Creating IMGT Flatfile')

    mySubmissionBatch = getConfigurationValue('submission_batch').submissionBatch

    roughFeatureSequence = mySubmissionBatch[1].submittedGene.fullSequence
    # roughFeatureSequence = 'GAAAGACCTGAAAGATCACGGTGCCTTCATTTCAACTGTGAGACATGATGTAATTTTCACAAATCTACAACAGTAAGATATAGTGCAACAGGACCAGATTAAGGTCTCCTGGTTTGCAACCATGTCCCCTCCATCTCCTTTACTCCTGAACACACTCACTCCTGCAAACAGTTCTCTTGTCAAGTGGGAAATGAATGCTCTTACAAGGCTCAAACTTGTGAACACATCACTGACCAGCACAGAGCTAAAATAATTGGGGCTAAAAATACCGCCCCAATTAAAGTGTTTTACATGCAACTGGTTCAAACCTTTCAAGTACTAAAAACAATCCTGTAAAGAAGGAAATTCTGTTTCAGAAGAGGACCTTCATACAGCATCTCTGACCAGCAACTGATGATGCTATTGAACTCAGATGCTGATTCGTTCTCCAACACTAGATTACCCAATCCAGGAGCAAGGAAATCAGTAACTTACTCCCTATAACTTGGAATGTGGGTGGAGGGGTTCATAGTTCTCCCTGAGTGAGACTTGCCTGCTGCTCTGGCCCCTGGTCCTGTCCTGTTCTCCAGCATGGTGTGTCTGAGGCTCCCTGGAGGCTCCTGCATGGCAGTTCTGACAGTGACACTGATGGTGCTGAGCTCCCCACTGGCTTTGGCTGGGGACACCAGACGTAAGTGCACATTGTGGGTGCTGAGCTACTATGGGGTGGGGAAAATAGGGAGTTTTGTTAACATTGTGCCCAGGCCATGTACCTTAAGAAATTGTGACGTATTTTTCAGAGATTGCCCATCTTTATCATATGGATCCCAAATAATTTCCCCACCACAAAAGGAGCTTGGCTACTTGCCCACTCCATGAGACTTGTGTAAGGGGCCTCCATACAGGTCATTTCTACTCAAATCTCCACCAATAAAACCTTTGCATCACATGTCCTCAGGGTCTTTAGAGGATTTAGAAATAAGGATGCTAAAATAAATTCCCCATACAGCACTTGCCTTTATTATGTTGACTTATGTCAGACAAAGGAGGTTTTTTCTGAAAATTTTGTGGAAGTCAAGGGAATTTAAAGGGTCTCTCCTAAACGATCCTGGGTTATGTCACCCACAGGACCTTTGGTGTTGGCCCCTCTTCCTCATATGTGAGGATGGACCCAGTGGCCTCCCCATTATCTACTTTCTTTTCTTTCTGAACTCCAATGTTTATAAAGCCTGTACCCCTGTAGTGTATGTAGGTTGTCTGACAGAAGTTATACTTAGTGCTCTTTCTTTCTTGTGGGGAAAAATCCCTGGAACTGAAGCTGAGATCTTTAGTACTTGGAGTCACCTTACAGATACAGAGCATTTATGAGGTATTCTTTGGTGCCTAAAGAACTTAAGGCATCCTCTGAAAACCTGGCCCAGGTTAGTGTTTATTATGAATCTCTTTTAACCTTTCTATACTTGTTTCTCCTACATCTCCTAAGTGCTCCAACTAGACATGACAGAAGAGATTTAACTAACGTAGTATGAGTTATATAAAATTCTATTTTTGTAAGTCAAAAATAATCAAATATCAAAAATTTAATAATGTTCAAACTATATACTCTGTGTGGGGTTACCGAGACAATGTGGACATTGTTCACATCTCATAGGGCTGAAAGTCAATGGGCAAGTCCTGGGAACTCATTGTCTTACTGGGGTCTTGTCCTAAATTTCATAGGTTCACCCATCATGCCCTCAACTTTCCTTAATTAGCCATGTCTGCTTACCTCTTCCTCCAGTTTCCCTCTTATTTTTCCCCAGCTATGTTGTTATCATTTCCAGAAATCTCTAAAGCTTGCACAGATCCTTAGCACTATGAGATCCATTGAAAGAGATAGTTTTTTTCTTTTTGAGATAGGGCCTGGCTCTGTCACCCAGGCTGTAGCTCAGTGGTGCGATCGAGGCTCACTGCAACCTCTGCCTCCCACGCTCAAGTGATCCTCCCTCCTCAGGCTCCAGAGTAGCTGGGAATACAGGCAGGCAACCACGCCCAGCTAATTTTTGTAATTTTGGTAGAAATGAGATTTTGCCATGTTGCCCAGGCTGGTCTTAAACTGCTGGACTCAAGCAATCCTCCTGCCTTGGCCTCCCAACATGCTAGGATTATAGATGTGAGCCACTGTGCCCAGGCAAAAAGAGATGACTCTCAATAAAAAAAAGTCCTTTTTCTTAAATCACTGTTTCTTTATCTGTGAATTCTTCTTCCAACTAGAAGGAGGAGAAAGAAGTTTGCCTGTATTTCTCACCAGGAGGAGAAGGGGTCTAGTGTGACATCAGAATGAAAGAGTGCTGGAGTTTGAGCCCCTTCTTGCTTTCCAAGATCCCCACAGTTATCACTTCCCATACCCTGGTTTATTCATGTAAACCACACTTATTTTTCTTAGCAGCTACTGTGTACTCGGCTCCATTCTAGGTTCAGATCATTCTATTTGATTAAGACAGAGAGGGTCCCGACTCTCATGGAAGTTACACAACAATAGAGGAGACAGACACTAACCCAATAAGCATTTAACAAAGAATAAAATATTAGAGAGTCATAGTGCACTGAAGAAAAGACATCAGGTTTGTGAAGAAGAGAGACATGGATTCACCTACTTTAGTTCATATGTTTAGGGAGCTCTACCTGAGAAAGTGACATTCAGCTGAGACAACAAAATAAGTAGACAGTCATGAAGATCTAATGGACGAAAGCTCCAGAGAGACCAAATGGGGGGAAAGCCCTGGTGTGGGAAATTATGTGGAGAGAGAGAAAGACGGCTAGAGGGGCTGATGTATAGAAAGTAAGGAAATGGAGAGGCAGAAGATGAGGTAGGACACAGAGAGAAAGTCAGGAGCCTCATCATTATAGGCTCTGATGTCCACGGTAAAAAATTTGAATTTTATTTTATTTATTTATTTATTTATTTATTTATTTATTTTATTTATTTATTTATTTTTTTAAGATGGAGTCTCGCTTTGTTGCCCAGGCTGGAGTGCAGTGGCGTGATCTCAGCTCACTGCAAGCTCCACCTCCTGGGTTCATGCCATTCTCCTGCCTCAGCCTCCCTAGTAGCTGGGACTACAGGCACCTGCCACCACGCCTGGCTAATTTTTAGTATTTTTAGTAGTGAGGGCATTTTGTCATGTTAACCAGGGTGGTCTCCATCTCCTGACCTCGTGATCCACCTGCCTCAGCCTCCCAAAGTGCTGAGACTACAGGTGTGAGCCACCACGCCTGGCCTATTTTTTTTTTTTTGAGACGGAGTTTCGTTCTTGTTGCCCAGGCTGGAGTGCAATGGTGCAATCTCGGCTCACTGCAACCTTCGCCTCCCTGGTTCAAGTGATTCTCCTGCCTCAGCTTCCCAAGTATCTGAGATTACAGGCACCCACCACCATACCTGGCTAATTTTTATTTTTTTGTATTTTTAGTAGACATGGGGTATCACCATGTTGACCATGCTGGTCTCGAACTCCTGACCTCAGATAATCTGTCTGCCTTGGCCTCCCAAAGTGCTGGGATTACAGGCATGAGCCACCGCGGCCGGACTGAATTTTATTTAAATAGATACGAGAAGCTACTGTATGGTTACAAGGAGAGTCAATTTATATTCAATTTATTTTTATTTTATTTTATTTTTTTGGTGATGGGGTCTTGCTCTGTTGCCCAGGCTAGATTGTAGTGGCACAATCTCGGCTCACTGCAACCTCTGCCTTCTGGGTTCAGGCGATTCTCCTGACTCAGCCTCCAGAGTAGCTGGGACCACAGGTACATGCCACCACACCTGGCTAAGTTTTTGTATTTTTTAGTAGAGACAGGATTTCACCATGTTAGCCAGGATGGTCTCGATCTCCTGATCTCGTGATCCACCCACCTTGGCCTCCCAAAGTGCAGGGATTACAGGCCTGAGCCACTGCGCCCGGCCTATATTCAATTTTTAAAACTAATTCTAGCTACTCTGTGGGGATTGGAATGTTGGGGTTCACAAGTGGTCAGGAAGACTATTTAGGAGCACAGCAGGGAATTCTCCAGCGAAAACAGGCTTGTGGCTTCATGGAGTGCATTAGTGATAAAGACGGTGAAAAAGATAAAGTGGACAGACTTGGCATGTATTTTTCCTTAGCTTGTTAATGAATTACTGTAAAGGGGGTAGAACAATCAAGCTTATTCCTAAGGATTTTGTTTTGACAAATAAGTGGGTGGTAGTGTTGTTTATTGAGATAGGAAAAACTATGGGAGGAAATTATTTGAAGTGGGTGGTTGGAAATAAAAGTTTTGTTTAAATTTGAGATGATTTATTGACATTTATGTGGAGCAATCAGAAGGTCAATGGCATTTAAGAGACTCATGGTGAGGCTAGGGCTTCAAGTATTTATGTTGGCGGCATCAATACGTGTAGTGTGTTAAATTCCAGGGAGTGGAAGAGGATACATAGGGAGATGGATTGTGTGGAGAAAAAAGAACAGGGCACAGGCCAGCAAAGGGGGCTGAGAAAGAGCCCAGGGATGTTGGAGAAAAATCAAGAGAACATGATGCATGTAAGTCAAGGAAAATAGATTTTTTTCAAGGAGAAGGGAGAGGCCAATTGTGGTGAGTACCACTAAGCGGAGGGGGAAGTGAGAACGTGACAGAGAAGCAAGTGCTGGGTTTGGTGGAGTTGATATTTGCAGTCAGTGGAGTATCCAGGGAGGAAACTGGATTGGACAATTTGAAGAGCGAGTAGAAGTGAGGATGAGGTTAAGGTTGACTGTTTTGAGTAGAGAGGTTCAGGGAAGGACTGCACTCTGGGTTCAGGGAGCCAGCTGGATCAAAAGGAAAAGGCTAAAGAGGCTGAAGAGAAGCAGGAGGACCTGTGAACCAGAGATGCTCAGTCATTATTAGCGAGGAAATACTAGAAAGCCCCTGTGTGCAGTGATGACTACTCATGCAGAAGGTCACACAGCCAATATTTAACACAGCCAGTATTTCACACAGCTAATATTTATTAGTGACATAGAATATACCAGTTATTACTCTAGGTCATGAGAATGGAGTGATAAATAAAATGAATCCGGTCGCCATCAGTATATGCCATGTAACATTTTGCAGTGACTGTGTACCAGGCCTGTGAATTTCAGTATGCAATTTCAATAATGATCCTGCTGTATCTGTGGTGTTTAAAAACATATACATCTCTGGAATCTAAAATTGAGAGGTTATAAGTAAAACCCAGTATTACAAATTGAGTGCTGGAAATCAGATTGCAGTTTAAATCTGAGCATATAGAAAGTCCCTTTCTTCTATGTCAGCAGATGCCTTTTGTGTGAGGTTTAGCTGGACTGCATTATTAGACATAAACCAGTGTTTCTGCCCTATGTTTTCAGAATGACAATTCTTTATGAAACTCATAGAAGAACAGAAGACAACTGCAAAATCATGATGAAGATAGTAATTGCTTTAGAATTAAGGAATACAAAAAATAATGTGAGCTGTAGTTATAGGGATCATAAAAGTTTAAATGGGAATGTATTTGAGTATGTGATCAGTGCTAAGAAGAGTCATCATTTAATTTTACACTTAACAGTAATCTCGTGAGGATTACGCTATTATTAAATGCATTTGATAGATTACAAAAAGGCTTATGGTTGGTAAAAATTGACCCAAGTAGAAGAGATCATGTTTTTATTCAGGTTTTCTGATTCTAGAGTTTGAGAGTTTGTCCATCATTAGTGAGTAGTGACTATATTGTGTCTGAATTATTGACAGAATTTCTGATATTCATATGTACCAGGTTGTTTCTTAGAGTGGGGATAGAGATGCAAGGGCTGCTAGTTCCGATGTATTGGGGAAACTTTCATTCATTTTGCATTTATCATTTTAAAGTTCTGTATGTCTATAATGGTCATGTGTTGAAGAACACAAGGAAGTATTAAATCACTCCTTCTTCTAAGGTTTGACTAGCAAGTTGGGCTAGAGTTACCAAATAAAATACATGTTCCTAGTGAAATCTGAATTTCAGATACAAAACCATAATTTATTGAAAATCCAAATTTAACTGGGCATCCTCTGGTTTTATTTGCCACATCTGTCAACCCTAAGTGCGACACATGGACATGGATTACAGTGCTAACCATGCAAGCCACGGTGACAGCAACTTCACACATGTTTATTTTTAACTTTCTCTGTAAGAAAGTGCTTAGATAATTTAGGGATAAAAAGATAGACATTGCTTGATCCAGGGTGCACACCTCTCTGCCACCATTTCTAAAGGCAAAGGGAGATTTCTGCAGGTCTTGCTCACAGTCTGGGGAGCTGCTCATTTTTGTAAAGTGTCTGTATGAGAATGTCATTTTCTTGGTTTCCTCCTTTCCGAGGGGACTTGACTACAAAACCAAGAGTTCTGCCTCTGGCCAAGGCTGGTAATTTGATGCCTGCTAGTATTGTTGGGAGTGGGAGACTGAAAGAAATGAGTTAGTTGGGGCATTTAACGGGAATAAAATAGCTGTGGTTGTGACTCATTACTACAGATAATTAGTGGACCAGTGGCAGAGAAATTAAGAAAAAAGATGATGTGAATGATAAATGATATGATTAGTGACTGCTTGGTAAGGCAAGGAAATCATTAAATCTTGGTTCTCATCAAGTTCATTTTCTGGAAAGATAGCACTGTATTGGGAGCAGAATTCTACAAAACCTTCTTTTTACATAGGACCAAGATTTTCAACAAATATTTTTCAATGCAATTCTCAGCTGCTCCATAACTAATAGTAGCTTGTTCAACACAGATTTTTTCAGATGATTCACACCTGTGGTACTTACCCAGGGATGGTTCACCACCCCTCCCTTCCCTCTCATCATCGTTGGGGAACGGTGACAATGTTTGGAACAATTTTTGGTTGTCACAAACAGGGGTTTCTTCTGATATTCAATGAGTAGAAGCCAGGGACACTGCTAGAGAACCCACAATGTTCAGAACAGCCTCTGCCATCAACAAGGAATTATCTGGTCCAAAATGTCAATAGTGCTGAGGCTAAGAGCACTGGTTCACACTGTGCTCTTTCTGAAAATTCTAGACTCACATCTGTTATACACTCACCACACAGTTTAGTCTTTTATTTTTGCTTGTTTCATTATAAACAATTAGACAGTTGTATAAATTCAACCACTTTCTTGTTGAATCCATTTAGTCAATGCAAGCTCAATATTTTCATATTTATTTTTTGCCTTATGCAATATTTTTCAACATTTTCATGAGTTGTCGGTCATCACTATCTCTATTAACTTTCAACAACTTGCCCTTGTAAGTCACAAATAGTGCTGCTGCTGAAATTATTTCTCACTAACATGCCTCAGATTTCTGTAGTGATTCTACATTTGATATTATTCACAATGTAAAATGCTTCTATTTATTCATTTCGCTTTTACCCAAGGATTATTTTTAAGTTATTTTTGTCATTTTCACACTTCAAACATAAAGACAAAAACATCAAAAATATAGTGTTTTACATATGTGCATATTTTCACACATATATGTATGTATATTTATATGTATTGAAACTACAGAAGCACATGTCACCAATAAGAGCTCTGAGACACCTTCGACCACTTACCCTTATCAGATGAGTTGTGGAAACAAGTTTTTTTTAACTGAATTTCTGAGCTTTGTGGATTTAGAAATGCAAAGGAAGGTTTGTGGACATTCACAGGGATCATGATTTTATTCTCCTTAAAACTCTTCTGTACTTTCCAATTGTCCTTAGTATAAATCCAAAATCCTAACACCACCCAAGAGGCTTTTCAATACCTGGCTCCTGTGATTTCTCCTGTCTAATCTTTTACCCTCCTTCCCCTCAGCCTCTCTGCTTTAGTGAACTTTCTCCTAGTTTTTTGAAGAAGTTCATCAATTCAAGCTTTTGTACATGGGATTTCCTAAACCTGAAATGTGCCTCCCGTTTTGTCCAAACAGACACGGGCTCCACTCTGCCCCCTGGCTCACACCTGCTTAACCTGTCAAGTCACATCTGAACCGTCACTATTAAGAGGGTCCTTCTCTGGCACCCTAATGTAATTGAGATCATCCTATTATTCTCTGTTCTAGAACTCCACACTTCCGACATTTCTCATTCCTGTCTAAGCTCTTGTGTGTTTGGTGTTGGGCCATCACTTTCACTGCTCTTTAAGCTCCCCCAGCGGAGTGGAGAGGTCTGTTTTCCCTCGTTTGGATTCCTAGAGGCAGCGCAGACCAGGCACAAGGTCAGCACTAAGGAAGGGTTCACAGGATGAACGCGGTGGGTGCTGTTTAAGGAACCGGTAAACGTGTGGGATGAGAGAAGGAGCAGAGTGTCTTTGGGGTGGAGGCTCCCAGGAGGAGGCGGCGCGGGCTGCGGTGCGGGGCGGATCCTCCTCCAGCTCCTGCTTGGAGGTCTCCAGAACAGGCTGGAGGTAGGGAGGGGGGTCCCAAAAGCCTGGGGATCAGACGTGGTTTTCCCGCCTGGTCCCCCAGGCCCCCTTTCGCCTCAGGAAGACAGAGGAGGAGCCCCTGGGCTGCAGGTGGTGGGCGTTGCGGCGGGGGCCGGTTAAGGTTCCCAGTGCCCGCACCCGGCCCAGGGAGCCCCGGATGGCGGCGTCACTGTCAGTGTCTTCTCAGGAGGCCGCCTGTGTGACTGGATCGTTCGTGTCCCCACAGCACGTTTCTTGGAGTACTCTACGTCTGAGTGTCATTTCTTCAATGGGACGGAGCGGGTGCGGTTCCTGGACAGATACTTCTATAACCAAGAGGAGTACGTGCGCTTCGACAGCGACGTGGGGGAGTTCCGGGCGGTGACGGAGCTGGGGCGGCCTGATGAGGAGTACTGGAACAGCCAGAAGGACATCCTGGAAGACGAGCGGGCCGCGGTGGACACCTACTGCAGACACAACTACGGGGTTGTGGAGAGCTTCACAGTGCAGCGGCGAGGTGAGCGCGGCGCGGGGCGGGGCCTGAGTCCCTGTGAGCTGGGAATCTGAGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGAGAGAGAGACAGAGAGACAGAGAGAGAGAGAGCGCCATCTGTGAGCATTTAGAATCCTCTCTATCCTGAGCAAGGAGTTCTGAGGGCACAGGTGTGTGTGTAGAGTGTGGATTTGTCTGTGTCTGTGAGGCTGTTGTGGGAGGGGAGGCAGGAGGGGGCTGCTTCTTATTCTTGGAGGACTCTGTGGGGAGGTGACAAGGGAGGTGGGTGCGGGCGGCTGGAGAGAGAGGTGACCTTGATTGTCTCGGGTCCTTAGAGATGCAGGGAAGGGAAATGTAAGGGGTGTGTGGTTGGGGTGAAGGTTTAGGGGAGGAGAGCTGAGGGGTAAGGAAGGTTTGGGATAATGTGAGGAGGCCAGTTCCAGACTGTCCCTGGCACACACCCTTCATGTAATCTCTGAAATAAAAGTGTGTGCTGTTTGTTTGTAAAAGCATTAGATTAATTTCTAGGGGAATTGAGGAGACCTCTGAGGCATCTCTGAAGCTTCTTTAGGTCTAAATTTCTTGCTAGTTTTTTGTTTTTTATTGTGTATATTTTTACATAGTAGAAATGACTGTGAAACTAACTTTTTGAATTAAAGTTTTAACACAGTTACTATTTTATTATAATGCTAATAGTTTTCTAGTAGTTACATATTATTCTTTTATATATAATAGTTGTGACACAACTTACCTCACTTTCCCCTTTGTTGACCTTTATTATGACATTCACCAAAATTTGAAAATGTATGTTTCTGGTTAATTTTTAATTTATATTTTTTTCATTTATAATTCTTTTGAATTATTTTGACCTATTTATTGGCCAGTTTTAATAACTGCTGTAAGAATTCCCTATTGTATTTGGTAGGGAATGGACAATGATCTACTGCCTAATATCTCGAGGGCTTAGTATTTTTCTCAGTGACTTTGTGGGTTCTTTGTACTGTGAGATTATTAACACTTTATTGATATTTGATTCAGCATTTGCTCCAGTTTGTGGTTTGTATGTTGATTTTGAAAATTCTTTTCCATGTTAAGAATTTGAACATTTTTATATAATAAAATATGTTGCAAAATTTTTATTAATGATTTACAATCCATCTTAAATCTGCCATTTTGTGGTATTGTTGTCTCCAGGTTTCTCCTTACTTCTAAAAAAAATTGCATTTATTGAGAGTCTGCTAGTGTTAGGGATTTTCCTGGGCATAAGCACCCCAAGTGACGAGTCCCAGACACTGCCTTAATCCAAATGTGATTCTGGAAAGAAAAATCATTTTACAATGATAGGCCTAATAATAATTAAGCTTGTGTTGCATGGGAGATGCATTGATCAGCTAAATGTAAATATAAGAACTTTCAAAACTAAAATGACGTTCCTTAATCCTTCTCTCTGCTTTATGACTCATGCTTTTCTGGGAAAGTAAAAATTTGGAGAATCATTTCTGTCTGTCCCACCTTCCCAGGGGCAGAACCATTTCTGTGGTGTTCTAAGGTGTGAGTGCATGGCGGTAGTATTCCTAAAAATTCATATTCGGTTTCGTCATGTACCCAACTCTGTCCCGTTATCTATCAACATTGTTTTAAATCATATATTTCTGTCAAGGTGTACAAGGATGATAAATAGGTGCCAAGTGGAGCACCCAAGTGTGATGAGCCCCCTCACAGTGGAATGGAGTGTGAAGCTTTATGACCTCATAAATTGAAGGTTATCTTCAGTCATTGTTTTATATATTTTACATGCATTAATCCTCATATAATCCCAAGAGGTAAATTAGTATAATTATCCTTCATTATAGGTGACAAAGTTGAGACACAGAAGAATCGAACTCTTAAGGCAGACCTTGGATTTGAACCAGGCAACCTGGCTCAGATATCAGTTTTAATTACTACACTCTGTACTTTCAAAGATTTGTAAACACTTTGACAATGCATGACAATTTCAAGCTATGAAGAAACAAACACAATTTTTCACAATATCTCTCAAATCTAATAGGTCCTCACTATCAAGATTAAGTTCCAGGCTGATGACACTGTAAGGCCACATGGCCAGCTGTGCTGGAGGCCTGGTCAAGGTCAGAGCCTGGGTTTGCAGAGAAGCAGACAAACAGCCAAACAAGGAGACTTACTCTGTCTTCATGACTCATTCCCTCTACCTTTTTTCTCCTAGTCCATCCTAAGGTGACTGTGTATCCTTCAAAGACCCAGCCCCTGCAGCACCACAACCTCCTGGTCTGTTCTGTGAGTGGTTTCTATCCAGGCAGCATTGAAGTCAGGTGGTTCCGGAATGGCCAGGAAGAGAAGACTGGGGTGGTGTCCACAGGCCTGATCCACAATGGAGACTGGACCTTCCAGACCCTGGTGATGCTGGAAACAGTTCCTCGGAGTGGAGAGGTTTACACCTGCCAAGTGGAGCACCCAAGCGTGACAAGCCCTCTCACAGTGGAATGGAGTGAGCAGCTTTCTGACTTCATAAATTTCTCACCCACCAAGAAGGGGACTGTGCTCATCCCTGAGTGTCAGGTTTCTCCTCTCCGACATCCTATTTTCATTTGCTCCATGTTCTCATCTCCATCAGCACAGGTCACTGGGGGTAGCCCTGTAGGTGTTTCTAGAAACACCTGTACCTCCTGGAGAAGCAGTCTCGCCTGCCAGGCAGGAGAGGCTGTCCCTCTTTTGAACCTCCCCATGATGTCACAGGTCAGGGTCACCCACCCTCCCCGGGCTCCAGGCACTGCCTCTGGGTCTGAGACTGAGTTTCTGGTGCTGTTGATCTGAGTTATTTGTTGTGATCTGGGAAGAGGAGAAGTGTAGGGGCCTTCCTGACATGAGGGGAGTCCAATCTCAGCTCTGCCTTTTATTAGCTCTGTCACTCTAGACAAACTACTTAGCCTCATTGAGTCTCAGGCTTTCTGTGGATCAGATGTTGAACTCTTGCCTTACATCAAGGCTGTAATATTTGAATGAGTTTGATGTCTGAACCTTGTAACTGTTCAGTGTGATTTGAAATCCTTTTTTTCTCCAGAAATGGCTAGTTATTTTAGTTCTTGTGGGGCAGACTTCTTCCCCATTTTCAAAGCTCTGAATCTTAGAGTCTCAATTAAAGAGGTTCAATTTGGAATAAACACTAAACCTGGCTTCCTCTCTCAGGAGCACGGTCTGAATCTGCACAGAGCAAGATGCTGAGTGGAGTCGGGGGCTTTGTGCTGGGCCTGCTCTTCCTTGGGGCCGGGCTGTTCATCTACTTCAGGAATCAGAAAGGTGAGGAGCCTTTGGTAGCTGGCTCTCTCCATAGGCTTTTCTGGAGGAGGAACTATGGCTTTGCTGAGGTTAGTTCTCAGTATATGAGTGGCCCTGAATAAAGCCTTTCTTTCCCCAAACGGCTCTAATGTCCTGCTAATCCAGAAATCATCAGTGCATGGTTACTATGTGAAAGCATAATAGCTTGTGGCCTGCAGAGACAAGAGGAAGGTTAACAAGTAGGGGTCCTTTGGTTTGAGATCTTGGAGCAGATTAAGGAAGAGCCACTAAGACTAATGGAATTACACTGGATCCTGTGACAGACACTTCACCCTTCATGGGTCACATGGTCTGTTTCTGCTCCTCTCTGCCCTGGCTGGTGTGGGTTGTAGTGACAGAGAACTCTCCGGTGGGAGATCTGGGGCTGGGACATTGTGTTGGAAGACAGATTTGCTTCCATAAATTTTAAGTGTATATATTTTCCTCTTTTTCCCAGGACACTCTGGACTTCAGCCAAGAGGTAATACCTTTTAATCCTCTTTTAGAAACAGATACGGTTTCCCTAGTGAGAGGTGAAGCCAGCTGGACTTCTGGGTCGGGTAGGGACTTGCAGAACTTTCCTGTCTTAGGAGAGGTTTCTAAATGCACCAATCAGTGCTCTGTAAAAACACACCAATTGGCACTCTGTGGCTAGATAGATGTTTGTAAAATGGACTAATCAGCACTCTGTAAAATGGAGCAATCCACACTCTGTAAAATGGACCAATCAATGCTCTTTAAAATGGACCAATCAGCAGGACATGGGCGGGGACAAATAAGGGAATACAAGCTGGCCACCCCAGCCAGCAGCAGCAACCCGCTCAGGTCGCCTTCCATGCTGTGGAAGCTTTGTTCTTTTGCTCTTCACAATAAATCTTGCTGTTGCTCACTCTTCGGGTCTGTGCCACCTTTAAGAGCTGTAACACTCACTGTGAAGATTCGCGGCTTCATTCTTGAAGTCAGCGAAACCACGAACCCACCGGAAGGAACAAACTCTGGACACACTAGAATTGATGGTAGAGGTGATAAGGCATGAGACAGAAATAATAGGAAAGACTTTGGATCCAAATTTCTGATCAGGCAATTTACACCAAAACTCCTCCTCTCCACTTAGAAAAGGCCTGTGCTCTGTGGGACTATTGGCTCTGGGAGACTCAGGAACTTGTTTTTCTTCTTCCTGCAGTGCTCTCATCTGAGTCCCTGAAAGAGAGGAAAAGAAACTGTTAGTAGAGTCAGGTTGAAAACAACACTCTCCTCTGTCTTTTGCAGGATTCCTGAGCTGAAGTGCAGATGACACATTCAAAGAAGAACTTTCTGCCCCAGCTTTGCAGGATGAAAAGCTTTCCCTCCTGGCTGT'
    hlaLocus = mySubmissionBatch[0].submittedGene.geneLocus
    print('I stored the gene name successfully:' + str(hlaLocus))
    # roughFeatureSequence = 'aag\nCGTCGT\nccg\nGGCTGA\naat'
    alleleCallWithGFE = fetchSequenceAlleleCallWithGFE(roughFeatureSequence, hlaLocus)
    assert_true(len(alleleCallWithGFE) > 3)

    # print 'ALLELE CALL RESULTS:'
    # print alleleCallWithGFE

    annotatedSequence = parseExons(roughFeatureSequence, alleleCallWithGFE)
    #print ('ANNOTATED SEQUENCE:')
    #print (annotatedSequence)
    assert_true(len(annotatedSequence) > 3)

    imgtGenerator = ImgtSubGenerator()

    imgtGenerator.sequenceAnnotation = identifyGenomicFeatures(annotatedSequence)


    imgtSubmission = imgtGenerator.buildIMGTSubmission()

    print('IMGT SUBMISSION:\n' + imgtSubmission)

    assert_true(len(imgtSubmission) > 3)
    assert_true(imgtSubmission is not None)

    # Maybe I don't want to safe my configuration with all these test values but maybe I don't care :D
    writeConfigurationFile()

    #Print out the submission to a file, for easier validation.
    outputFileObject = open('Test_IMGT_Submission_HLA_DRB1.txt', 'w')
    submissionText = imgtSubmission
    outputFileObject.write(submissionText)
  
"""  

def testCreateIMGTSubmissionFlatfileDRB1():
    print ('Test: Creating IMGT Flatfile')

    mySubmissionBatch = getConfigurationValue('submission_batch').submissionBatch

    roughFeatureSequence = mySubmissionBatch[0].submittedGene.fullSequence
    # roughFeatureSequence = 'GAAAGACCTGAAAGATCACGGTGCCTTCATTTCAACTGTGAGACATGATGTAATTTTCACAAATCTACAACAGTAAGATATAGTGCAACAGGACCAGATTAAGGTCTCCTGGTTTGCAACCATGTCCCCTCCATCTCCTTTACTCCTGAACACACTCACTCCTGCAAACAGTTCTCTTGTCAAGTGGGAAATGAATGCTCTTACAAGGCTCAAACTTGTGAACACATCACTGACCAGCACAGAGCTAAAATAATTGGGGCTAAAAATACCGCCCCAATTAAAGTGTTTTACATGCAACTGGTTCAAACCTTTCAAGTACTAAAAACAATCCTGTAAAGAAGGAAATTCTGTTTCAGAAGAGGACCTTCATACAGCATCTCTGACCAGCAACTGATGATGCTATTGAACTCAGATGCTGATTCGTTCTCCAACACTAGATTACCCAATCCAGGAGCAAGGAAATCAGTAACTTACTCCCTATAACTTGGAATGTGGGTGGAGGGGTTCATAGTTCTCCCTGAGTGAGACTTGCCTGCTGCTCTGGCCCCTGGTCCTGTCCTGTTCTCCAGCATGGTGTGTCTGAGGCTCCCTGGAGGCTCCTGCATGGCAGTTCTGACAGTGACACTGATGGTGCTGAGCTCCCCACTGGCTTTGGCTGGGGACACCAGACGTAAGTGCACATTGTGGGTGCTGAGCTACTATGGGGTGGGGAAAATAGGGAGTTTTGTTAACATTGTGCCCAGGCCATGTACCTTAAGAAATTGTGACGTATTTTTCAGAGATTGCCCATCTTTATCATATGGATCCCAAATAATTTCCCCACCACAAAAGGAGCTTGGCTACTTGCCCACTCCATGAGACTTGTGTAAGGGGCCTCCATACAGGTCATTTCTACTCAAATCTCCACCAATAAAACCTTTGCATCACATGTCCTCAGGGTCTTTAGAGGATTTAGAAATAAGGATGCTAAAATAAATTCCCCATACAGCACTTGCCTTTATTATGTTGACTTATGTCAGACAAAGGAGGTTTTTTCTGAAAATTTTGTGGAAGTCAAGGGAATTTAAAGGGTCTCTCCTAAACGATCCTGGGTTATGTCACCCACAGGACCTTTGGTGTTGGCCCCTCTTCCTCATATGTGAGGATGGACCCAGTGGCCTCCCCATTATCTACTTTCTTTTCTTTCTGAACTCCAATGTTTATAAAGCCTGTACCCCTGTAGTGTATGTAGGTTGTCTGACAGAAGTTATACTTAGTGCTCTTTCTTTCTTGTGGGGAAAAATCCCTGGAACTGAAGCTGAGATCTTTAGTACTTGGAGTCACCTTACAGATACAGAGCATTTATGAGGTATTCTTTGGTGCCTAAAGAACTTAAGGCATCCTCTGAAAACCTGGCCCAGGTTAGTGTTTATTATGAATCTCTTTTAACCTTTCTATACTTGTTTCTCCTACATCTCCTAAGTGCTCCAACTAGACATGACAGAAGAGATTTAACTAACGTAGTATGAGTTATATAAAATTCTATTTTTGTAAGTCAAAAATAATCAAATATCAAAAATTTAATAATGTTCAAACTATATACTCTGTGTGGGGTTACCGAGACAATGTGGACATTGTTCACATCTCATAGGGCTGAAAGTCAATGGGCAAGTCCTGGGAACTCATTGTCTTACTGGGGTCTTGTCCTAAATTTCATAGGTTCACCCATCATGCCCTCAACTTTCCTTAATTAGCCATGTCTGCTTACCTCTTCCTCCAGTTTCCCTCTTATTTTTCCCCAGCTATGTTGTTATCATTTCCAGAAATCTCTAAAGCTTGCACAGATCCTTAGCACTATGAGATCCATTGAAAGAGATAGTTTTTTTCTTTTTGAGATAGGGCCTGGCTCTGTCACCCAGGCTGTAGCTCAGTGGTGCGATCGAGGCTCACTGCAACCTCTGCCTCCCACGCTCAAGTGATCCTCCCTCCTCAGGCTCCAGAGTAGCTGGGAATACAGGCAGGCAACCACGCCCAGCTAATTTTTGTAATTTTGGTAGAAATGAGATTTTGCCATGTTGCCCAGGCTGGTCTTAAACTGCTGGACTCAAGCAATCCTCCTGCCTTGGCCTCCCAACATGCTAGGATTATAGATGTGAGCCACTGTGCCCAGGCAAAAAGAGATGACTCTCAATAAAAAAAAGTCCTTTTTCTTAAATCACTGTTTCTTTATCTGTGAATTCTTCTTCCAACTAGAAGGAGGAGAAAGAAGTTTGCCTGTATTTCTCACCAGGAGGAGAAGGGGTCTAGTGTGACATCAGAATGAAAGAGTGCTGGAGTTTGAGCCCCTTCTTGCTTTCCAAGATCCCCACAGTTATCACTTCCCATACCCTGGTTTATTCATGTAAACCACACTTATTTTTCTTAGCAGCTACTGTGTACTCGGCTCCATTCTAGGTTCAGATCATTCTATTTGATTAAGACAGAGAGGGTCCCGACTCTCATGGAAGTTACACAACAATAGAGGAGACAGACACTAACCCAATAAGCATTTAACAAAGAATAAAATATTAGAGAGTCATAGTGCACTGAAGAAAAGACATCAGGTTTGTGAAGAAGAGAGACATGGATTCACCTACTTTAGTTCATATGTTTAGGGAGCTCTACCTGAGAAAGTGACATTCAGCTGAGACAACAAAATAAGTAGACAGTCATGAAGATCTAATGGACGAAAGCTCCAGAGAGACCAAATGGGGGGAAAGCCCTGGTGTGGGAAATTATGTGGAGAGAGAGAAAGACGGCTAGAGGGGCTGATGTATAGAAAGTAAGGAAATGGAGAGGCAGAAGATGAGGTAGGACACAGAGAGAAAGTCAGGAGCCTCATCATTATAGGCTCTGATGTCCACGGTAAAAAATTTGAATTTTATTTTATTTATTTATTTATTTATTTATTTATTTATTTTATTTATTTATTTATTTTTTTAAGATGGAGTCTCGCTTTGTTGCCCAGGCTGGAGTGCAGTGGCGTGATCTCAGCTCACTGCAAGCTCCACCTCCTGGGTTCATGCCATTCTCCTGCCTCAGCCTCCCTAGTAGCTGGGACTACAGGCACCTGCCACCACGCCTGGCTAATTTTTAGTATTTTTAGTAGTGAGGGCATTTTGTCATGTTAACCAGGGTGGTCTCCATCTCCTGACCTCGTGATCCACCTGCCTCAGCCTCCCAAAGTGCTGAGACTACAGGTGTGAGCCACCACGCCTGGCCTATTTTTTTTTTTTTGAGACGGAGTTTCGTTCTTGTTGCCCAGGCTGGAGTGCAATGGTGCAATCTCGGCTCACTGCAACCTTCGCCTCCCTGGTTCAAGTGATTCTCCTGCCTCAGCTTCCCAAGTATCTGAGATTACAGGCACCCACCACCATACCTGGCTAATTTTTATTTTTTTGTATTTTTAGTAGACATGGGGTATCACCATGTTGACCATGCTGGTCTCGAACTCCTGACCTCAGATAATCTGTCTGCCTTGGCCTCCCAAAGTGCTGGGATTACAGGCATGAGCCACCGCGGCCGGACTGAATTTTATTTAAATAGATACGAGAAGCTACTGTATGGTTACAAGGAGAGTCAATTTATATTCAATTTATTTTTATTTTATTTTATTTTTTTGGTGATGGGGTCTTGCTCTGTTGCCCAGGCTAGATTGTAGTGGCACAATCTCGGCTCACTGCAACCTCTGCCTTCTGGGTTCAGGCGATTCTCCTGACTCAGCCTCCAGAGTAGCTGGGACCACAGGTACATGCCACCACACCTGGCTAAGTTTTTGTATTTTTTAGTAGAGACAGGATTTCACCATGTTAGCCAGGATGGTCTCGATCTCCTGATCTCGTGATCCACCCACCTTGGCCTCCCAAAGTGCAGGGATTACAGGCCTGAGCCACTGCGCCCGGCCTATATTCAATTTTTAAAACTAATTCTAGCTACTCTGTGGGGATTGGAATGTTGGGGTTCACAAGTGGTCAGGAAGACTATTTAGGAGCACAGCAGGGAATTCTCCAGCGAAAACAGGCTTGTGGCTTCATGGAGTGCATTAGTGATAAAGACGGTGAAAAAGATAAAGTGGACAGACTTGGCATGTATTTTTCCTTAGCTTGTTAATGAATTACTGTAAAGGGGGTAGAACAATCAAGCTTATTCCTAAGGATTTTGTTTTGACAAATAAGTGGGTGGTAGTGTTGTTTATTGAGATAGGAAAAACTATGGGAGGAAATTATTTGAAGTGGGTGGTTGGAAATAAAAGTTTTGTTTAAATTTGAGATGATTTATTGACATTTATGTGGAGCAATCAGAAGGTCAATGGCATTTAAGAGACTCATGGTGAGGCTAGGGCTTCAAGTATTTATGTTGGCGGCATCAATACGTGTAGTGTGTTAAATTCCAGGGAGTGGAAGAGGATACATAGGGAGATGGATTGTGTGGAGAAAAAAGAACAGGGCACAGGCCAGCAAAGGGGGCTGAGAAAGAGCCCAGGGATGTTGGAGAAAAATCAAGAGAACATGATGCATGTAAGTCAAGGAAAATAGATTTTTTTCAAGGAGAAGGGAGAGGCCAATTGTGGTGAGTACCACTAAGCGGAGGGGGAAGTGAGAACGTGACAGAGAAGCAAGTGCTGGGTTTGGTGGAGTTGATATTTGCAGTCAGTGGAGTATCCAGGGAGGAAACTGGATTGGACAATTTGAAGAGCGAGTAGAAGTGAGGATGAGGTTAAGGTTGACTGTTTTGAGTAGAGAGGTTCAGGGAAGGACTGCACTCTGGGTTCAGGGAGCCAGCTGGATCAAAAGGAAAAGGCTAAAGAGGCTGAAGAGAAGCAGGAGGACCTGTGAACCAGAGATGCTCAGTCATTATTAGCGAGGAAATACTAGAAAGCCCCTGTGTGCAGTGATGACTACTCATGCAGAAGGTCACACAGCCAATATTTAACACAGCCAGTATTTCACACAGCTAATATTTATTAGTGACATAGAATATACCAGTTATTACTCTAGGTCATGAGAATGGAGTGATAAATAAAATGAATCCGGTCGCCATCAGTATATGCCATGTAACATTTTGCAGTGACTGTGTACCAGGCCTGTGAATTTCAGTATGCAATTTCAATAATGATCCTGCTGTATCTGTGGTGTTTAAAAACATATACATCTCTGGAATCTAAAATTGAGAGGTTATAAGTAAAACCCAGTATTACAAATTGAGTGCTGGAAATCAGATTGCAGTTTAAATCTGAGCATATAGAAAGTCCCTTTCTTCTATGTCAGCAGATGCCTTTTGTGTGAGGTTTAGCTGGACTGCATTATTAGACATAAACCAGTGTTTCTGCCCTATGTTTTCAGAATGACAATTCTTTATGAAACTCATAGAAGAACAGAAGACAACTGCAAAATCATGATGAAGATAGTAATTGCTTTAGAATTAAGGAATACAAAAAATAATGTGAGCTGTAGTTATAGGGATCATAAAAGTTTAAATGGGAATGTATTTGAGTATGTGATCAGTGCTAAGAAGAGTCATCATTTAATTTTACACTTAACAGTAATCTCGTGAGGATTACGCTATTATTAAATGCATTTGATAGATTACAAAAAGGCTTATGGTTGGTAAAAATTGACCCAAGTAGAAGAGATCATGTTTTTATTCAGGTTTTCTGATTCTAGAGTTTGAGAGTTTGTCCATCATTAGTGAGTAGTGACTATATTGTGTCTGAATTATTGACAGAATTTCTGATATTCATATGTACCAGGTTGTTTCTTAGAGTGGGGATAGAGATGCAAGGGCTGCTAGTTCCGATGTATTGGGGAAACTTTCATTCATTTTGCATTTATCATTTTAAAGTTCTGTATGTCTATAATGGTCATGTGTTGAAGAACACAAGGAAGTATTAAATCACTCCTTCTTCTAAGGTTTGACTAGCAAGTTGGGCTAGAGTTACCAAATAAAATACATGTTCCTAGTGAAATCTGAATTTCAGATACAAAACCATAATTTATTGAAAATCCAAATTTAACTGGGCATCCTCTGGTTTTATTTGCCACATCTGTCAACCCTAAGTGCGACACATGGACATGGATTACAGTGCTAACCATGCAAGCCACGGTGACAGCAACTTCACACATGTTTATTTTTAACTTTCTCTGTAAGAAAGTGCTTAGATAATTTAGGGATAAAAAGATAGACATTGCTTGATCCAGGGTGCACACCTCTCTGCCACCATTTCTAAAGGCAAAGGGAGATTTCTGCAGGTCTTGCTCACAGTCTGGGGAGCTGCTCATTTTTGTAAAGTGTCTGTATGAGAATGTCATTTTCTTGGTTTCCTCCTTTCCGAGGGGACTTGACTACAAAACCAAGAGTTCTGCCTCTGGCCAAGGCTGGTAATTTGATGCCTGCTAGTATTGTTGGGAGTGGGAGACTGAAAGAAATGAGTTAGTTGGGGCATTTAACGGGAATAAAATAGCTGTGGTTGTGACTCATTACTACAGATAATTAGTGGACCAGTGGCAGAGAAATTAAGAAAAAAGATGATGTGAATGATAAATGATATGATTAGTGACTGCTTGGTAAGGCAAGGAAATCATTAAATCTTGGTTCTCATCAAGTTCATTTTCTGGAAAGATAGCACTGTATTGGGAGCAGAATTCTACAAAACCTTCTTTTTACATAGGACCAAGATTTTCAACAAATATTTTTCAATGCAATTCTCAGCTGCTCCATAACTAATAGTAGCTTGTTCAACACAGATTTTTTCAGATGATTCACACCTGTGGTACTTACCCAGGGATGGTTCACCACCCCTCCCTTCCCTCTCATCATCGTTGGGGAACGGTGACAATGTTTGGAACAATTTTTGGTTGTCACAAACAGGGGTTTCTTCTGATATTCAATGAGTAGAAGCCAGGGACACTGCTAGAGAACCCACAATGTTCAGAACAGCCTCTGCCATCAACAAGGAATTATCTGGTCCAAAATGTCAATAGTGCTGAGGCTAAGAGCACTGGTTCACACTGTGCTCTTTCTGAAAATTCTAGACTCACATCTGTTATACACTCACCACACAGTTTAGTCTTTTATTTTTGCTTGTTTCATTATAAACAATTAGACAGTTGTATAAATTCAACCACTTTCTTGTTGAATCCATTTAGTCAATGCAAGCTCAATATTTTCATATTTATTTTTTGCCTTATGCAATATTTTTCAACATTTTCATGAGTTGTCGGTCATCACTATCTCTATTAACTTTCAACAACTTGCCCTTGTAAGTCACAAATAGTGCTGCTGCTGAAATTATTTCTCACTAACATGCCTCAGATTTCTGTAGTGATTCTACATTTGATATTATTCACAATGTAAAATGCTTCTATTTATTCATTTCGCTTTTACCCAAGGATTATTTTTAAGTTATTTTTGTCATTTTCACACTTCAAACATAAAGACAAAAACATCAAAAATATAGTGTTTTACATATGTGCATATTTTCACACATATATGTATGTATATTTATATGTATTGAAACTACAGAAGCACATGTCACCAATAAGAGCTCTGAGACACCTTCGACCACTTACCCTTATCAGATGAGTTGTGGAAACAAGTTTTTTTTAACTGAATTTCTGAGCTTTGTGGATTTAGAAATGCAAAGGAAGGTTTGTGGACATTCACAGGGATCATGATTTTATTCTCCTTAAAACTCTTCTGTACTTTCCAATTGTCCTTAGTATAAATCCAAAATCCTAACACCACCCAAGAGGCTTTTCAATACCTGGCTCCTGTGATTTCTCCTGTCTAATCTTTTACCCTCCTTCCCCTCAGCCTCTCTGCTTTAGTGAACTTTCTCCTAGTTTTTTGAAGAAGTTCATCAATTCAAGCTTTTGTACATGGGATTTCCTAAACCTGAAATGTGCCTCCCGTTTTGTCCAAACAGACACGGGCTCCACTCTGCCCCCTGGCTCACACCTGCTTAACCTGTCAAGTCACATCTGAACCGTCACTATTAAGAGGGTCCTTCTCTGGCACCCTAATGTAATTGAGATCATCCTATTATTCTCTGTTCTAGAACTCCACACTTCCGACATTTCTCATTCCTGTCTAAGCTCTTGTGTGTTTGGTGTTGGGCCATCACTTTCACTGCTCTTTAAGCTCCCCCAGCGGAGTGGAGAGGTCTGTTTTCCCTCGTTTGGATTCCTAGAGGCAGCGCAGACCAGGCACAAGGTCAGCACTAAGGAAGGGTTCACAGGATGAACGCGGTGGGTGCTGTTTAAGGAACCGGTAAACGTGTGGGATGAGAGAAGGAGCAGAGTGTCTTTGGGGTGGAGGCTCCCAGGAGGAGGCGGCGCGGGCTGCGGTGCGGGGCGGATCCTCCTCCAGCTCCTGCTTGGAGGTCTCCAGAACAGGCTGGAGGTAGGGAGGGGGGTCCCAAAAGCCTGGGGATCAGACGTGGTTTTCCCGCCTGGTCCCCCAGGCCCCCTTTCGCCTCAGGAAGACAGAGGAGGAGCCCCTGGGCTGCAGGTGGTGGGCGTTGCGGCGGGGGCCGGTTAAGGTTCCCAGTGCCCGCACCCGGCCCAGGGAGCCCCGGATGGCGGCGTCACTGTCAGTGTCTTCTCAGGAGGCCGCCTGTGTGACTGGATCGTTCGTGTCCCCACAGCACGTTTCTTGGAGTACTCTACGTCTGAGTGTCATTTCTTCAATGGGACGGAGCGGGTGCGGTTCCTGGACAGATACTTCTATAACCAAGAGGAGTACGTGCGCTTCGACAGCGACGTGGGGGAGTTCCGGGCGGTGACGGAGCTGGGGCGGCCTGATGAGGAGTACTGGAACAGCCAGAAGGACATCCTGGAAGACGAGCGGGCCGCGGTGGACACCTACTGCAGACACAACTACGGGGTTGTGGAGAGCTTCACAGTGCAGCGGCGAGGTGAGCGCGGCGCGGGGCGGGGCCTGAGTCCCTGTGAGCTGGGAATCTGAGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGAGAGAGAGACAGAGAGACAGAGAGAGAGAGAGCGCCATCTGTGAGCATTTAGAATCCTCTCTATCCTGAGCAAGGAGTTCTGAGGGCACAGGTGTGTGTGTAGAGTGTGGATTTGTCTGTGTCTGTGAGGCTGTTGTGGGAGGGGAGGCAGGAGGGGGCTGCTTCTTATTCTTGGAGGACTCTGTGGGGAGGTGACAAGGGAGGTGGGTGCGGGCGGCTGGAGAGAGAGGTGACCTTGATTGTCTCGGGTCCTTAGAGATGCAGGGAAGGGAAATGTAAGGGGTGTGTGGTTGGGGTGAAGGTTTAGGGGAGGAGAGCTGAGGGGTAAGGAAGGTTTGGGATAATGTGAGGAGGCCAGTTCCAGACTGTCCCTGGCACACACCCTTCATGTAATCTCTGAAATAAAAGTGTGTGCTGTTTGTTTGTAAAAGCATTAGATTAATTTCTAGGGGAATTGAGGAGACCTCTGAGGCATCTCTGAAGCTTCTTTAGGTCTAAATTTCTTGCTAGTTTTTTGTTTTTTATTGTGTATATTTTTACATAGTAGAAATGACTGTGAAACTAACTTTTTGAATTAAAGTTTTAACACAGTTACTATTTTATTATAATGCTAATAGTTTTCTAGTAGTTACATATTATTCTTTTATATATAATAGTTGTGACACAACTTACCTCACTTTCCCCTTTGTTGACCTTTATTATGACATTCACCAAAATTTGAAAATGTATGTTTCTGGTTAATTTTTAATTTATATTTTTTTCATTTATAATTCTTTTGAATTATTTTGACCTATTTATTGGCCAGTTTTAATAACTGCTGTAAGAATTCCCTATTGTATTTGGTAGGGAATGGACAATGATCTACTGCCTAATATCTCGAGGGCTTAGTATTTTTCTCAGTGACTTTGTGGGTTCTTTGTACTGTGAGATTATTAACACTTTATTGATATTTGATTCAGCATTTGCTCCAGTTTGTGGTTTGTATGTTGATTTTGAAAATTCTTTTCCATGTTAAGAATTTGAACATTTTTATATAATAAAATATGTTGCAAAATTTTTATTAATGATTTACAATCCATCTTAAATCTGCCATTTTGTGGTATTGTTGTCTCCAGGTTTCTCCTTACTTCTAAAAAAAATTGCATTTATTGAGAGTCTGCTAGTGTTAGGGATTTTCCTGGGCATAAGCACCCCAAGTGACGAGTCCCAGACACTGCCTTAATCCAAATGTGATTCTGGAAAGAAAAATCATTTTACAATGATAGGCCTAATAATAATTAAGCTTGTGTTGCATGGGAGATGCATTGATCAGCTAAATGTAAATATAAGAACTTTCAAAACTAAAATGACGTTCCTTAATCCTTCTCTCTGCTTTATGACTCATGCTTTTCTGGGAAAGTAAAAATTTGGAGAATCATTTCTGTCTGTCCCACCTTCCCAGGGGCAGAACCATTTCTGTGGTGTTCTAAGGTGTGAGTGCATGGCGGTAGTATTCCTAAAAATTCATATTCGGTTTCGTCATGTACCCAACTCTGTCCCGTTATCTATCAACATTGTTTTAAATCATATATTTCTGTCAAGGTGTACAAGGATGATAAATAGGTGCCAAGTGGAGCACCCAAGTGTGATGAGCCCCCTCACAGTGGAATGGAGTGTGAAGCTTTATGACCTCATAAATTGAAGGTTATCTTCAGTCATTGTTTTATATATTTTACATGCATTAATCCTCATATAATCCCAAGAGGTAAATTAGTATAATTATCCTTCATTATAGGTGACAAAGTTGAGACACAGAAGAATCGAACTCTTAAGGCAGACCTTGGATTTGAACCAGGCAACCTGGCTCAGATATCAGTTTTAATTACTACACTCTGTACTTTCAAAGATTTGTAAACACTTTGACAATGCATGACAATTTCAAGCTATGAAGAAACAAACACAATTTTTCACAATATCTCTCAAATCTAATAGGTCCTCACTATCAAGATTAAGTTCCAGGCTGATGACACTGTAAGGCCACATGGCCAGCTGTGCTGGAGGCCTGGTCAAGGTCAGAGCCTGGGTTTGCAGAGAAGCAGACAAACAGCCAAACAAGGAGACTTACTCTGTCTTCATGACTCATTCCCTCTACCTTTTTTCTCCTAGTCCATCCTAAGGTGACTGTGTATCCTTCAAAGACCCAGCCCCTGCAGCACCACAACCTCCTGGTCTGTTCTGTGAGTGGTTTCTATCCAGGCAGCATTGAAGTCAGGTGGTTCCGGAATGGCCAGGAAGAGAAGACTGGGGTGGTGTCCACAGGCCTGATCCACAATGGAGACTGGACCTTCCAGACCCTGGTGATGCTGGAAACAGTTCCTCGGAGTGGAGAGGTTTACACCTGCCAAGTGGAGCACCCAAGCGTGACAAGCCCTCTCACAGTGGAATGGAGTGAGCAGCTTTCTGACTTCATAAATTTCTCACCCACCAAGAAGGGGACTGTGCTCATCCCTGAGTGTCAGGTTTCTCCTCTCCGACATCCTATTTTCATTTGCTCCATGTTCTCATCTCCATCAGCACAGGTCACTGGGGGTAGCCCTGTAGGTGTTTCTAGAAACACCTGTACCTCCTGGAGAAGCAGTCTCGCCTGCCAGGCAGGAGAGGCTGTCCCTCTTTTGAACCTCCCCATGATGTCACAGGTCAGGGTCACCCACCCTCCCCGGGCTCCAGGCACTGCCTCTGGGTCTGAGACTGAGTTTCTGGTGCTGTTGATCTGAGTTATTTGTTGTGATCTGGGAAGAGGAGAAGTGTAGGGGCCTTCCTGACATGAGGGGAGTCCAATCTCAGCTCTGCCTTTTATTAGCTCTGTCACTCTAGACAAACTACTTAGCCTCATTGAGTCTCAGGCTTTCTGTGGATCAGATGTTGAACTCTTGCCTTACATCAAGGCTGTAATATTTGAATGAGTTTGATGTCTGAACCTTGTAACTGTTCAGTGTGATTTGAAATCCTTTTTTTCTCCAGAAATGGCTAGTTATTTTAGTTCTTGTGGGGCAGACTTCTTCCCCATTTTCAAAGCTCTGAATCTTAGAGTCTCAATTAAAGAGGTTCAATTTGGAATAAACACTAAACCTGGCTTCCTCTCTCAGGAGCACGGTCTGAATCTGCACAGAGCAAGATGCTGAGTGGAGTCGGGGGCTTTGTGCTGGGCCTGCTCTTCCTTGGGGCCGGGCTGTTCATCTACTTCAGGAATCAGAAAGGTGAGGAGCCTTTGGTAGCTGGCTCTCTCCATAGGCTTTTCTGGAGGAGGAACTATGGCTTTGCTGAGGTTAGTTCTCAGTATATGAGTGGCCCTGAATAAAGCCTTTCTTTCCCCAAACGGCTCTAATGTCCTGCTAATCCAGAAATCATCAGTGCATGGTTACTATGTGAAAGCATAATAGCTTGTGGCCTGCAGAGACAAGAGGAAGGTTAACAAGTAGGGGTCCTTTGGTTTGAGATCTTGGAGCAGATTAAGGAAGAGCCACTAAGACTAATGGAATTACACTGGATCCTGTGACAGACACTTCACCCTTCATGGGTCACATGGTCTGTTTCTGCTCCTCTCTGCCCTGGCTGGTGTGGGTTGTAGTGACAGAGAACTCTCCGGTGGGAGATCTGGGGCTGGGACATTGTGTTGGAAGACAGATTTGCTTCCATAAATTTTAAGTGTATATATTTTCCTCTTTTTCCCAGGACACTCTGGACTTCAGCCAAGAGGTAATACCTTTTAATCCTCTTTTAGAAACAGATACGGTTTCCCTAGTGAGAGGTGAAGCCAGCTGGACTTCTGGGTCGGGTAGGGACTTGCAGAACTTTCCTGTCTTAGGAGAGGTTTCTAAATGCACCAATCAGTGCTCTGTAAAAACACACCAATTGGCACTCTGTGGCTAGATAGATGTTTGTAAAATGGACTAATCAGCACTCTGTAAAATGGAGCAATCCACACTCTGTAAAATGGACCAATCAATGCTCTTTAAAATGGACCAATCAGCAGGACATGGGCGGGGACAAATAAGGGAATACAAGCTGGCCACCCCAGCCAGCAGCAGCAACCCGCTCAGGTCGCCTTCCATGCTGTGGAAGCTTTGTTCTTTTGCTCTTCACAATAAATCTTGCTGTTGCTCACTCTTCGGGTCTGTGCCACCTTTAAGAGCTGTAACACTCACTGTGAAGATTCGCGGCTTCATTCTTGAAGTCAGCGAAACCACGAACCCACCGGAAGGAACAAACTCTGGACACACTAGAATTGATGGTAGAGGTGATAAGGCATGAGACAGAAATAATAGGAAAGACTTTGGATCCAAATTTCTGATCAGGCAATTTACACCAAAACTCCTCCTCTCCACTTAGAAAAGGCCTGTGCTCTGTGGGACTATTGGCTCTGGGAGACTCAGGAACTTGTTTTTCTTCTTCCTGCAGTGCTCTCATCTGAGTCCCTGAAAGAGAGGAAAAGAAACTGTTAGTAGAGTCAGGTTGAAAACAACACTCTCCTCTGTCTTTTGCAGGATTCCTGAGCTGAAGTGCAGATGACACATTCAAAGAAGAACTTTCTGCCCCAGCTTTGCAGGATGAAAAGCTTTCCCTCCTGGCTGT'
    hlaLocus = mySubmissionBatch[0].submittedGene.geneLocus
    print('I stored the gene name successfully:' + str(hlaLocus))
    # roughFeatureSequence = 'aag\nCGTCGT\nccg\nGGCTGA\naat'
    alleleCallWithGFE = fetchSequenceAlleleCallWithGFE(roughFeatureSequence, hlaLocus)
    assert_true(len(alleleCallWithGFE) > 3)

    # print 'ALLELE CALL RESULTS:'
    # print alleleCallWithGFE

    annotatedSequence = parseExons(roughFeatureSequence, alleleCallWithGFE)
    #print ('ANNOTATED SEQUENCE:')
    #print (annotatedSequence)
    assert_true(len(annotatedSequence) > 3)

    imgtGenerator = ImgtSubGenerator()

    imgtGenerator.sequenceAnnotation = identifyGenomicFeatures(annotatedSequence)


    imgtSubmission = imgtGenerator.buildIMGTSubmission()

    print('IMGT SUBMISSION:\n' + imgtSubmission)

    assert_true(len(imgtSubmission) > 3)
    assert_true(imgtSubmission is not None)

    # Maybe I don't want to safe my configuration with all these test values but maybe I don't care :D
    writeConfigurationFile()

    #Print out the submission to a file, for easier validation.
    outputFileObject = open('Test_IMGT_Submission_HLA_DRB1.txt', 'w')
    submissionText = imgtSubmission
    outputFileObject.write(submissionText)

"""

def testCreateIMGTSubmissionFlatfileC():
    print ('Test: Creating IMGT Flatfile')
  
    
    submission1 = AlleleSubmission()
    submission1.submittedGene.fullSequence = 'AATCAGGACGAAGTCCCAGGTCCCGGGCGGGGCTCTCAGGGTCTCAGGCTCCAAGGGCCGTGTCTGCACTGGGGAGGCGCCGCGTTGAGGATTCTCCACTCCCCTGAGTTTCACTTCTTCTCCCAACCTGCGTCGGGTCCTTCTTCCTGAATACTCATGACGCGTCCCCAATTCCCACTCCCATTGGGTGTCGGATTCTAGAGAAGCCAATCAGCGTCTCCGCAGTCCCGGTTCTGAAGTCCCCAGTCACCCACCCGGACTCAGATTCTCCCCAGACGCCGAGATGCGGGTCATGGCGCCCCGAACCCTCATCCTGCTGCTCTCGGGAGCCCTGGCCCTGACCGAGACCTGGGCCGGTGAGTGCGGGGTTGGGAGGGAATCGGCCTCTGCGGAGAGGAGCGAGGGGCCCGCCCGGCGAGGGCGCAGGACCCGGGGAGCCGCGCAGGGAGGAGGGTCGGGCGGGTCTCAGCCCCTCCTCGCCCCCAGGCTCCCACTCCATGAGGTATTTCTACACCGCTGTGTCCCGGCCCGGCCGCGGGGAGCCCCACTTCATCGCAGTGGGCTACGTGGACGACACGCAGTTCGTGCGGTTCGACAGCGACGCCGCGAGTCCGAGAGGGGAGCCGCGGGCGCCGTGGGTGGAGCAGGAGGGGCCGGAGTATTGGGACCGGGAGACACAGAAGTACAAGCGCCAGGCACAGACTGACCGAGTGAGCCTGCGGAACCTGCGCGGCTACTACAACCAGAGCGAGGCCAGTGAGTGACCCCGGCCCGGGGCGCAGGTCACGACCCCTCCTCATCCCCCACGGACGGCCCGGGTCGCCCCAAGTCTCCCGGTCTGAGATCCACCCCGAGGCTGCGGAACCCGCCCAGACCCTCGACCGGAGAGAGCCCCAGTCACCTTTACCCGGTTTCATTTTCAGTTTAGGCCAAAATCCCCGCGGGTTGGTCGGGGCGGGGCGGGGCTCGGGGGACGGGGCTGACCGCGGGGGCGGGGCCAGGGTCTCACATCATCCAGAGGATGTATGGCTGCGACGTGGGGCCCGACGGGCGCCTCCTCCGCGGGTATGACCAGTACGCCTACGACGGCAAGGATTACATCGCCCTGAACGAGGATCTGCGCTCCTGGACCGCCGCGGACACGGCGGCTCAGATCACCCAGCGTAAGTGGGAGGCGGCCCGTGAGGCGGAGCAGCTGAGAGCCTACCTGGAGGGCCTGTGCGTGGAGTGGCTCCGCAGATACCTGAAGAATGGGAAGGAGACGCTGCAGCGCGCGGGTACCAGGGGCAGTGGGGAGCCTTCCCCATCTCCTGTAGATCTCCCGGGATGGCCTCCCACGAGGAGGGGAGGAAAATGGGATCAGCGCTAGAATATCGCCCTCCCTTGAATGGAGAATGGGATGAGTTTTCCTGAGTTTCCTCTGAGGGCCCCCTCTGCTCTCTAGGACAATTAAGGGATGAAGTCCTTGAGGAAATGGAGGGGAAGACAGTCCCTAGAATACTGATCAGGGGTCCCCTTTGACCACTTTGACCACTGCAGCAGCTGTGGTCAGGCTGCTGACCTTTCTCTCAGGCCTTGTTCTCTGCCTCACGCTCAATGTGTTTGAAGGTTTGATTCCAGCTTTTCTGAGTCCTTCGGCCTCCACTCAGGTCAGGACCAGAAGTCGCTGTTCCTCCCTCAGAGACTAGAACTTTCCAATGAATAGGAGATTATCCCAGGTGCCTGTGTCCAGGCTGGCGTCTGGGTTCTGTGCCCCCTTCCCCACCCCAGGTGTCCTGTCCGTTCTCAGGATGGTCACATGGGCGCTGTTGGAGTGTCGCAAGAGAGATACAAAGTGTCTGAATTTTCTGACTCTTCCCGTCAGAACACCCAAAGACACACGTGACCCACCATCCCGTCTCTGACCATGAGGCCACCCTGAGGTGCTGGGCCCTGGGCTTCTACCCTGCGGAGATCACACTGACCTGGCAGTGGGATGGGGAGGACCAAACTCAGGACACTGAGCTTGTGGAGACCAGGCCAGCAGGAGATGGAACCTTCCAGAAGTGGGCAGCTGTGGTGGTGCCTTCTGGAGAAGAGCAGAGATACACGTGCCATGTGCAGCACGAGGGGCTGCCGGAGCCCCTCACCCTGAGATGGGGTAAGGAGGGGGATGAGGGGTGATGTGTCTTCTCAGGGAAAGCAGAAGTCCTGGAGCCCTTCAGCCAGGTCAGGGCTGAGGCTTGGGGGTCAGGGCCCCTCACCTTCCCCTCCTTTCCCAGAGCCGTCTTCCCAGCCCACCATCCCCATCGTGGGCATCGTTGCTGGCCTGGCTGTCCTGGCTGTCCTAGCTGTCCTAGGAGCTGTGGTGGCTGTTGTGATGTGTAGGAGGAAGAGCTCAGGTAGGGAAGGGGTGAGGAGTGGGGTCTGGGTTTTCTTGTTCCACTGGGAGTTTCAAGCCCCAGGTAGAAGTGTGCCCCACCTCGTTACTGGAAGCACCATCCACACATGGGCCATCCCAGCCTGGGACCCTGTGTGCCAGCACTTACTCTGTTGTGAAGCACATGACAATGAAGGACAGATGTATCACCTTGATGATTATGGTGTTGGGGTCCTTGATTCCAGCATTCATGAGTCAGGGGAAGGTCCCTGCTAAGGACAGACCTTAGGAGGGCAGTTGCTCCAGAACCCACAGCTGCTTTCCCCGTGTTTCCTGATCCTGCCCTGGGTCTGCAGTCATAGTTCTGGAAACTTCTCTTGGGTCCAAGACTAGGAGGTTCCCCTAAGATCGCATGGCCCTGACTCCTCCCTGTCCCCTCACAGGGCATTTTCTTCCCACAGGTGGAAAAGGAGGGAGCTGCTCTCAGGCTGCGTGTAAGTGATGGCGGTGGGCGTGTGGAGGAGCTCACCCACCCCATAATTCCTCTTGTCCCACATCTCCTGCGGGCTCTGACCAGGTCTTTTTTTTTGTTCTACCCCAGCCAGCAACAGTGCCCAGGGCTCTGATGAGTCTCTCATCGCTTGTAAAGGTGAGATTCTGGGGAGCTGAAGTGGTCGGGGGTGGGGCAGAGGGAAAAGGCCTAGGTAATGGGGATCCTTTGATTGGGACGTTTCGAATGTGTGGTGAGCTGTTCAGAGTGTGATCACTTACCATGACTGACCTGAATTTGTTCATGACTATTGTGTTCTGTAGCCTGAGACAGCTGCCTGTGTGGGACTGAGATGCAGGATTTCTTCACACCTCTCCTTTGTGACTTCAAGAGCCTCTGGCATCTCTTTCTGCAAAGGCATCTGAATGTGTCTGCGTTCCTGTTAGCATAATGTGAGGAGGTGGACAGACAGCCCACCCCCGTGTCCACCGTGACCCCT'
    submission1.submittedGene.geneLocus = 'HLA-C'
    submission1.localAlleleName = 'HLA-C_NEW_1'
    submission1.closestAlleleWrittenDescription = 'Some C allele'
    submission1.imgtSubmissionIdentifier = 'HWS177477467'
    submission1.imgtSubmissionVersion = '1'
    submission1.cellId = 'Cosang_Cell_Line_1'
    submission1.ethnicOrigin = 'Caucasoid - Dutch/Irish/English, Europe'
    submission1.sex = 'M'
    submission1.consanguineous = 'Unknown'
    submission1.homozygous = 'Unknown'
    submission1.typedAlleles = 'HLA-A*01:01:01:01;HLA-B*40:72:01;HLA-DRB1*07:75;HLA-A*03:73;HLA-B*44:87;HLA-DRB1*14:90'
    submission1.materialAvailability = 'No Material Available'
    submission1.cellBank = 'Not Available'
    submission1.primarySequencingMethodology = 'Direct sequencing of PCR product from DNA (SBT)'
    submission1.secondarySequencingMethodology = 'MinION 2D Amplicon Sequencing'
    submission1.primerType = 'Both allele and locus specific'
    submission1.primers = '03PID03     CCCAAAGGGTTTCCCGGGAAATTT 3UT 3015-3042;04PID04     AAAGGGTTTCCCGGGAAATTTCCC 5UT 4015-4042'
    submission1.sequencedInIsolation = 'Yes'
    submission1.numOfReactions = '3'
    submission1.methodComments = 'Sanger SBT with confirmatory MinION Long Range sequencing.'
    submission1.citations = '1-3503;PUBMED; 9349617.;Laforet M, Froelich N, Parissiadis A, Pfeiffer B, Schell A, Faller B, Woehl-Jaegle ML, Cazenave JP, Tongio MM;A nucleotide insertion in exon 4 is responsible for the absence of expression of an HLA-A*01 allele;Tissue Antigens 50:347 - 50(1997).;1-3503;PUBMED; 9349617.;Laforet M, Froelich N, Parissiadis A, Pfeiffer B, Schell A, Faller B, Woehl-Jaegle ML, Cazenave JP, Tongio MM;A nucleotide insertion in exon 4 is responsible for the absence of expression of an HLA-A*01 allele;Tissue Antigens 50:347 - 50(1997).'
    
    submissionBatch = getConfigurationValue('submission_batch')
    submissionBatch.submissionBatch.append(submission1)
    
    roughFeatureSequence = submission1.submittedGene.fullSequence
    # roughFeatureSequence = 'GAAAGACCTGAAAGATCACGGTGCCTTCATTTCAACTGTGAGACATGATGTAATTTTCACAAATCTACAACAGTAAGATATAGTGCAACAGGACCAGATTAAGGTCTCCTGGTTTGCAACCATGTCCCCTCCATCTCCTTTACTCCTGAACACACTCACTCCTGCAAACAGTTCTCTTGTCAAGTGGGAAATGAATGCTCTTACAAGGCTCAAACTTGTGAACACATCACTGACCAGCACAGAGCTAAAATAATTGGGGCTAAAAATACCGCCCCAATTAAAGTGTTTTACATGCAACTGGTTCAAACCTTTCAAGTACTAAAAACAATCCTGTAAAGAAGGAAATTCTGTTTCAGAAGAGGACCTTCATACAGCATCTCTGACCAGCAACTGATGATGCTATTGAACTCAGATGCTGATTCGTTCTCCAACACTAGATTACCCAATCCAGGAGCAAGGAAATCAGTAACTTACTCCCTATAACTTGGAATGTGGGTGGAGGGGTTCATAGTTCTCCCTGAGTGAGACTTGCCTGCTGCTCTGGCCCCTGGTCCTGTCCTGTTCTCCAGCATGGTGTGTCTGAGGCTCCCTGGAGGCTCCTGCATGGCAGTTCTGACAGTGACACTGATGGTGCTGAGCTCCCCACTGGCTTTGGCTGGGGACACCAGACGTAAGTGCACATTGTGGGTGCTGAGCTACTATGGGGTGGGGAAAATAGGGAGTTTTGTTAACATTGTGCCCAGGCCATGTACCTTAAGAAATTGTGACGTATTTTTCAGAGATTGCCCATCTTTATCATATGGATCCCAAATAATTTCCCCACCACAAAAGGAGCTTGGCTACTTGCCCACTCCATGAGACTTGTGTAAGGGGCCTCCATACAGGTCATTTCTACTCAAATCTCCACCAATAAAACCTTTGCATCACATGTCCTCAGGGTCTTTAGAGGATTTAGAAATAAGGATGCTAAAATAAATTCCCCATACAGCACTTGCCTTTATTATGTTGACTTATGTCAGACAAAGGAGGTTTTTTCTGAAAATTTTGTGGAAGTCAAGGGAATTTAAAGGGTCTCTCCTAAACGATCCTGGGTTATGTCACCCACAGGACCTTTGGTGTTGGCCCCTCTTCCTCATATGTGAGGATGGACCCAGTGGCCTCCCCATTATCTACTTTCTTTTCTTTCTGAACTCCAATGTTTATAAAGCCTGTACCCCTGTAGTGTATGTAGGTTGTCTGACAGAAGTTATACTTAGTGCTCTTTCTTTCTTGTGGGGAAAAATCCCTGGAACTGAAGCTGAGATCTTTAGTACTTGGAGTCACCTTACAGATACAGAGCATTTATGAGGTATTCTTTGGTGCCTAAAGAACTTAAGGCATCCTCTGAAAACCTGGCCCAGGTTAGTGTTTATTATGAATCTCTTTTAACCTTTCTATACTTGTTTCTCCTACATCTCCTAAGTGCTCCAACTAGACATGACAGAAGAGATTTAACTAACGTAGTATGAGTTATATAAAATTCTATTTTTGTAAGTCAAAAATAATCAAATATCAAAAATTTAATAATGTTCAAACTATATACTCTGTGTGGGGTTACCGAGACAATGTGGACATTGTTCACATCTCATAGGGCTGAAAGTCAATGGGCAAGTCCTGGGAACTCATTGTCTTACTGGGGTCTTGTCCTAAATTTCATAGGTTCACCCATCATGCCCTCAACTTTCCTTAATTAGCCATGTCTGCTTACCTCTTCCTCCAGTTTCCCTCTTATTTTTCCCCAGCTATGTTGTTATCATTTCCAGAAATCTCTAAAGCTTGCACAGATCCTTAGCACTATGAGATCCATTGAAAGAGATAGTTTTTTTCTTTTTGAGATAGGGCCTGGCTCTGTCACCCAGGCTGTAGCTCAGTGGTGCGATCGAGGCTCACTGCAACCTCTGCCTCCCACGCTCAAGTGATCCTCCCTCCTCAGGCTCCAGAGTAGCTGGGAATACAGGCAGGCAACCACGCCCAGCTAATTTTTGTAATTTTGGTAGAAATGAGATTTTGCCATGTTGCCCAGGCTGGTCTTAAACTGCTGGACTCAAGCAATCCTCCTGCCTTGGCCTCCCAACATGCTAGGATTATAGATGTGAGCCACTGTGCCCAGGCAAAAAGAGATGACTCTCAATAAAAAAAAGTCCTTTTTCTTAAATCACTGTTTCTTTATCTGTGAATTCTTCTTCCAACTAGAAGGAGGAGAAAGAAGTTTGCCTGTATTTCTCACCAGGAGGAGAAGGGGTCTAGTGTGACATCAGAATGAAAGAGTGCTGGAGTTTGAGCCCCTTCTTGCTTTCCAAGATCCCCACAGTTATCACTTCCCATACCCTGGTTTATTCATGTAAACCACACTTATTTTTCTTAGCAGCTACTGTGTACTCGGCTCCATTCTAGGTTCAGATCATTCTATTTGATTAAGACAGAGAGGGTCCCGACTCTCATGGAAGTTACACAACAATAGAGGAGACAGACACTAACCCAATAAGCATTTAACAAAGAATAAAATATTAGAGAGTCATAGTGCACTGAAGAAAAGACATCAGGTTTGTGAAGAAGAGAGACATGGATTCACCTACTTTAGTTCATATGTTTAGGGAGCTCTACCTGAGAAAGTGACATTCAGCTGAGACAACAAAATAAGTAGACAGTCATGAAGATCTAATGGACGAAAGCTCCAGAGAGACCAAATGGGGGGAAAGCCCTGGTGTGGGAAATTATGTGGAGAGAGAGAAAGACGGCTAGAGGGGCTGATGTATAGAAAGTAAGGAAATGGAGAGGCAGAAGATGAGGTAGGACACAGAGAGAAAGTCAGGAGCCTCATCATTATAGGCTCTGATGTCCACGGTAAAAAATTTGAATTTTATTTTATTTATTTATTTATTTATTTATTTATTTATTTTATTTATTTATTTATTTTTTTAAGATGGAGTCTCGCTTTGTTGCCCAGGCTGGAGTGCAGTGGCGTGATCTCAGCTCACTGCAAGCTCCACCTCCTGGGTTCATGCCATTCTCCTGCCTCAGCCTCCCTAGTAGCTGGGACTACAGGCACCTGCCACCACGCCTGGCTAATTTTTAGTATTTTTAGTAGTGAGGGCATTTTGTCATGTTAACCAGGGTGGTCTCCATCTCCTGACCTCGTGATCCACCTGCCTCAGCCTCCCAAAGTGCTGAGACTACAGGTGTGAGCCACCACGCCTGGCCTATTTTTTTTTTTTTGAGACGGAGTTTCGTTCTTGTTGCCCAGGCTGGAGTGCAATGGTGCAATCTCGGCTCACTGCAACCTTCGCCTCCCTGGTTCAAGTGATTCTCCTGCCTCAGCTTCCCAAGTATCTGAGATTACAGGCACCCACCACCATACCTGGCTAATTTTTATTTTTTTGTATTTTTAGTAGACATGGGGTATCACCATGTTGACCATGCTGGTCTCGAACTCCTGACCTCAGATAATCTGTCTGCCTTGGCCTCCCAAAGTGCTGGGATTACAGGCATGAGCCACCGCGGCCGGACTGAATTTTATTTAAATAGATACGAGAAGCTACTGTATGGTTACAAGGAGAGTCAATTTATATTCAATTTATTTTTATTTTATTTTATTTTTTTGGTGATGGGGTCTTGCTCTGTTGCCCAGGCTAGATTGTAGTGGCACAATCTCGGCTCACTGCAACCTCTGCCTTCTGGGTTCAGGCGATTCTCCTGACTCAGCCTCCAGAGTAGCTGGGACCACAGGTACATGCCACCACACCTGGCTAAGTTTTTGTATTTTTTAGTAGAGACAGGATTTCACCATGTTAGCCAGGATGGTCTCGATCTCCTGATCTCGTGATCCACCCACCTTGGCCTCCCAAAGTGCAGGGATTACAGGCCTGAGCCACTGCGCCCGGCCTATATTCAATTTTTAAAACTAATTCTAGCTACTCTGTGGGGATTGGAATGTTGGGGTTCACAAGTGGTCAGGAAGACTATTTAGGAGCACAGCAGGGAATTCTCCAGCGAAAACAGGCTTGTGGCTTCATGGAGTGCATTAGTGATAAAGACGGTGAAAAAGATAAAGTGGACAGACTTGGCATGTATTTTTCCTTAGCTTGTTAATGAATTACTGTAAAGGGGGTAGAACAATCAAGCTTATTCCTAAGGATTTTGTTTTGACAAATAAGTGGGTGGTAGTGTTGTTTATTGAGATAGGAAAAACTATGGGAGGAAATTATTTGAAGTGGGTGGTTGGAAATAAAAGTTTTGTTTAAATTTGAGATGATTTATTGACATTTATGTGGAGCAATCAGAAGGTCAATGGCATTTAAGAGACTCATGGTGAGGCTAGGGCTTCAAGTATTTATGTTGGCGGCATCAATACGTGTAGTGTGTTAAATTCCAGGGAGTGGAAGAGGATACATAGGGAGATGGATTGTGTGGAGAAAAAAGAACAGGGCACAGGCCAGCAAAGGGGGCTGAGAAAGAGCCCAGGGATGTTGGAGAAAAATCAAGAGAACATGATGCATGTAAGTCAAGGAAAATAGATTTTTTTCAAGGAGAAGGGAGAGGCCAATTGTGGTGAGTACCACTAAGCGGAGGGGGAAGTGAGAACGTGACAGAGAAGCAAGTGCTGGGTTTGGTGGAGTTGATATTTGCAGTCAGTGGAGTATCCAGGGAGGAAACTGGATTGGACAATTTGAAGAGCGAGTAGAAGTGAGGATGAGGTTAAGGTTGACTGTTTTGAGTAGAGAGGTTCAGGGAAGGACTGCACTCTGGGTTCAGGGAGCCAGCTGGATCAAAAGGAAAAGGCTAAAGAGGCTGAAGAGAAGCAGGAGGACCTGTGAACCAGAGATGCTCAGTCATTATTAGCGAGGAAATACTAGAAAGCCCCTGTGTGCAGTGATGACTACTCATGCAGAAGGTCACACAGCCAATATTTAACACAGCCAGTATTTCACACAGCTAATATTTATTAGTGACATAGAATATACCAGTTATTACTCTAGGTCATGAGAATGGAGTGATAAATAAAATGAATCCGGTCGCCATCAGTATATGCCATGTAACATTTTGCAGTGACTGTGTACCAGGCCTGTGAATTTCAGTATGCAATTTCAATAATGATCCTGCTGTATCTGTGGTGTTTAAAAACATATACATCTCTGGAATCTAAAATTGAGAGGTTATAAGTAAAACCCAGTATTACAAATTGAGTGCTGGAAATCAGATTGCAGTTTAAATCTGAGCATATAGAAAGTCCCTTTCTTCTATGTCAGCAGATGCCTTTTGTGTGAGGTTTAGCTGGACTGCATTATTAGACATAAACCAGTGTTTCTGCCCTATGTTTTCAGAATGACAATTCTTTATGAAACTCATAGAAGAACAGAAGACAACTGCAAAATCATGATGAAGATAGTAATTGCTTTAGAATTAAGGAATACAAAAAATAATGTGAGCTGTAGTTATAGGGATCATAAAAGTTTAAATGGGAATGTATTTGAGTATGTGATCAGTGCTAAGAAGAGTCATCATTTAATTTTACACTTAACAGTAATCTCGTGAGGATTACGCTATTATTAAATGCATTTGATAGATTACAAAAAGGCTTATGGTTGGTAAAAATTGACCCAAGTAGAAGAGATCATGTTTTTATTCAGGTTTTCTGATTCTAGAGTTTGAGAGTTTGTCCATCATTAGTGAGTAGTGACTATATTGTGTCTGAATTATTGACAGAATTTCTGATATTCATATGTACCAGGTTGTTTCTTAGAGTGGGGATAGAGATGCAAGGGCTGCTAGTTCCGATGTATTGGGGAAACTTTCATTCATTTTGCATTTATCATTTTAAAGTTCTGTATGTCTATAATGGTCATGTGTTGAAGAACACAAGGAAGTATTAAATCACTCCTTCTTCTAAGGTTTGACTAGCAAGTTGGGCTAGAGTTACCAAATAAAATACATGTTCCTAGTGAAATCTGAATTTCAGATACAAAACCATAATTTATTGAAAATCCAAATTTAACTGGGCATCCTCTGGTTTTATTTGCCACATCTGTCAACCCTAAGTGCGACACATGGACATGGATTACAGTGCTAACCATGCAAGCCACGGTGACAGCAACTTCACACATGTTTATTTTTAACTTTCTCTGTAAGAAAGTGCTTAGATAATTTAGGGATAAAAAGATAGACATTGCTTGATCCAGGGTGCACACCTCTCTGCCACCATTTCTAAAGGCAAAGGGAGATTTCTGCAGGTCTTGCTCACAGTCTGGGGAGCTGCTCATTTTTGTAAAGTGTCTGTATGAGAATGTCATTTTCTTGGTTTCCTCCTTTCCGAGGGGACTTGACTACAAAACCAAGAGTTCTGCCTCTGGCCAAGGCTGGTAATTTGATGCCTGCTAGTATTGTTGGGAGTGGGAGACTGAAAGAAATGAGTTAGTTGGGGCATTTAACGGGAATAAAATAGCTGTGGTTGTGACTCATTACTACAGATAATTAGTGGACCAGTGGCAGAGAAATTAAGAAAAAAGATGATGTGAATGATAAATGATATGATTAGTGACTGCTTGGTAAGGCAAGGAAATCATTAAATCTTGGTTCTCATCAAGTTCATTTTCTGGAAAGATAGCACTGTATTGGGAGCAGAATTCTACAAAACCTTCTTTTTACATAGGACCAAGATTTTCAACAAATATTTTTCAATGCAATTCTCAGCTGCTCCATAACTAATAGTAGCTTGTTCAACACAGATTTTTTCAGATGATTCACACCTGTGGTACTTACCCAGGGATGGTTCACCACCCCTCCCTTCCCTCTCATCATCGTTGGGGAACGGTGACAATGTTTGGAACAATTTTTGGTTGTCACAAACAGGGGTTTCTTCTGATATTCAATGAGTAGAAGCCAGGGACACTGCTAGAGAACCCACAATGTTCAGAACAGCCTCTGCCATCAACAAGGAATTATCTGGTCCAAAATGTCAATAGTGCTGAGGCTAAGAGCACTGGTTCACACTGTGCTCTTTCTGAAAATTCTAGACTCACATCTGTTATACACTCACCACACAGTTTAGTCTTTTATTTTTGCTTGTTTCATTATAAACAATTAGACAGTTGTATAAATTCAACCACTTTCTTGTTGAATCCATTTAGTCAATGCAAGCTCAATATTTTCATATTTATTTTTTGCCTTATGCAATATTTTTCAACATTTTCATGAGTTGTCGGTCATCACTATCTCTATTAACTTTCAACAACTTGCCCTTGTAAGTCACAAATAGTGCTGCTGCTGAAATTATTTCTCACTAACATGCCTCAGATTTCTGTAGTGATTCTACATTTGATATTATTCACAATGTAAAATGCTTCTATTTATTCATTTCGCTTTTACCCAAGGATTATTTTTAAGTTATTTTTGTCATTTTCACACTTCAAACATAAAGACAAAAACATCAAAAATATAGTGTTTTACATATGTGCATATTTTCACACATATATGTATGTATATTTATATGTATTGAAACTACAGAAGCACATGTCACCAATAAGAGCTCTGAGACACCTTCGACCACTTACCCTTATCAGATGAGTTGTGGAAACAAGTTTTTTTTAACTGAATTTCTGAGCTTTGTGGATTTAGAAATGCAAAGGAAGGTTTGTGGACATTCACAGGGATCATGATTTTATTCTCCTTAAAACTCTTCTGTACTTTCCAATTGTCCTTAGTATAAATCCAAAATCCTAACACCACCCAAGAGGCTTTTCAATACCTGGCTCCTGTGATTTCTCCTGTCTAATCTTTTACCCTCCTTCCCCTCAGCCTCTCTGCTTTAGTGAACTTTCTCCTAGTTTTTTGAAGAAGTTCATCAATTCAAGCTTTTGTACATGGGATTTCCTAAACCTGAAATGTGCCTCCCGTTTTGTCCAAACAGACACGGGCTCCACTCTGCCCCCTGGCTCACACCTGCTTAACCTGTCAAGTCACATCTGAACCGTCACTATTAAGAGGGTCCTTCTCTGGCACCCTAATGTAATTGAGATCATCCTATTATTCTCTGTTCTAGAACTCCACACTTCCGACATTTCTCATTCCTGTCTAAGCTCTTGTGTGTTTGGTGTTGGGCCATCACTTTCACTGCTCTTTAAGCTCCCCCAGCGGAGTGGAGAGGTCTGTTTTCCCTCGTTTGGATTCCTAGAGGCAGCGCAGACCAGGCACAAGGTCAGCACTAAGGAAGGGTTCACAGGATGAACGCGGTGGGTGCTGTTTAAGGAACCGGTAAACGTGTGGGATGAGAGAAGGAGCAGAGTGTCTTTGGGGTGGAGGCTCCCAGGAGGAGGCGGCGCGGGCTGCGGTGCGGGGCGGATCCTCCTCCAGCTCCTGCTTGGAGGTCTCCAGAACAGGCTGGAGGTAGGGAGGGGGGTCCCAAAAGCCTGGGGATCAGACGTGGTTTTCCCGCCTGGTCCCCCAGGCCCCCTTTCGCCTCAGGAAGACAGAGGAGGAGCCCCTGGGCTGCAGGTGGTGGGCGTTGCGGCGGGGGCCGGTTAAGGTTCCCAGTGCCCGCACCCGGCCCAGGGAGCCCCGGATGGCGGCGTCACTGTCAGTGTCTTCTCAGGAGGCCGCCTGTGTGACTGGATCGTTCGTGTCCCCACAGCACGTTTCTTGGAGTACTCTACGTCTGAGTGTCATTTCTTCAATGGGACGGAGCGGGTGCGGTTCCTGGACAGATACTTCTATAACCAAGAGGAGTACGTGCGCTTCGACAGCGACGTGGGGGAGTTCCGGGCGGTGACGGAGCTGGGGCGGCCTGATGAGGAGTACTGGAACAGCCAGAAGGACATCCTGGAAGACGAGCGGGCCGCGGTGGACACCTACTGCAGACACAACTACGGGGTTGTGGAGAGCTTCACAGTGCAGCGGCGAGGTGAGCGCGGCGCGGGGCGGGGCCTGAGTCCCTGTGAGCTGGGAATCTGAGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGAGAGAGAGACAGAGAGACAGAGAGAGAGAGAGCGCCATCTGTGAGCATTTAGAATCCTCTCTATCCTGAGCAAGGAGTTCTGAGGGCACAGGTGTGTGTGTAGAGTGTGGATTTGTCTGTGTCTGTGAGGCTGTTGTGGGAGGGGAGGCAGGAGGGGGCTGCTTCTTATTCTTGGAGGACTCTGTGGGGAGGTGACAAGGGAGGTGGGTGCGGGCGGCTGGAGAGAGAGGTGACCTTGATTGTCTCGGGTCCTTAGAGATGCAGGGAAGGGAAATGTAAGGGGTGTGTGGTTGGGGTGAAGGTTTAGGGGAGGAGAGCTGAGGGGTAAGGAAGGTTTGGGATAATGTGAGGAGGCCAGTTCCAGACTGTCCCTGGCACACACCCTTCATGTAATCTCTGAAATAAAAGTGTGTGCTGTTTGTTTGTAAAAGCATTAGATTAATTTCTAGGGGAATTGAGGAGACCTCTGAGGCATCTCTGAAGCTTCTTTAGGTCTAAATTTCTTGCTAGTTTTTTGTTTTTTATTGTGTATATTTTTACATAGTAGAAATGACTGTGAAACTAACTTTTTGAATTAAAGTTTTAACACAGTTACTATTTTATTATAATGCTAATAGTTTTCTAGTAGTTACATATTATTCTTTTATATATAATAGTTGTGACACAACTTACCTCACTTTCCCCTTTGTTGACCTTTATTATGACATTCACCAAAATTTGAAAATGTATGTTTCTGGTTAATTTTTAATTTATATTTTTTTCATTTATAATTCTTTTGAATTATTTTGACCTATTTATTGGCCAGTTTTAATAACTGCTGTAAGAATTCCCTATTGTATTTGGTAGGGAATGGACAATGATCTACTGCCTAATATCTCGAGGGCTTAGTATTTTTCTCAGTGACTTTGTGGGTTCTTTGTACTGTGAGATTATTAACACTTTATTGATATTTGATTCAGCATTTGCTCCAGTTTGTGGTTTGTATGTTGATTTTGAAAATTCTTTTCCATGTTAAGAATTTGAACATTTTTATATAATAAAATATGTTGCAAAATTTTTATTAATGATTTACAATCCATCTTAAATCTGCCATTTTGTGGTATTGTTGTCTCCAGGTTTCTCCTTACTTCTAAAAAAAATTGCATTTATTGAGAGTCTGCTAGTGTTAGGGATTTTCCTGGGCATAAGCACCCCAAGTGACGAGTCCCAGACACTGCCTTAATCCAAATGTGATTCTGGAAAGAAAAATCATTTTACAATGATAGGCCTAATAATAATTAAGCTTGTGTTGCATGGGAGATGCATTGATCAGCTAAATGTAAATATAAGAACTTTCAAAACTAAAATGACGTTCCTTAATCCTTCTCTCTGCTTTATGACTCATGCTTTTCTGGGAAAGTAAAAATTTGGAGAATCATTTCTGTCTGTCCCACCTTCCCAGGGGCAGAACCATTTCTGTGGTGTTCTAAGGTGTGAGTGCATGGCGGTAGTATTCCTAAAAATTCATATTCGGTTTCGTCATGTACCCAACTCTGTCCCGTTATCTATCAACATTGTTTTAAATCATATATTTCTGTCAAGGTGTACAAGGATGATAAATAGGTGCCAAGTGGAGCACCCAAGTGTGATGAGCCCCCTCACAGTGGAATGGAGTGTGAAGCTTTATGACCTCATAAATTGAAGGTTATCTTCAGTCATTGTTTTATATATTTTACATGCATTAATCCTCATATAATCCCAAGAGGTAAATTAGTATAATTATCCTTCATTATAGGTGACAAAGTTGAGACACAGAAGAATCGAACTCTTAAGGCAGACCTTGGATTTGAACCAGGCAACCTGGCTCAGATATCAGTTTTAATTACTACACTCTGTACTTTCAAAGATTTGTAAACACTTTGACAATGCATGACAATTTCAAGCTATGAAGAAACAAACACAATTTTTCACAATATCTCTCAAATCTAATAGGTCCTCACTATCAAGATTAAGTTCCAGGCTGATGACACTGTAAGGCCACATGGCCAGCTGTGCTGGAGGCCTGGTCAAGGTCAGAGCCTGGGTTTGCAGAGAAGCAGACAAACAGCCAAACAAGGAGACTTACTCTGTCTTCATGACTCATTCCCTCTACCTTTTTTCTCCTAGTCCATCCTAAGGTGACTGTGTATCCTTCAAAGACCCAGCCCCTGCAGCACCACAACCTCCTGGTCTGTTCTGTGAGTGGTTTCTATCCAGGCAGCATTGAAGTCAGGTGGTTCCGGAATGGCCAGGAAGAGAAGACTGGGGTGGTGTCCACAGGCCTGATCCACAATGGAGACTGGACCTTCCAGACCCTGGTGATGCTGGAAACAGTTCCTCGGAGTGGAGAGGTTTACACCTGCCAAGTGGAGCACCCAAGCGTGACAAGCCCTCTCACAGTGGAATGGAGTGAGCAGCTTTCTGACTTCATAAATTTCTCACCCACCAAGAAGGGGACTGTGCTCATCCCTGAGTGTCAGGTTTCTCCTCTCCGACATCCTATTTTCATTTGCTCCATGTTCTCATCTCCATCAGCACAGGTCACTGGGGGTAGCCCTGTAGGTGTTTCTAGAAACACCTGTACCTCCTGGAGAAGCAGTCTCGCCTGCCAGGCAGGAGAGGCTGTCCCTCTTTTGAACCTCCCCATGATGTCACAGGTCAGGGTCACCCACCCTCCCCGGGCTCCAGGCACTGCCTCTGGGTCTGAGACTGAGTTTCTGGTGCTGTTGATCTGAGTTATTTGTTGTGATCTGGGAAGAGGAGAAGTGTAGGGGCCTTCCTGACATGAGGGGAGTCCAATCTCAGCTCTGCCTTTTATTAGCTCTGTCACTCTAGACAAACTACTTAGCCTCATTGAGTCTCAGGCTTTCTGTGGATCAGATGTTGAACTCTTGCCTTACATCAAGGCTGTAATATTTGAATGAGTTTGATGTCTGAACCTTGTAACTGTTCAGTGTGATTTGAAATCCTTTTTTTCTCCAGAAATGGCTAGTTATTTTAGTTCTTGTGGGGCAGACTTCTTCCCCATTTTCAAAGCTCTGAATCTTAGAGTCTCAATTAAAGAGGTTCAATTTGGAATAAACACTAAACCTGGCTTCCTCTCTCAGGAGCACGGTCTGAATCTGCACAGAGCAAGATGCTGAGTGGAGTCGGGGGCTTTGTGCTGGGCCTGCTCTTCCTTGGGGCCGGGCTGTTCATCTACTTCAGGAATCAGAAAGGTGAGGAGCCTTTGGTAGCTGGCTCTCTCCATAGGCTTTTCTGGAGGAGGAACTATGGCTTTGCTGAGGTTAGTTCTCAGTATATGAGTGGCCCTGAATAAAGCCTTTCTTTCCCCAAACGGCTCTAATGTCCTGCTAATCCAGAAATCATCAGTGCATGGTTACTATGTGAAAGCATAATAGCTTGTGGCCTGCAGAGACAAGAGGAAGGTTAACAAGTAGGGGTCCTTTGGTTTGAGATCTTGGAGCAGATTAAGGAAGAGCCACTAAGACTAATGGAATTACACTGGATCCTGTGACAGACACTTCACCCTTCATGGGTCACATGGTCTGTTTCTGCTCCTCTCTGCCCTGGCTGGTGTGGGTTGTAGTGACAGAGAACTCTCCGGTGGGAGATCTGGGGCTGGGACATTGTGTTGGAAGACAGATTTGCTTCCATAAATTTTAAGTGTATATATTTTCCTCTTTTTCCCAGGACACTCTGGACTTCAGCCAAGAGGTAATACCTTTTAATCCTCTTTTAGAAACAGATACGGTTTCCCTAGTGAGAGGTGAAGCCAGCTGGACTTCTGGGTCGGGTAGGGACTTGCAGAACTTTCCTGTCTTAGGAGAGGTTTCTAAATGCACCAATCAGTGCTCTGTAAAAACACACCAATTGGCACTCTGTGGCTAGATAGATGTTTGTAAAATGGACTAATCAGCACTCTGTAAAATGGAGCAATCCACACTCTGTAAAATGGACCAATCAATGCTCTTTAAAATGGACCAATCAGCAGGACATGGGCGGGGACAAATAAGGGAATACAAGCTGGCCACCCCAGCCAGCAGCAGCAACCCGCTCAGGTCGCCTTCCATGCTGTGGAAGCTTTGTTCTTTTGCTCTTCACAATAAATCTTGCTGTTGCTCACTCTTCGGGTCTGTGCCACCTTTAAGAGCTGTAACACTCACTGTGAAGATTCGCGGCTTCATTCTTGAAGTCAGCGAAACCACGAACCCACCGGAAGGAACAAACTCTGGACACACTAGAATTGATGGTAGAGGTGATAAGGCATGAGACAGAAATAATAGGAAAGACTTTGGATCCAAATTTCTGATCAGGCAATTTACACCAAAACTCCTCCTCTCCACTTAGAAAAGGCCTGTGCTCTGTGGGACTATTGGCTCTGGGAGACTCAGGAACTTGTTTTTCTTCTTCCTGCAGTGCTCTCATCTGAGTCCCTGAAAGAGAGGAAAAGAAACTGTTAGTAGAGTCAGGTTGAAAACAACACTCTCCTCTGTCTTTTGCAGGATTCCTGAGCTGAAGTGCAGATGACACATTCAAAGAAGAACTTTCTGCCCCAGCTTTGCAGGATGAAAAGCTTTCCCTCCTGGCTGT'
    hlaLocus = submission1.submittedGene.geneLocus
    print('I stored the gene name successfully:' + str(hlaLocus))
    # roughFeatureSequence = 'aag\nCGTCGT\nccg\nGGCTGA\naat'
    alleleCallWithGFE = fetchSequenceAlleleCallWithGFE(roughFeatureSequence, hlaLocus)
    assert_true(len(alleleCallWithGFE) > 3)

    # print 'ALLELE CALL RESULTS:'
    # print alleleCallWithGFE

    annotatedSequence = parseExons(roughFeatureSequence, alleleCallWithGFE)
    #print ('ANNOTATED SEQUENCE:')
    #print (annotatedSequence)
    assert_true(len(annotatedSequence) > 3)

    imgtGenerator = ImgtSubGenerator()

    imgtGenerator.sequenceAnnotation = identifyGenomicFeatures(annotatedSequence)


    imgtSubmission = imgtGenerator.buildIMGTSubmission()

    print('IMGT SUBMISSION:\n' + imgtSubmission)

    assert_true(len(imgtSubmission) > 3)
    assert_true(imgtSubmission is not None)
    
    
    writeConfigurationFile()

    # Print out the submission to a file, for easier validation.
    outputFileObject = open('Test_IMGT_Submission_HLA_C.txt', 'w')
    submissionText = imgtSubmission
    outputFileObject.write(submissionText)

    
    """
def testCreateIMGTSubmissionFlatfileDRB1_wSnp():

    print ('Test: Creating IMGT Flatfile')
    # assignConfigurationValue('nmdp_act_rest_address', 'http://act.b12x.org/type_align' )
    assignConfigurationValue('nmdp_act_rest_address', 'http://localhost/type_align')
    assert_true(True)
    # >HLA-A*02:01:01:12 Full Length Allele. Will we allele call correctly?
    # > HLA - DRB1 * 11:02:01 I will add a single SNP in exon 3
    roughFeatureSequence = 'GAAAGACCTGAAAGATCACGGTGCCTTCATTTCAACTGTGAGACATGATGTAATTTTCACAAATCTACAACAGTAAGATATAGTGCAACAGGACCAGATTAAGGTCTCCTGGTTTGCAACCATGTCCCCTCCATCTCCTTTACTCCTGAACACACTCACTCCTGCAAACAGTTCTCTTGTCAAGTGGGAAATGAATGCTCTTACAAGGCTCAAACTTGTGAACACATCACTGACCAGCACAGAGCTAAAATAATTGGGGCTAAAAATACCGCCCCAATTAAAGTGTTTTACATGCAACTGGTTCAAACCTTTCAAGTACTAAAAACAATCCTGTAAAGAAGGAAATTCTGTTTCAGAAGAGGACCTTCATACAGCATCTCTGACCAGCAACTGATGATGCTATTGAACTCAGATGCTGATTCGTTCTCCAACACTAGATTACCCAATCCAGGAGCAAGGAAATCAGTAACTTACTCCCTATAACTTGGAATGTGGGTGGAGGGGTTCATAGTTCTCCCTGAGTGAGACTTGCCTGCTGCTCTGGCCCCTGGTCCTGTCCTGTTCTCCAGCATGGTGTGTCTGAGGCTCCCTGGAGGCTCCTGCATGGCAGTTCTGACAGTGACACTGATGGTGCTGAGCTCCCCACTGGCTTTGGCTGGGGACACCAGACGTAAGTGCACATTGTGGGTGCTGAGCTACTATGGGGTGGGGAAAATAGGGAGTTTTGTTAACATTGTGCCCAGGCCATGTACCTTAAGAAATTGTGACGTATTTTTCAGAGATTGCCCATCTTTATCATATGGATCCCAAATAATTTCCCCACCACAAAAGGAGCTTGGCTACTTGCCCACTCCATGAGACTTGTGTAAGGGGCCTCCATACAGGTCATTTCTACTCAAATCTCCACCAATAAAACCTTTGCATCACATGTCCTCAGGGTCTTTAGAGGATTTAGAAATAAGGATGCTAAAATAAATTCCCCATACAGCACTTGCCTTTATTATGTTGACTTATGTCAGACAAAGGAGGTTTTTTCTGAAAATTTTGTGGAAGTCAAGGGAATTTAAAGGGTCTCTCCTAAACGATCCTGGGTTATGTCACCCACAGGACCTTTGGTGTTGGCCCCTCTTCCTCATATGTGAGGATGGACCCAGTGGCCTCCCCATTATCTACTTTCTTTTCTTTCTGAACTCCAATGTTTATAAAGCCTGTACCCCTGTAGTGTATGTAGGTTGTCTGACAGAAGTTATACTTAGTGCTCTTTCTTTCTTGTGGGGAAAAATCCCTGGAACTGAAGCTGAGATCTTTAGTACTTGGAGTCACCTTACAGATACAGAGCATTTATGAGGTATTCTTTGGTGCCTAAAGAACTTAAGGCATCCTCTGAAAACCTGGCCCAGGTTAGTGTTTATTATGAATCTCTTTTAACCTTTCTATACTTGTTTCTCCTACATCTCCTAAGTGCTCCAACTAGACATGACAGAAGAGATTTAACTAACGTAGTATGAGTTATATAAAATTCTATTTTTGTAAGTCAAAAATAATCAAATATCAAAAATTTAATAATGTTCAAACTATATACTCTGTGTGGGGTTACCGAGACAATGTGGACATTGTTCACATCTCATAGGGCTGAAAGTCAATGGGCAAGTCCTGGGAACTCATTGTCTTACTGGGGTCTTGTCCTAAATTTCATAGGTTCACCCATCATGCCCTCAACTTTCCTTAATTAGCCATGTCTGCTTACCTCTTCCTCCAGTTTCCCTCTTATTTTTCCCCAGCTATGTTGTTATCATTTCCAGAAATCTCTAAAGCTTGCACAGATCCTTAGCACTATGAGATCCATTGAAAGAGATAGTTTTTTTCTTTTTGAGATAGGGCCTGGCTCTGTCACCCAGGCTGTAGCTCAGTGGTGCGATCGAGGCTCACTGCAACCTCTGCCTCCCACGCTCAAGTGATCCTCCCTCCTCAGGCTCCAGAGTAGCTGGGAATACAGGCAGGCAACCACGCCCAGCTAATTTTTGTAATTTTGGTAGAAATGAGATTTTGCCATGTTGCCCAGGCTGGTCTTAAACTGCTGGACTCAAGCAATCCTCCTGCCTTGGCCTCCCAACATGCTAGGATTATAGATGTGAGCCACTGTGCCCAGGCAAAAAGAGATGACTCTCAATAAAAAAAAGTCCTTTTTCTTAAATCACTGTTTCTTTATCTGTGAATTCTTCTTCCAACTAGAAGGAGGAGAAAGAAGTTTGCCTGTATTTCTCACCAGGAGGAGAAGGGGTCTAGTGTGACATCAGAATGAAAGAGTGCTGGAGTTTGAGCCCCTTCTTGCTTTCCAAGATCCCCACAGTTATCACTTCCCATACCCTGGTTTATTCATGTAAACCACACTTATTTTTCTTAGCAGCTACTGTGTACTCGGCTCCATTCTAGGTTCAGATCATTCTATTTGATTAAGACAGAGAGGGTCCCGACTCTCATGGAAGTTACACAACAATAGAGGAGACAGACACTAACCCAATAAGCATTTAACAAAGAATAAAATATTAGAGAGTCATAGTGCACTGAAGAAAAGACATCAGGTTTGTGAAGAAGAGAGACATGGATTCACCTACTTTAGTTCATATGTTTAGGGAGCTCTACCTGAGAAAGTGACATTCAGCTGAGACAACAAAATAAGTAGACAGTCATGAAGATCTAATGGACGAAAGCTCCAGAGAGACCAAATGGGGGGAAAGCCCTGGTGTGGGAAATTATGTGGAGAGAGAGAAAGACGGCTAGAGGGGCTGATGTATAGAAAGTAAGGAAATGGAGAGGCAGAAGATGAGGTAGGACACAGAGAGAAAGTCAGGAGCCTCATCATTATAGGCTCTGATGTCCACGGTAAAAAATTTGAATTTTATTTTATTTATTTATTTATTTATTTATTTATTTATTTTATTTATTTATTTATTTTTTTAAGATGGAGTCTCGCTTTGTTGCCCAGGCTGGAGTGCAGTGGCGTGATCTCAGCTCACTGCAAGCTCCACCTCCTGGGTTCATGCCATTCTCCTGCCTCAGCCTCCCTAGTAGCTGGGACTACAGGCACCTGCCACCACGCCTGGCTAATTTTTAGTATTTTTAGTAGTGAGGGCATTTTGTCATGTTAACCAGGGTGGTCTCCATCTCCTGACCTCGTGATCCACCTGCCTCAGCCTCCCAAAGTGCTGAGACTACAGGTGTGAGCCACCACGCCTGGCCTATTTTTTTTTTTTTGAGACGGAGTTTCGTTCTTGTTGCCCAGGCTGGAGTGCAATGGTGCAATCTCGGCTCACTGCAACCTTCGCCTCCCTGGTTCAAGTGATTCTCCTGCCTCAGCTTCCCAAGTATCTGAGATTACAGGCACCCACCACCATACCTGGCTAATTTTTATTTTTTTGTATTTTTAGTAGACATGGGGTATCACCATGTTGACCATGCTGGTCTCGAACTCCTGACCTCAGATAATCTGTCTGCCTTGGCCTCCCAAAGTGCTGGGATTACAGGCATGAGCCACCGCGGCCGGACTGAATTTTATTTAAATAGATACGAGAAGCTACTGTATGGTTACAAGGAGAGTCAATTTATATTCAATTTATTTTTATTTTATTTTATTTTTTTGGTGATGGGGTCTTGCTCTGTTGCCCAGGCTAGATTGTAGTGGCACAATCTCGGCTCACTGCAACCTCTGCCTTCTGGGTTCAGGCGATTCTCCTGACTCAGCCTCCAGAGTAGCTGGGACCACAGGTACATGCCACCACACCTGGCTAAGTTTTTGTATTTTTTAGTAGAGACAGGATTTCACCATGTTAGCCAGGATGGTCTCGATCTCCTGATCTCGTGATCCACCCACCTTGGCCTCCCAAAGTGCAGGGATTACAGGCCTGAGCCACTGCGCCCGGCCTATATTCAATTTTTAAAACTAATTCTAGCTACTCTGTGGGGATTGGAATGTTGGGGTTCACAAGTGGTCAGGAAGACTATTTAGGAGCACAGCAGGGAATTCTCCAGCGAAAACAGGCTTGTGGCTTCATGGAGTGCATTAGTGATAAAGACGGTGAAAAAGATAAAGTGGACAGACTTGGCATGTATTTTTCCTTAGCTTGTTAATGAATTACTGTAAAGGGGGTAGAACAATCAAGCTTATTCCTAAGGATTTTGTTTTGACAAATAAGTGGGTGGTAGTGTTGTTTATTGAGATAGGAAAAACTATGGGAGGAAATTATTTGAAGTGGGTGGTTGGAAATAAAAGTTTTGTTTAAATTTGAGATGATTTATTGACATTTATGTGGAGCAATCAGAAGGTCAATGGCATTTAAGAGACTCATGGTGAGGCTAGGGCTTCAAGTATTTATGTTGGCGGCATCAATACGTGTAGTGTGTTAAATTCCAGGGAGTGGAAGAGGATACATAGGGAGATGGATTGTGTGGAGAAAAAAGAACAGGGCACAGGCCAGCAAAGGGGGCTGAGAAAGAGCCCAGGGATGTTGGAGAAAAATCAAGAGAACATGATGCATGTAAGTCAAGGAAAATAGATTTTTTTCAAGGAGAAGGGAGAGGCCAATTGTGGTGAGTACCACTAAGCGGAGGGGGAAGTGAGAACGTGACAGAGAAGCAAGTGCTGGGTTTGGTGGAGTTGATATTTGCAGTCAGTGGAGTATCCAGGGAGGAAACTGGATTGGACAATTTGAAGAGCGAGTAGAAGTGAGGATGAGGTTAAGGTTGACTGTTTTGAGTAGAGAGGTTCAGGGAAGGACTGCACTCTGGGTTCAGGGAGCCAGCTGGATCAAAAGGAAAAGGCTAAAGAGGCTGAAGAGAAGCAGGAGGACCTGTGAACCAGAGATGCTCAGTCATTATTAGCGAGGAAATACTAGAAAGCCCCTGTGTGCAGTGATGACTACTCATGCAGAAGGTCACACAGCCAATATTTAACACAGCCAGTATTTCACACAGCTAATATTTATTAGTGACATAGAATATACCAGTTATTACTCTAGGTCATGAGAATGGAGTGATAAATAAAATGAATCCGGTCGCCATCAGTATATGCCATGTAACATTTTGCAGTGACTGTGTACCAGGCCTGTGAATTTCAGTATGCAATTTCAATAATGATCCTGCTGTATCTGTGGTGTTTAAAAACATATACATCTCTGGAATCTAAAATTGAGAGGTTATAAGTAAAACCCAGTATTACAAATTGAGTGCTGGAAATCAGATTGCAGTTTAAATCTGAGCATATAGAAAGTCCCTTTCTTCTATGTCAGCAGATGCCTTTTGTGTGAGGTTTAGCTGGACTGCATTATTAGACATAAACCAGTGTTTCTGCCCTATGTTTTCAGAATGACAATTCTTTATGAAACTCATAGAAGAACAGAAGACAACTGCAAAATCATGATGAAGATAGTAATTGCTTTAGAATTAAGGAATACAAAAAATAATGTGAGCTGTAGTTATAGGGATCATAAAAGTTTAAATGGGAATGTATTTGAGTATGTGATCAGTGCTAAGAAGAGTCATCATTTAATTTTACACTTAACAGTAATCTCGTGAGGATTACGCTATTATTAAATGCATTTGATAGATTACAAAAAGGCTTATGGTTGGTAAAAATTGACCCAAGTAGAAGAGATCATGTTTTTATTCAGGTTTTCTGATTCTAGAGTTTGAGAGTTTGTCCATCATTAGTGAGTAGTGACTATATTGTGTCTGAATTATTGACAGAATTTCTGATATTCATATGTACCAGGTTGTTTCTTAGAGTGGGGATAGAGATGCAAGGGCTGCTAGTTCCGATGTATTGGGGAAACTTTCATTCATTTTGCATTTATCATTTTAAAGTTCTGTATGTCTATAATGGTCATGTGTTGAAGAACACAAGGAAGTATTAAATCACTCCTTCTTCTAAGGTTTGACTAGCAAGTTGGGCTAGAGTTACCAAATAAAATACATGTTCCTAGTGAAATCTGAATTTCAGATACAAAACCATAATTTATTGAAAATCCAAATTTAACTGGGCATCCTCTGGTTTTATTTGCCACATCTGTCAACCCTAAGTGCGACACATGGACATGGATTACAGTGCTAACCATGCAAGCCACGGTGACAGCAACTTCACACATGTTTATTTTTAACTTTCTCTGTAAGAAAGTGCTTAGATAATTTAGGGATAAAAAGATAGACATTGCTTGATCCAGGGTGCACACCTCTCTGCCACCATTTCTAAAGGCAAAGGGAGATTTCTGCAGGTCTTGCTCACAGTCTGGGGAGCTGCTCATTTTTGTAAAGTGTCTGTATGAGAATGTCATTTTCTTGGTTTCCTCCTTTCCGAGGGGACTTGACTACAAAACCAAGAGTTCTGCCTCTGGCCAAGGCTGGTAATTTGATGCCTGCTAGTATTGTTGGGAGTGGGAGACTGAAAGAAATGAGTTAGTTGGGGCATTTAACGGGAATAAAATAGCTGTGGTTGTGACTCATTACTACAGATAATTAGTGGACCAGTGGCAGAGAAATTAAGAAAAAAGATGATGTGAATGATAAATGATATGATTAGTGACTGCTTGGTAAGGCAAGGAAATCATTAAATCTTGGTTCTCATCAAGTTCATTTTCTGGAAAGATAGCACTGTATTGGGAGCAGAATTCTACAAAACCTTCTTTTTACATAGGACCAAGATTTTCAACAAATATTTTTCAATGCAATTCTCAGCTGCTCCATAACTAATAGTAGCTTGTTCAACACAGATTTTTTCAGATGATTCACACCTGTGGTACTTACCCAGGGATGGTTCACCACCCCTCCCTTCCCTCTCATCATCGTTGGGGAACGGTGACAATGTTTGGAACAATTTTTGGTTGTCACAAACAGGGGTTTCTTCTGATATTCAATGAGTAGAAGCCAGGGACACTGCTAGAGAACCCACAATGTTCAGAACAGCCTCTGCCATCAACAAGGAATTATCTGGTCCAAAATGTCAATAGTGCTGAGGCTAAGAGCACTGGTTCACACTGTGCTCTTTCTGAAAATTCTAGACTCACATCTGTTATACACTCACCACACAGTTTAGTCTTTTATTTTTGCTTGTTTCATTATAAACAATTAGACAGTTGTATAAATTCAACCACTTTCTTGTTGAATCCATTTAGTCAATGCAAGCTCAATATTTTCATATTTATTTTTTGCCTTATGCAATATTTTTCAACATTTTCATGAGTTGTCGGTCATCACTATCTCTATTAACTTTCAACAACTTGCCCTTGTAAGTCACAAATAGTGCTGCTGCTGAAATTATTTCTCACTAACATGCCTCAGATTTCTGTAGTGATTCTACATTTGATATTATTCACAATGTAAAATGCTTCTATTTATTCATTTCGCTTTTACCCAAGGATTATTTTTAAGTTATTTTTGTCATTTTCACACTTCAAACATAAAGACAAAAACATCAAAAATATAGTGTTTTACATATGTGCATATTTTCACACATATATGTATGTATATTTATATGTATTGAAACTACAGAAGCACATGTCACCAATAAGAGCTCTGAGACACCTTCGACCACTTACCCTTATCAGATGAGTTGTGGAAACAAGTTTTTTTTAACTGAATTTCTGAGCTTTGTGGATTTAGAAATGCAAAGGAAGGTTTGTGGACATTCACAGGGATCATGATTTTATTCTCCTTAAAACTCTTCTGTACTTTCCAATTGTCCTTAGTATAAATCCAAAATCCTAACACCACCCAAGAGGCTTTTCAATACCTGGCTCCTGTGATTTCTCCTGTCTAATCTTTTACCCTCCTTCCCCTCAGCCTCTCTGCTTTAGTGAACTTTCTCCTAGTTTTTTGAAGAAGTTCATCAATTCAAGCTTTTGTACATGGGATTTCCTAAACCTGAAATGTGCCTCCCGTTTTGTCCAAACAGACACGGGCTCCACTCTGCCCCCTGGCTCACACCTGCTTAACCTGTCAAGTCACATCTGAACCGTCACTATTAAGAGGGTCCTTCTCTGGCACCCTAATGTAATTGAGATCATCCTATTATTCTCTGTTCTAGAACTCCACACTTCCGACATTTCTCATTCCTGTCTAAGCTCTTGTGTGTTTGGTGTTGGGCCATCACTTTCACTGCTCTTTAAGCTCCCCCAGCGGAGTGGAGAGGTCTGTTTTCCCTCGTTTGGATTCCTAGAGGCAGCGCAGACCAGGCACAAGGTCAGCACTAAGGAAGGGTTCACAGGATGAACGCGGTGGGTGCTGTTTAAGGAACCGGTAAACGTGTGGGATGAGAGAAGGAGCAGAGTGTCTTTGGGGTGGAGGCTCCCAGGAGGAGGCGGCGCGGGCTGCGGTGCGGGGCGGATCCTCCTCCAGCTCCTGCTTGGAGGTCTCCAGAACAGGCTGGAGGTAGGGAGGGGGGTCCCAAAAGCCTGGGGATCAGACGTGGTTTTCCCGCCTGGTCCCCCAGGCCCCCTTTCGCCTCAGGAAGACAGAGGAGGAGCCCCTGGGCTGCAGGTGGTGGGCGTTGCGGCGGGGGCCGGTTAAGGTTCCCAGTGCCCGCACCCGGCCCAGGGAGCCCCGGATGGCGGCGTCACTGTCAGTGTCTTCTCAGGAGGCCGCCTGTGTGACTGGATCGTTCGTGTCCCCACAGCACGTTTCTTGGAGTACTCTACGTCTGAGTGTCATTTCTTCAATGGGACGGAGCGGGTGCGGTTCCTGGACAGATACTTCTATAACCAAGAGGAGTACGTGCGCTTCGACAGCGACGTGGGGGAGTTCCGGGCGGTGACGGAGCTGGGGCGGCCTGATGAGGAGTACTGGAACAGCCAGAAGGACATCCTGGAAGACGAGCGGGCCGCGGTGGACACCTACTGCAGACACAACTACGGGGTTGTGGAGAGCTTCACAGTGCAGCGGCGAGGTGAGCGCGGCGCGGGGCGGGGCCTGAGTCCCTGTGAGCTGGGAATCTGAGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGAGAGAGAGACAGAGAGACAGAGAGAGAGAGAGCGCCATCTGTGAGCATTTAGAATCCTCTCTATCCTGAGCAAGGAGTTCTGAGGGCACAGGTGTGTGTGTAGAGTGTGGATTTGTCTGTGTCTGTGAGGCTGTTGTGGGAGGGGAGGCAGGAGGGGGCTGCTTCTTATTCTTGGAGGACTCTGTGGGGAGGTGACAAGGGAGGTGGGTGCGGGCGGCTGGAGAGAGAGGTGACCTTGATTGTCTCGGGTCCTTAGAGATGCAGGGAAGGGAAATGTAAGGGGTGTGTGGTTGGGGTGAAGGTTTAGGGGAGGAGAGCTGAGGGGTAAGGAAGGTTTGGGATAATGTGAGGAGGCCAGTTCCAGACTGTCCCTGGCACACACCCTTCATGTAATCTCTGAAATAAAAGTGTGTGCTGTTTGTTTGTAAAAGCATTAGATTAATTTCTAGGGGAATTGAGGAGACCTCTGAGGCATCTCTGAAGCTTCTTTAGGTCTAAATTTCTTGCTAGTTTTTTGTTTTTTATTGTGTATATTTTTACATAGTAGAAATGACTGTGAAACTAACTTTTTGAATTAAAGTTTTAACACAGTTACTATTTTATTATAATGCTAATAGTTTTCTAGTAGTTACATATTATTCTTTTATATATAATAGTTGTGACACAACTTACCTCACTTTCCCCTTTGTTGACCTTTATTATGACATTCACCAAAATTTGAAAATGTATGTTTCTGGTTAATTTTTAATTTATATTTTTTTCATTTATAATTCTTTTGAATTATTTTGACCTATTTATTGGCCAGTTTTAATAACTGCTGTAAGAATTCCCTATTGTATTTGGTAGGGAATGGACAATGATCTACTGCCTAATATCTCGAGGGCTTAGTATTTTTCTCAGTGACTTTGTGGGTTCTTTGTACTGTGAGATTATTAACACTTTATTGATATTTGATTCAGCATTTGCTCCAGTTTGTGGTTTGTATGTTGATTTTGAAAATTCTTTTCCATGTTAAGAATTTGAACATTTTTATATAATAAAATATGTTGCAAAATTTTTATTAATGATTTACAATCCATCTTAAATCTGCCATTTTGTGGTATTGTTGTCTCCAGGTTTCTCCTTACTTCTAAAAAAAATTGCATTTATTGAGAGTCTGCTAGTGTTAGGGATTTTCCTGGGCATAAGCACCCCAAGTGACGAGTCCCAGACACTGCCTTAATCCAAATGTGATTCTGGAAAGAAAAATCATTTTACAATGATAGGCCTAATAATAATTAAGCTTGTGTTGCATGGGAGATGCATTGATCAGCTAAATGTAAATATAAGAACTTTCAAAACTAAAATGACGTTCCTTAATCCTTCTCTCTGCTTTATGACTCATGCTTTTCTGGGAAAGTAAAAATTTGGAGAATCATTTCTGTCTGTCCCACCTTCCCAGGGGCAGAACCATTTCTGTGGTGTTCTAAGGTGTGAGTGCATGGCGGTAGTATTCCTAAAAATTCATATTCGGTTTCGTCATGTACCCAACTCTGTCCCGTTATCTATCAACATTGTTTTAAATCATATATTTCTGTCAAGGTGTACAAGGATGATAAATAGGTGCCAAGTGGAGCACCCAAGTGTGATGAGCCCCCTCACAGTGGAATGGAGTGTGAAGCTTTATGACCTCATAAATTGAAGGTTATCTTCAGTCATTGTTTTATATATTTTACATGCATTAATCCTCATATAATCCCAAGAGGTAAATTAGTATAATTATCCTTCATTATAGGTGACAAAGTTGAGACACAGAAGAATCGAACTCTTAAGGCAGACCTTGGATTTGAACCAGGCAACCTGGCTCAGATATCAGTTTTAATTACTACACTCTGTACTTTCAAAGATTTGTAAACACTTTGACAATGCATGACAATTTCAAGCTATGAAGAAACAAACACAATTTTTCACAATATCTCTCAAATCTAATAGGTCCTCACTATCAAGATTAAGTTCCAGGCTGATGACACTGTAAGGCCACATGGCCAGCTGTGCTGGAGGCCTGGTCAAGGTCAGAGCCTGGGTTTGCAGAGAAGCAGACAAACAGCCAAACAAGGAGACTTACTCTGTCTTCATGACTCATTCCCTCTACCTTTTTTCTCCTAGTCCATCCTAAGGTGACTGTGTATCCTTCAAAGACCCAGCCCGTGCAGCACCACAACCTCCTGGTCTGTTCTGTGAGTGGTTTCTATCCAGGCAGCATTGAAGTCAGGTGGTTCCGGAATGGCCAGGAAGAGAAGACTGGGGTGGTGTCCACAGGCCTGATCCACAATGGAGACTGGACCTTCCAGACCCTGGTGATGCTGGAAACAGTTCCTCGGAGTGGAGAGGTTTACACCTGCCAAGTGGAGCACCCAAGCGTGACAAGCCCTCTCACAGTGGAATGGAGTGAGCAGCTTTCTGACTTCATAAATTTCTCACCCACCAAGAAGGGGACTGTGCTCATCCCTGAGTGTCAGGTTTCTCCTCTCCGACATCCTATTTTCATTTGCTCCATGTTCTCATCTCCATCAGCACAGGTCACTGGGGGTAGCCCTGTAGGTGTTTCTAGAAACACCTGTACCTCCTGGAGAAGCAGTCTCGCCTGCCAGGCAGGAGAGGCTGTCCCTCTTTTGAACCTCCCCATGATGTCACAGGTCAGGGTCACCCACCCTCCCCGGGCTCCAGGCACTGCCTCTGGGTCTGAGACTGAGTTTCTGGTGCTGTTGATCTGAGTTATTTGTTGTGATCTGGGAAGAGGAGAAGTGTAGGGGCCTTCCTGACATGAGGGGAGTCCAATCTCAGCTCTGCCTTTTATTAGCTCTGTCACTCTAGACAAACTACTTAGCCTCATTGAGTCTCAGGCTTTCTGTGGATCAGATGTTGAACTCTTGCCTTACATCAAGGCTGTAATATTTGAATGAGTTTGATGTCTGAACCTTGTAACTGTTCAGTGTGATTTGAAATCCTTTTTTTCTCCAGAAATGGCTAGTTATTTTAGTTCTTGTGGGGCAGACTTCTTCCCCATTTTCAAAGCTCTGAATCTTAGAGTCTCAATTAAAGAGGTTCAATTTGGAATAAACACTAAACCTGGCTTCCTCTCTCAGGAGCACGGTCTGAATCTGCACAGAGCAAGATGCTGAGTGGAGTCGGGGGCTTTGTGCTGGGCCTGCTCTTCCTTGGGGCCGGGCTGTTCATCTACTTCAGGAATCAGAAAGGTGAGGAGCCTTTGGTAGCTGGCTCTCTCCATAGGCTTTTCTGGAGGAGGAACTATGGCTTTGCTGAGGTTAGTTCTCAGTATATGAGTGGCCCTGAATAAAGCCTTTCTTTCCCCAAACGGCTCTAATGTCCTGCTAATCCAGAAATCATCAGTGCATGGTTACTATGTGAAAGCATAATAGCTTGTGGCCTGCAGAGACAAGAGGAAGGTTAACAAGTAGGGGTCCTTTGGTTTGAGATCTTGGAGCAGATTAAGGAAGAGCCACTAAGACTAATGGAATTACACTGGATCCTGTGACAGACACTTCACCCTTCATGGGTCACATGGTCTGTTTCTGCTCCTCTCTGCCCTGGCTGGTGTGGGTTGTAGTGACAGAGAACTCTCCGGTGGGAGATCTGGGGCTGGGACATTGTGTTGGAAGACAGATTTGCTTCCATAAATTTTAAGTGTATATATTTTCCTCTTTTTCCCAGGACACTCTGGACTTCAGCCAAGAGGTAATACCTTTTAATCCTCTTTTAGAAACAGATACGGTTTCCCTAGTGAGAGGTGAAGCCAGCTGGACTTCTGGGTCGGGTAGGGACTTGCAGAACTTTCCTGTCTTAGGAGAGGTTTCTAAATGCACCAATCAGTGCTCTGTAAAAACACACCAATTGGCACTCTGTGGCTAGATAGATGTTTGTAAAATGGACTAATCAGCACTCTGTAAAATGGAGCAATCCACACTCTGTAAAATGGACCAATCAATGCTCTTTAAAATGGACCAATCAGCAGGACATGGGCGGGGACAAATAAGGGAATACAAGCTGGCCACCCCAGCCAGCAGCAGCAACCCGCTCAGGTCGCCTTCCATGCTGTGGAAGCTTTGTTCTTTTGCTCTTCACAATAAATCTTGCTGTTGCTCACTCTTCGGGTCTGTGCCACCTTTAAGAGCTGTAACACTCACTGTGAAGATTCGCGGCTTCATTCTTGAAGTCAGCGAAACCACGAACCCACCGGAAGGAACAAACTCTGGACACACTAGAATTGATGGTAGAGGTGATAAGGCATGAGACAGAAATAATAGGAAAGACTTTGGATCCAAATTTCTGATCAGGCAATTTACACCAAAACTCCTCCTCTCCACTTAGAAAAGGCCTGTGCTCTGTGGGACTATTGGCTCTGGGAGACTCAGGAACTTGTTTTTCTTCTTCCTGCAGTGCTCTCATCTGAGTCCCTGAAAGAGAGGAAAAGAAACTGTTAGTAGAGTCAGGTTGAAAACAACACTCTCCTCTGTCTTTTGCAGGATTCCTGAGCTGAAGTGCAGATGACACATTCAAAGAAGAACTTTCTGCCCCAGCTTTGCAGGATGAAAAGCTTTCCCTCCTGGCTGT'
    hlaLocus = 'HLA-DRB1'
    # roughFeatureSequence = 'aag\nCGTCGT\nccg\nGGCTGA\naat'
    alleleCallWithGFE = fetchSequenceAlleleCallWithGFE(roughFeatureSequence, hlaLocus)
    assert_true(len(alleleCallWithGFE) > 3)

    # print 'ALLELE CALL RESULTS:'
    # print alleleCallWithGFE

    annotatedSequence = parseExons(roughFeatureSequence, alleleCallWithGFE)
    # print ('ANNOTATED SEQUENCE:')
    # print (annotatedSequence)
    assert_true(len(annotatedSequence) > 3)

    imgtGenerator = ImgtSubGenerator()

    imgtGenerator.sequenceAnnotation = identifyGenomicFeatures(annotatedSequence)

    assignConfigurationValue('imgt_submission_identifier', 'HWS100234567')
    assignConfigurationValue('imgt_submission_version', '1')
    # I think I dont need this embl release date.
    # assignConfigurationValue('embl_release_date', '09/08/2017')
    assignConfigurationValue('allele_name', 'HLA-DRB1_NEW_1')
    # I need a method to do this...I am adding it now.
    # assignConfigurationValue('closest_allele_written_description', 'TEMP_IMGTHLA_IDENTIFIER')
    assignConfigurationValue('embl_sequence_accession', 'EMBL_Seq_Acc')
    assignConfigurationValue('imgt_submitter_id', 'IMGTHLA_Submitter_ID')
    assignConfigurationValue('imgt_submitter_name', 'Ben Bioinformaticist')
    assignConfigurationValue('imgt_alt_contact', 'IMGTHLA_Alt_Contact')
    assignConfigurationValue('imgt_submitter_email', 'Ben@BioinformaticsResearch.com')
    assignConfigurationValue('cell_id', 'Cell_Identifier123')
    assignConfigurationValue('ethnic_origin', 'African American')
    assignConfigurationValue('sex', 'Unknown')
    assignConfigurationValue('consanguineous', 'Unknown')
    assignConfigurationValue('homozygous', 'Unknown')
    assignConfigurationValue('lab_of_origin', 'Maastricht University Medical Center')
    assignConfigurationValue('lab_contact', 'Marspel JR Spilanus')
    assignConfigurationValue('alleles', 'HLA-A*01:01:01:01;HLA-B*40:72:01')
    assignConfigurationValue('material_availability', 'No Material Available')
    assignConfigurationValue('cell_bank', 'Not Available')
    assignConfigurationValue('primary_sequencing_methodology', 'Direct sequencing of PCR product from DNA (SBT)')
    assignConfigurationValue('secondary_sequencing_methodology', 'Direct sequencing of PCR product from DNA (SBT)')
    assignConfigurationValue('primer_type', 'Both allele and locus specific')
    assignConfigurationValue('primers',
                             '03PID03     CCCAAAGGGTTTCCCGGGAAATTT 3UT 3015-3042;04PID04     AAAGGGTTTCCCGGGAAATTTCCC 5UT 4015-4042')
    assignConfigurationValue('sequenced_in_isolation', 'Yes')
    assignConfigurationValue('no_of_reactions', '3')
    assignConfigurationValue('method_comments', 'The method we used was MinION sequencing!')
    # assignConfigurationValue('closest_known_allele', 'TEMP_IMGTHLA_IDENTIFIER')
    # I'm specifically escapting semicolons here.
    # Ben's unnoficial dirty trick: Convert any semi colon on the input to ;. Just store those 3 characters instead of a semicolon.
    assignConfigurationValue('citations',
                             '1-3503;PUBMED; 9349617.;Laforet M, Froelich N, Parissiadis A, Pfeiffer B, Schell A, Faller B, Woehl-Jaegle ML, Cazenave JP, Tongio MM;A nucleotide insertion in exon 4 is responsible for the absence of expression of an HLA-A*01 allele;Tissue Antigens 50:347 - 50(1997).;1-3503;PUBMED; 9349617.;Laforet M, Froelich N, Parissiadis A, Pfeiffer B, Schell A, Faller B, Woehl-Jaegle ML, Cazenave JP, Tongio MM;A nucleotide insertion in exon 4 is responsible for the absence of expression of an HLA-A*01 allele;Tissue Antigens 50:347 - 50(1997).')

    imgtSubmission = imgtGenerator.buildIMGTSubmission()

    print('IMGT SUBMISSION:\n' + imgtSubmission)

    assert_true(len(imgtSubmission) > 3)
    assert_true(imgtSubmission is not None)

    # Maybe I don't want to safe my configuration with all these test values but maybe I don't care :D
    writeConfigurationFile()

    # Print out the submission to a file, for easier validation.
    outputFileObject = open('Test_IMGT_Submission_HLA_DRB1_SNP.txt', 'w')
    submissionText = imgtSubmission
    outputFileObject.write(submissionText)


"""



def testCreateEMBLSubmissionFlatfile():
    print ('Test: Create an EMBL SubmissionFlatfile')
    assert_true(True)

    roughFeatureSequence = 'aag\nCGTCGT\nccg\nGGCTGA\naat'

    assignConfigurationValue('sample_id', 'Donor_12345')
    assignConfigurationValue('gene', 'HLA-C')
    assignConfigurationValue('class', '1')
    assignConfigurationValue('allele_name', 'Allele:01:02')

    allGen = EmblSubGenerator()
    # roughFeatureSequence = self.featureInputGuiObject.get('1.0', 'end')

    allGen.sequenceAnnotation = identifyGenomicFeatures(roughFeatureSequence)

    enaSubmission = allGen.buildENASubmission()

    assert_true(len(enaSubmission) > 3)
    assert_true(enaSubmission is not None)

    #Print out the submission to a file, for easier validation.
    outputFileObject = open('Test_EMBL_Submission.txt', 'w')
    submissionText = enaSubmission
    outputFileObject.write(submissionText)


# Bad programming style, not supposed to use the triple quote for block comments.
# Maybe Python should support block comments, but what do I know?



def testAnnotateSimple():
    # This test demonstrates a minimal snippet to annotate a raw sequence.
    import gfe_client
    #A*01:01:01:01
    sequenceRaw = 'CAGGAGCAGAGGGGTCAGGGCGAAGTCCCAGGGCCCCAGGCGTGGCTCTCAGGGTCTCAGGCCCCGAAGGCGGTGTATGGATTGGGGAGTCCCAGCCTTGGGGATTCCCCAACTCCGCAGTTTCTTTTCTCCCTCTCCCAACCTACGTAGGGTCCTTCATCCTGGATACTCACGACGCGGACCCAGTTCTCACTCCCATTGGGTGTCGGGTTTCCAGAGAAGCCAATCAGTGTCGTCGCGGTCGCTGTTCTAAAGTCCGCACGCACCCACCGGGACTCAGATTCTCCCCAGACGCCGAGGATGGCCGTCATGGCGCCCCGAACCCTCCTCCTGCTACTCTCGGGGGCCCTGGCCCTGACCCAGACCTGGGCGGGTGAGTGCGGGGTCGGGAGGGAAACCGCCTCTGCGGGGAGAAGCAAGGGGCCCTCCTGGCGGGGGCGCAGGACCGGGGGAGCCGCGCCGGGAGGAGGGTCGGGCAGGTCTCAGCCACTGCTCGCCCCCAGGCTCCCACTCCATGAGGTATTTCTTCACATCCGTGTCCCGGCCCGGCCGCGGGGAGCCCCGCTTCATCGCCGTGGGCTACGTGGACGACACGCAGTTCGTGCGGTTCGACAGCGACGCCGCGAGCCAGAAGATGGAGCCGCGGGCGCCGTGGATAGAGCAGGAGGGGCCGGAGTATTGGGACCAGGAGACACGGAATATGAAGGCCCACTCACAGACTGACCGAGCGAACCTGGGGACCCTGCGCGGCTACTACAACCAGAGCGAGGACGGTGAGTGACCCCGGCCCGGGGCGCAGGTCACGACCCCTCATCCCCCACGGACGGGCCAGGTCGCCCACAGTCTCCGGGTCCGAGATCCACCCCGAAGCCGCGGGACTCCGAGACCCTTGTCCCGGGAGAGGCCCAGGCGCCTTTACCCGGTTTCATTTTCAGTTTAGGCCAAAAATCCCCCCGGGTTGGTCGGGGCGGGGCGGGGCTCGGGGGACTGGGCTGACCGCGGGGTCGGGGCCAGGTTCTCACACCATCCAGATAATGTATGGCTGCGACGTGGGGCCGGACGGGCGCTTCCTCCGCGGGTACCGGCAGGACGCCTACGACGGCAAGGATTACATCGCCCTGAACGAGGACCTGCGCTCTTGGACCGCGGCGGACATGGCAGCTCAGATCACCAAGCGCAAGTGGGAGGCGGTCCATGCGGCGGAGCAGCGGAGAGTCTACCTGGAGGGCCGGTGCGTGGACGGGCTCCGCAGATACCTGGAGAACGGGAAGGAGACGCTGCAGCGCACGGGTACCAGGGGCCACGGGGCGCCTCCCTGATCGCCTATAGATCTCCCGGGCTGGCCTCCCACAAGGAGGGGAGACAATTGGGACCAACACTAGAATATCACCCTCCCTCTGGTCCTGAGGGAGAGGAATCCTCCTGGGTTTCCAGATCCTGTACCAGAGAGTGACTCTGAGGTTCCGCCCTGCTCTCTGACACAATTAAGGGATAAAATCTCTGAAGGAGTGACGGGAAGACGATCCCTCGAATACTGATGAGTGGTTCCCTTTGACACCGGCAGCAGCCTTGGGCCCGTGACTTTTCCTCTCAGGCCTTGTTCTCTGCTTCACACTCAATGTGTGTGGGGGTCTGAGTCCAGCACTTCTGAGTCTCTCAGCCTCCACTCAGGTCAGGACCAGAAGTCGCTGTTCCCTTCTCAGGGAATAGAAGATTATCCCAGGTGCCTGTGTCCAGGCTGGTGTCTGGGTTCTGTGCTCTCTTCCCCATCCCGGGTGTCCTGTCCATTCTCAAGATGGCCACATGCGTGCTGGTGGAGTGTCCCATGACAGATGCAAAATGCCTGAATTTTCTGACTCTTCCCGTCAGACCCCCCCAAGACACATATGACCCACCACCCCATCTCTGACCATGAGGCCACCCTGAGGTGCTGGGCCCTGGGCTTCTACCCTGCGGAGATCACACTGACCTGGCAGCGGGATGGGGAGGACCAGACCCAGGACACGGAGCTCGTGGAGACCAGGCCTGCAGGGGATGGAACCTTCCAGAAGTGGGCGGCTGTGGTGGTGCCTTCTGGAGAGGAGCAGAGATACACCTGCCATGTGCAGCATGAGGGTCTGCCCAAGCCCCTCACCCTGAGATGGGGTAAGGAGGGAGATGGGGGTGTCATGTCTCTTAGGGAAAGCAGGAGCCTCTCTGGAGACCTTTAGCAGGGTCAGGGCCCCTCACCTTCCCCTCTTTTCCCAGAGCTGTCTTCCCAGCCCACCATCCCCATCGTGGGCATCATTGCTGGCCTGGTTCTCCTTGGAGCTGTGATCACTGGAGCTGTGGTCGCTGCCGTGATGTGGAGGAGGAAGAGCTCAGGTGGAGAAGGGGTGAAGGGTGGGGTCTGAGATTTCTTGTCTCACTGAGGGTTCCAAGCCCCAGCTAGAAATGTGCCCTGTCTCATTACTGGGAAGCACCTTCCACAATCATGGGCCGACCCAGCCTGGGCCCTGTGTGCCAGCACTTACTCTTTTGTAAAGCACCTGTTAAAATGAAGGACAGATTTATCACCTTGATTACGGCGGTGATGGGACCTGATCCCAGCAGTCACAAGTCACAGGGGAAGGTCCCTGAGGACAGACCTCAGGAGGGCTATTGGTCCAGGACCCACACCTGCTTTCTTCATGTTTCCTGATCCCGCCCTGGGTCTGCAGTCACACATTTCTGGAAACTTCTCTGGGGTCCAAGACTAGGAGGTTCCTCTAGGACCTTAAGGCCCTGGCTCCTTTCTGGTATCTCACAGGACATTTTCTTCCCACAGATAGAAAAGGAGGGAGTTACACTCAGGCTGCAAGTAAGTATGAAGGAGGCTGATGCCTGAGGTCCTTGGGATATTGTGTTTGGGAGCCCATGGGGGAGCTCACCCACCCCACAATTCCTCCTCTAGCCACATCTTCTGTGGGATCTGACCAGGTTCTGTTTTTGTTCTACCCCAGGCAGTGACAGTGCCCAGGGCTCTGATGTGTCTCTCACAGCTTGTAAAGGTGAGAGCTTGGAGGGCCTGATGTGTGTTGGGTGTTGGGTGGAACAGTGGACACAGCTGTGCTATGGGGTTTCTTTGCGTTGGATGTATTGAGCATGCGATGGGCTGTTTAAGGTGTGACCCCTCACTGTGATGGATATGAATTTGTTCATGAATATTTTTTTCTATAGTGTGAGACAGCTGCCTTGTGTGGGACTGAGAGGCAAGAGTTGTTCCTGCCCTTCCCTTTGTGACTTGAAGAACCCTGACTTTGTTTCTGCAAAGGCACCTGCATGTGTCTGTGTTCGTGTAGGCATAATGTGAGGAGGTGGGGAGAGCACCCCACCCCCATGTCCACCATGACCCTCTTCCCACGCTGACCTGTGCTCCCTCTCCAATCATCTTTCCTGTTCCAGAGAGGTGGGGCTGAGGTGTCTCCATCTCTGTCTCAACTTCATGGTGCACTGAGCTGTAACTTCTTCCTTCCCTATTAAAA'
    config = gfe_client.Configuration()
    config.host = 'http://act.b12x.org'
    api = gfe_client.ApiClient(configuration=config)
    ann_api = gfe_client.TypeSeqApi(api_client=api)
    responseText = ann_api.typeseq_get(sequence=sequenceRaw, imgthla_version="3.31.0", locus='HLA-A')

    # Convert the python objects to more proper json.
    annotation = responseText.to_dict()
    jsonResponse = dumps(annotation, indent=4)

    #print('RESPONSE:\n' + str(jsonResponse))
    assert(len(str(jsonResponse)) > 5)



def testAnnotateRoughSequence():
    print ('Test: Annotate a rough sequence using the ACT APIs')

    #>HLA-A*02:01:01:12 Full Length Allele. Will we allele call correctly?
    #roughFeatureSequence = 'CCAGTTCTCACTCCCATTGGGTGTCGGGTTTCCAGAGAAGCCAATCAGTGTCGTCGCGGTCGCGGTTCTAAAGTCCGCACGCACCCACCGGGACTCAGATTCTCCCCAGACGCCGAGGATGGCCGTCATGGCGCCCCGAACCCTCGTCCTGCTACTCTCGGGGGCTCTGGCCCTGACCCAGACCTGGGCGGGTGAGTGCGGGGTCGGGAGGGAAACGGCCTCTGTGGGGAGAAGCAACGGGCCCGCCTGGCGGGGGCGCAGGACCCGGGAAGCCGCGCCGGGAGGAGGGTCGGGCGGGTCTCAGCCACTCCTCGTCCCCAGGCTCTCACTCCATGAGGTATTTCTTCACATCCGTGTCCCGGCCCGGCCGCGGGGAGCCCCGCTTCATCGCAGTGGGCTACGTGGACGACACGCAGTTCGTGCGGTTCGACAGCGACGCCGCGAGCCAGAGGATGGAGCCGCGGGCGCCGTGGATAGAGCAGGAGGGTCCGGAGTATTGGGACGGGGAGACACGGAAAGTGAAGGCCCACTCACAGACTCACCGAGTGGACCTGGGGACCCTGCGCGGCTACTACAACCAGAGCGAGGCCGGTGAGTGACCCCGGCCCGGGGCGCAGGTCACGACCTCTCATCCCCCACGGACGGGCCAGGTCGCCCACAGTCTCCGGGTCCGAGATCCGCCCCGAAGCCGCGGGACCCCGAGACCCTTGCCCCGGGAGAGGCCCAGGCGCCTTTACCCGGTTTCATTTTCAGTTTAGGCCAAAAATCCCCCCAGGTTGGTCGGGGCGGGGCGGGGCTCGGGGGACCGGGCTGACCGCGGGGTCCGGGCCAGGTTCTCACACCGTCCAGAGGATGTATGGCTGCGACGTGGGGTCGGACTGGCGCTTCCTCCGCGGGTACCACCAGTACGCCTACGACGGCAAGGATTACATCGCCCTGAAAGAGGACCTGCGCTCTTGGACCGCGGCGGACATGGCAGCTCAGACCACCAAGCACAAGTGGGAGGCGGCCCATGTGGCGGAGCAGTTGAGAGCCTACCTGGAGGGCACGTGCGTGGAGTGGCTCCGCAGATACCTGGAGAACGGGAAGGAGACGCTGCAGCGCACGGGTACCAGGGGCCACGGGGCGCCTCCCTGATCGCCTGTAGATCTCCCGGGCTGGCCTCCCACAAGGAGGGGAGACAATTGGGACCAACACTAGAATATCGCCCTCCCTCTGGTCCTGAGGGAGAGGAATCCTCCTGGGTTTCCAGATCCTGTACCAGAGAGTGACTCTGAGGTTCCGCCCTGCTCTCTGACACAATTAAGGGATAAAATCTCTGAAGGAATGACGGGAAGACGATCCCTCGAATACTGATGAGTGGTTCCCTTTGACACACACAGGCAGCAGCCTTGGGCCCGTGACTTTTCCTCTCAGGCCTTGTTCTCTGCTTCACACTCAATGTGTGTGGGGGTCTGAGTCCAGCACTTCTGAGTCCTTCAGCCTCCACTCAGGTCAGGACCAGAAGTCGCTGTTCCCTCTTCAGGGACTAGAATTTTCCACGGAATAGGAGATTATCCCAGGTGCCTGTGTCCAGGCTGGTGTCTGGGTTCTGTGCTCCCTTCCCCATCCCAGGTGTCCTGTCCATTCTCAAGATAGCCACATGTGTGCTGGAGGAGTGTCCCATGACAGATGCAAAATGCCTGAATGATCTGACTCTTCCTGACAGACGCCCCCAAAACGCATATGACTCACCACGCTGTCTCTGACCATGAAGCCACCCTGAGGTGCTGGGCCCTGAGCTTCTACCCTGCGGAGATCACACTGACCTGGCAGCGGGATGGGGAGGACCAGACCCAGGACACGGAGCTCGTGGAGACCAGGCCTGCAGGGGATGGAACCTTCCAGAAGTGGGCGGCTGTGGTGGTGCCTTCTGGACAGGAGCAGAGATACACCTGCCATGTGCAGCATGAGGGTTTGCCCAAGCCCCTCACCCTGAGATGGGGTAAGGAGGGAGACGGGGGTGTCATGTCTTTTAGGGAAAGCAGGAGCCTCTCTGACCTTTAGCAGGGTCAGGGCCCCTCACCTTCCCCTCTTTTCCCAGAGCCGTCTTCCCAGCCCACCATCCCCATCGTGGGCATCATTGCTGGCCTGGTTCTCTTTGGAGCTGTGATCACTGGAGCTGTGGTCGCTGCTGTGATGTGGAGGAGGAAGAGCTCAGGTGGGGAAGGGGTGAAGGGTGGGTCTGAGATTTCTTGTCTCACTGAGGGTTCCAAGACCCAGGTAGAAGTGTGCCCTGCCTCGTTACTGGGAAGCACCACCCACAATTATGGGCCTACCCAGCCTGGGCCCTGTGTGCCAGCACTTACTCTTTTGTAAAGCACCTGTTAAAATGAAGGACAGATTTATCACCTTGATTACAGCGGTGATGGGACCTGATCCCAGCAGTCACAAGTCACAGGGGAAGGTCCCTGAGGACCTTCAGGAGGGCGGTTGGTCCAGGACCCACACCTGCTTTCTTCATGTTTCCTGATCCCGCCCTGGGTCTGCAGTCACACATTTCTGGAAACTTCTCTGAGGTCCAAGACTTGGAGGTTCCTCTAGGACCTTAAGGCCCTGACTCCTTTCTGGTATCTCACAGGACATTTTCTTCCCACAGATAGAAAAGGAGGGAGCTACTCTCAGGCTGCAAGTAAGTATGAAGGAGGCTGATGCCTGAGGTCCTTGGGATATTGTGTTTGGGAGCCCATGGGGGAGCTCACCCACCCCACAATTCCTCCTCTAGCCACATCTTCTGTGGGATCTGACCAGGTTCTGTTTTTGTTCTACCCCAGGCAGTGACAGTGCCCAGGGCTCTGATGTGTCTCTCACAGCTTGTAAAGGTGAGAGCCTGGAGGGCCTGATGTGTGTTGGGTGTTGGGCGGAACAGTGGACACAGCTGTGCTGTGGGGTTTCTTTCCATTGGATGTATTGAGCATGCGATGGGCTGTTTAAAGTGTGACCCCTCACTGTGACAGATACGAATTTGTTCATGAATATTTTTTTCTATAGTGTGAGACAGCTGCCTTGTGTGGGACTGAGAGGCAAGAGTTGTTCCTGCCCTTCCCTTTGTGACTTGAAGAACCCTGACTTTGTTTCTGCAAAGGCACCTGCATGTGTCTGTGTTCGTGTAGGCATAATGTGAGGAGGTGGGGAGACCACCCCACCCCCATGTCCACCATGACCCTCTTCCCACGCTGACCTGTGCTCCCTCCCCAATCATCTTTCCTGTTCCAGAGAGGTGGGGCTGAGGTGTCTCCATCTCTGTCTCAACTTCATGGTGCACTGAGCTGTAACTTCTTCCTTCCCTATTAAAA'

    import gfe_client
    # This one is HLA-A 01:01:01, should work fine.
    roughFeatureSequence = 'CAGGAGCAGAGGGGTCAGGGCGAAGTCCCAGGGCCCCAGGCGTGGCTCTCAGGGTCTCAGGCCCCGAAGGCGGTGTATGGATTGGGGAGTCCCAGCCTTGGGGATTCCCCAACTCCGCAGTTTCTTTTCTCCCTCTCCCAACCTACGTAGGGTCCTTCATCCTGGATACTCACGACGCGGACCCAGTTCTCACTCCCATTGGGTGTCGGGTTTCCAGAGAAGCCAATCAGTGTCGTCGCGGTCGCTGTTCTAAAGTCCGCACGCACCCACCGGGACTCAGATTCTCCCCAGACGCCGAGGATGGCCGTCATGGCGCCCCGAACCCTCCTCCTGCTACTCTCGGGGGCCCTGGCCCTGACCCAGACCTGGGCGGGTGAGTGCGGGGTCGGGAGGGAAACCGCCTCTGCGGGGAGAAGCAAGGGGCCCTCCTGGCGGGGGCGCAGGACCGGGGGAGCCGCGCCGGGAGGAGGGTCGGGCAGGTCTCAGCCACTGCTCGCCCCCAGGCTCCCACTCCATGAGGTATTTCTTCACATCCGTGTCCCGGCCCGGCCGCGGGGAGCCCCGCTTCATCGCCGTGGGCTACGTGGACGACACGCAGTTCGTGCGGTTCGACAGCGACGCCGCGAGCCAGAAGATGGAGCCGCGGGCGCCGTGGATAGAGCAGGAGGGGCCGGAGTATTGGGACCAGGAGACACGGAATATGAAGGCCCACTCACAGACTGACCGAGCGAACCTGGGGACCCTGCGCGGCTACTACAACCAGAGCGAGGACGGTGAGTGACCCCGGCCCGGGGCGCAGGTCACGACCCCTCATCCCCCACGGACGGGCCAGGTCGCCCACAGTCTCCGGGTCCGAGATCCACCCCGAAGCCGCGGGACTCCGAGACCCTTGTCCCGGGAGAGGCCCAGGCGCCTTTACCCGGTTTCATTTTCAGTTTAGGCCAAAAATCCCCCCGGGTTGGTCGGGGCGGGGCGGGGCTCGGGGGACTGGGCTGACCGCGGGGTCGGGGCCAGGTTCTCACACCATCCAGATAATGTATGGCTGCGACGTGGGGCCGGACGGGCGCTTCCTCCGCGGGTACCGGCAGGACGCCTACGACGGCAAGGATTACATCGCCCTGAACGAGGACCTGCGCTCTTGGACCGCGGCGGACATGGCAGCTCAGATCACCAAGCGCAAGTGGGAGGCGGTCCATGCGGCGGAGCAGCGGAGAGTCTACCTGGAGGGCCGGTGCGTGGACGGGCTCCGCAGATACCTGGAGAACGGGAAGGAGACGCTGCAGCGCACGGGTACCAGGGGCCACGGGGCGCCTCCCTGATCGCCTATAGATCTCCCGGGCTGGCCTCCCACAAGGAGGGGAGACAATTGGGACCAACACTAGAATATCACCCTCCCTCTGGTCCTGAGGGAGAGGAATCCTCCTGGGTTTCCAGATCCTGTACCAGAGAGTGACTCTGAGGTTCCGCCCTGCTCTCTGACACAATTAAGGGATAAAATCTCTGAAGGAGTGACGGGAAGACGATCCCTCGAATACTGATGAGTGGTTCCCTTTGACACCGGCAGCAGCCTTGGGCCCGTGACTTTTCCTCTCAGGCCTTGTTCTCTGCTTCACACTCAATGTGTGTGGGGGTCTGAGTCCAGCACTTCTGAGTCTCTCAGCCTCCACTCAGGTCAGGACCAGAAGTCGCTGTTCCCTTCTCAGGGAATAGAAGATTATCCCAGGTGCCTGTGTCCAGGCTGGTGTCTGGGTTCTGTGCTCTCTTCCCCATCCCGGGTGTCCTGTCCATTCTCAAGATGGCCACATGCGTGCTGGTGGAGTGTCCCATGACAGATGCAAAATGCCTGAATTTTCTGACTCTTCCCGTCAGACCCCCCCAAGACACATATGACCCACCACCCCATCTCTGACCATGAGGCCACCCTGAGGTGCTGGGCCCTGGGCTTCTACCCTGCGGAGATCACACTGACCTGGCAGCGGGATGGGGAGGACCAGACCCAGGACACGGAGCTCGTGGAGACCAGGCCTGCAGGGGATGGAACCTTCCAGAAGTGGGCGGCTGTGGTGGTGCCTTCTGGAGAGGAGCAGAGATACACCTGCCATGTGCAGCATGAGGGTCTGCCCAAGCCCCTCACCCTGAGATGGGGTAAGGAGGGAGATGGGGGTGTCATGTCTCTTAGGGAAAGCAGGAGCCTCTCTGGAGACCTTTAGCAGGGTCAGGGCCCCTCACCTTCCCCTCTTTTCCCAGAGCTGTCTTCCCAGCCCACCATCCCCATCGTGGGCATCATTGCTGGCCTGGTTCTCCTTGGAGCTGTGATCACTGGAGCTGTGGTCGCTGCCGTGATGTGGAGGAGGAAGAGCTCAGGTGGAGAAGGGGTGAAGGGTGGGGTCTGAGATTTCTTGTCTCACTGAGGGTTCCAAGCCCCAGCTAGAAATGTGCCCTGTCTCATTACTGGGAAGCACCTTCCACAATCATGGGCCGACCCAGCCTGGGCCCTGTGTGCCAGCACTTACTCTTTTGTAAAGCACCTGTTAAAATGAAGGACAGATTTATCACCTTGATTACGGCGGTGATGGGACCTGATCCCAGCAGTCACAAGTCACAGGGGAAGGTCCCTGAGGACAGACCTCAGGAGGGCTATTGGTCCAGGACCCACACCTGCTTTCTTCATGTTTCCTGATCCCGCCCTGGGTCTGCAGTCACACATTTCTGGAAACTTCTCTGGGGTCCAAGACTAGGAGGTTCCTCTAGGACCTTAAGGCCCTGGCTCCTTTCTGGTATCTCACAGGACATTTTCTTCCCACAGATAGAAAAGGAGGGAGTTACACTCAGGCTGCAAGTAAGTATGAAGGAGGCTGATGCCTGAGGTCCTTGGGATATTGTGTTTGGGAGCCCATGGGGGAGCTCACCCACCCCACAATTCCTCCTCTAGCCACATCTTCTGTGGGATCTGACCAGGTTCTGTTTTTGTTCTACCCCAGGCAGTGACAGTGCCCAGGGCTCTGATGTGTCTCTCACAGCTTGTAAAGGTGAGAGCTTGGAGGGCCTGATGTGTGTTGGGTGTTGGGTGGAACAGTGGACACAGCTGTGCTATGGGGTTTCTTTGCGTTGGATGTATTGAGCATGCGATGGGCTGTTTAAGGTGTGACCCCTCACTGTGATGGATATGAATTTGTTCATGAATATTTTTTTCTATAGTGTGAGACAGCTGCCTTGTGTGGGACTGAGAGGCAAGAGTTGTTCCTGCCCTTCCCTTTGTGACTTGAAGAACCCTGACTTTGTTTCTGCAAAGGCACCTGCATGTGTCTGTGTTCGTGTAGGCATAATGTGAGGAGGTGGGGAGAGCACCCCACCCCCATGTCCACCATGACCCTCTTCCCACGCTGACCTGTGCTCCCTCTCCAATCATCTTTCCTGTTCCAGAGAGGTGGGGCTGAGGTGTCTCCATCTCTGTCTCAACTTCATGGTGCACTGAGCTGTAACTTCTTCCTTCCCTATTAAAA'

    #Fairly sure I do not need the HLA locus, but there it is.
    hlaLocus = 'HLA-A'
    alleleCallWithGFE = fetchSequenceAlleleCallWithGFE(roughFeatureSequence, hlaLocus)


    print('I got an allele call with gfe, of the type:' + str(type(alleleCallWithGFE)))
    #print('the sequence from the Annotation object:' + str(alleleCallWithGFE))


    #assert_true(len(alleleCallWithGFE) > 3)
    #print 'ALLELE CALL RESULTS:'
    #print alleleCallWithGFE

    annotatedSequence = parseExons(roughFeatureSequence, alleleCallWithGFE)
    #print ('ANNOTATED SEQUENCE:')
    #print (annotatedSequence)

    annotatedSingleLine = annotatedSequence.replace('\n','')
    cleanedAnnotatedSequence = annotatedSingleLine.upper()

    print ('RAW      :' + roughFeatureSequence + '\n')
    print ('ANNOTATED:' + annotatedSingleLine + '\n')
    print ('CLEANED  :' + cleanedAnnotatedSequence + '\n')

    assert_equal(roughFeatureSequence,cleanedAnnotatedSequence)
    assert_true(len(annotatedSequence) > 3)




def testAnnotateNOVELSequence():
    print ('Test: Annotate a NOVEL SEQUENCE USING GFE')
    #assignConfigurationValue('nmdp_act_rest_address', 'http://act.b12x.org/type_align' )
    #assignConfigurationValue('nmdp_act_rest_address', 'http://localhost/type_align' )
    assert_true(True)
    #> HLA-A*02:01:01:12 with single SNP.
    roughFeatureSequence = 'CCAGTTCTCACTCCCATTGGGTGTCGGGTTTCCAGAGAAGCCAATCAGTGTCGTCGCGGTCGCGGTTCTAAAGTCCGCACGCACCCACCGGGACTCAGATTCTCCCCAGACGCCGAGGATGGCCGTCATGGCGCCCCGAACCCTCGTCCTGCTACTCTCGGGGGCTCTGGCCCTGACCCAGACCTGGGCGGGTGAGTGCGGGGTCGGGAGGGAAACGGCCTCTGTGGGGAGAAGCAACGGGCCCGCCTGGCGGGGGCGCAGGACCCGGGAAGCCGCGCCGGGAGGAGGGTCGGGCGGGTCTCAGCCACTCCTCGTCCCCAGGCTCTCACTCCATGAGGTATTTCTTCACATCCGTGTCCCGGCCCGGCCGCGGGGAGCCCCGCTTCATCGCAGTGGGCTACGTGGACGACACGCAGTTCGTGCGGTTCGACAGCGACGCCGCGAGCCAGAGGATGGAGCCGCGGGCGCCGTGGATAGAGCAGGAGGGTCCGGAGTATTGGGACGGGGAGACACGGAAAGTGAAGGCCCACTCACAGACTCACCGAGTGGACCTGGGGACCCTGCGCGGCTACTACAACCAGAGCGAGGCCGGTGAGTGACCCCGGCCCGGGGCGCAGGTCACGACCTCTCATCCCCCACGGACGGGCCAGGTCGCCCACAGTCTCCGGGTCCGAGATCCGCCCCGAAGCCGCGGGACCCCGAGACCCTTGCCCCGGGAGAGGCCCAGGCGCCTTTACCCGGTTTCATTTTCAGTTTAGGCCAAAAATCCCCCCAGGTTGGTCGGGGCGGGGCGGGGCTCGGGGGACCGGGCTGACCGCGGGGTCCGGGCCAGGTTCTCACACCGTCCAGAGGATGTATGGCTGCGACGTGGGGTCGGACTGGCGCTTCCTCCGCGGGTACCACCAGTACGCCTACGACGGCAAGGATTACATCGCCCTGAAAGAGGACCTGCGCTCTTGGACCGCGGCGGACATGGCAGCTCAGACCACCAAGCACAAGTGGGAGGCGGCCCATGTGGCGGAGCAGTTGAGAGCCTACCTGGAGGGCACGTGCGTGGAGTGGCTCCGCAGATACCTGGAGAACGGGAAGGAGACGCTGCAGCGCACGGGTACCAGGGGCCACGGGGCGCCTCCCTGATCGCCTGTAGATCTCCCGGGCTGGCCTCCCACAAGGAGGGGAGACAATTGGGACCAACACTAGAATATCGCCCTCCCTCTGGTCCTGAGGGAGAGGAATCCTCCTGGGTTTCCAGATCCTGTACCAGAGAGTGACTCTGAGGTTCCGCCCTGCTCTCTGACACAATTAAGGGATAAAATCTCTGAAGGAATGACGGGAAGACGATCCCTCGAATACTGATGAGTGGTTCCCTTTGACACACACAGGCAGCAGCCTTGGGCCCGTGACTTTTCCTCTCAGGCCTTGTTCTCTGCTTCACACTCAATGTGTGTGGGGGTCTGAGTCCAGCACTTCTGAGTCCTTCAGCCTCCACTCAGGTCAGGACCAGAAGTCGCTGTTCCCTCTTCAGGGACTAGAATTTTCCACGGAATAGGAGATTATCCCAGGTGCCTGTGTCCAGGCTGGTGTCTGGGTTCTGTGCTCCCTTCCCCATCCCAGGTGTCCTGTCCATTCTCAAGATAGCCACATGTGTGCTGGAGGAGTGTCCCATGACAGACGCAAAATGCCTGAATGATCTGACTCTTCCTGACAGACGCCCCCAAAACGCATATGACTCACCACGCTGTCTCTGACCATGAAGCCACCCTGAGGTGCTGGGCCCTGAGCTTCTACCCTGCGGAGATCACACTGACCTGGCAGCGGGATGGGGAGGACCAGACCCAGGACACGGAGCTCGTGGAGACCAGGCCTGCAGGGGATGGAACCTTCCAGAAGTGGGCGGCTGTGGTGGTGCCTTCTGGACAGGAGCAGAGATACACCTGCCATGTGCAGCATGAGGGTTTGCCCAAGCCCCTCACCCTGAGATGGGGTAAGGAGGGAGACGGGGGTGTCATGTCTTTTAGGGAAAGCAGGAGCCTCTCTGACCTTTAGCAGGGTCAGGGCCCCTCACCTTCCCCTCTTTTCCCAGAGCCGTCTTCCCAGCCCACCATCCCCATCGTGGGCATCATTGCTGGCCTGGTTCTCTTTGGAGCTGTGATCACTGGAGCTGTGGTCGCTGCTGTGATGTGGAGGAGGAAGAGCTCAGGTGGGGAAGGGGTGAAGGGTGGGTCTGAGATTTCTTGTCTCACTGAGGGTTCCAAGACCCAGGTAGAAGTGTGCCCTGCCTCGTTACTGGGAAGCACCACCCACAATTATGGGCCTACCCAGCCTGGGCCCTGTGTGCCAGCACTTACTCTTTTGTAAAGCACCTGTTAAAATGAAGGACAGATTTATCACCTTGATTACAGCGGTGATGGGACCTGATCCCAGCAGTCACAAGTCACAGGGGAAGGTCCCTGAGGACCTTCAGGAGGGCGGTTGGTCCAGGACCCACACCTGCTTTCTTCATGTTTCCTGATCCCGCCCTGGGTCTGCAGTCACACATTTCTGGAAACTTCTCTGAGGTCCAAGACTTGGAGGTTCCTCTAGGACCTTAAGGCCCTGACTCCTTTCTGGTATCTCACAGGACATTTTCTTCCCACAGATAGAAAAGGAGGGAGCTACTCTCAGGCTGCAAGTAAGTATGAAGGAGGCTGATGCCTGAGGTCCTTGGGATATTGTGTTTGGGAGCCCATGGGGGAGCTCACCCACCCCACAATTCCTCCTCTAGCCACATCTTCTGTGGGATCTGACCAGGTTCTGTTTTTGTTCTACCCCAGGCAGTGACAGTGCCCAGGGCTCTGATGTGTCTCTCACAGCTTGTAAAGGTGAGAGCCTGGAGGGCCTGATGTGTGTTGGGTGTTGGGCGGAACAGTGGACACAGCTGTGCTGTGGGGTTTCTTTCCATTGGATGTATTGAGCATGCGATGGGCTGTTTAAAGTGTGACCCCTCACTGTGACAGATACGAATTTGTTCATGAATATTTTTTTCTATAGTGTGAGACAGCTGCCTTGTGTGGGACTGAGAGGCAAGAGTTGTTCCTGCCCTTCCCTTTGTGACTTGAAGAACCCTGACTTTGTTTCTGCAAAGGCACCTGCATGTGTCTGTGTTCGTGTAGGCATAATGTGAGGAGGTGGGGAGACCACCCCACCCCCATGTCCACCATGACCCTCTTCCCACGCTGACCTGTGCTCCCTCCCCAATCATCTTTCCTGTTCCAGAGAGGTGGGGCTGAGGTGTCTCCATCTCTGTCTCAACTTCATGGTGCACTGAGCTGTAACTTCTTCCTTCCCTATTAAAA'
    hlaLocus = 'HLA-A'
    #roughFeatureSequence = 'aag\nCGTCGT\nccg\nGGCTGA\naat'
    alleleCallWithGFE = fetchSequenceAlleleCallWithGFE(roughFeatureSequence, hlaLocus)
    #assert_true(len(alleleCallWithGFE) > 3)
    
    #print 'ALLELE CALL RESULTS:'
    #print alleleCallWithGFE

    annotatedSequence = parseExons(roughFeatureSequence, alleleCallWithGFE)
    #print ('ANNOTATED SEQUENCE:')
    #print (annotatedSequence)

    annotatedSingleLine = annotatedSequence.replace('\n','')
    cleanedAnnotatedSequence = annotatedSingleLine.upper()

    print ('RAW      :' + roughFeatureSequence + '\n')
    print ('ANNOTATED:' + annotatedSingleLine + '\n')
    print ('CLEANED  :' + cleanedAnnotatedSequence + '\n')
    assert_true(len(annotatedSequence) > 3)
    


    